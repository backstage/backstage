<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-stable docs-doc-page docs-doc-id-features/software-catalog/extending-the-model--old" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">Extending the model | Backstage Software Catalog and Developer Platform</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://backstage.io/img/sharing-opengraph.png"><meta data-rh="true" name="twitter:image" content="https://backstage.io/img/sharing-opengraph.png"><meta data-rh="true" property="og:url" content="https://backstage.io/docs/features/software-catalog/extending-the-model--old"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="stable"><meta data-rh="true" name="docusaurus_tag" content="docs-default-stable"><meta data-rh="true" name="docsearch:version" content="stable"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-stable"><meta data-rh="true" property="og:title" content="Extending the model | Backstage Software Catalog and Developer Platform"><meta data-rh="true" name="description" content="Documentation on extending the catalog model"><meta data-rh="true" property="og:description" content="Documentation on extending the catalog model"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://backstage.io/docs/features/software-catalog/extending-the-model--old"><link data-rh="true" rel="alternate" href="https://backstage.io/docs/features/software-catalog/extending-the-model--old" hreflang="en"><link data-rh="true" rel="alternate" href="https://backstage.io/docs/features/software-catalog/extending-the-model--old" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://JCMFNHCHI8-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Backstage Software Catalog and Developer Platform RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Backstage Software Catalog and Developer Platform Atom Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-KSEVGGNCJW"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-KSEVGGNCJW",{})</script>



<link rel="search" type="application/opensearchdescription+xml" title="Backstage Software Catalog and Developer Platform" href="/opensearch.xml">




<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pushfeedback@latest/dist/pushfeedback/pushfeedback.css">


<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=IBM+Plex+Mono:500,700&display=swap">
<script src="https://buttons.github.io/buttons.js"></script>
<script src="https://unpkg.com/medium-zoom@1.0.6/dist/medium-zoom.min.js"></script>
<script src="/js/medium-zoom.js"></script>
<script src="/js/dismissable-banner.js"></script>
<script src="/js/scroll-nav-to-view-in-docs.js"></script><link rel="stylesheet" href="/assets/css/styles.a6a6a0a6.css">
<script src="/assets/js/runtime~main.43487e4c.js" defer="defer"></script>
<script src="/assets/js/main.8d0200c2.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||"dark"),document.documentElement.setAttribute("data-theme-choice",t||"dark")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo-black.svg" alt="Backstage Software Catalog and Developer Platform" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="Backstage Software Catalog and Developer Platform" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div></a><a class="navbar__item navbar__link" href="/docs/overview/what-is-backstage">Docs</a><a class="navbar__item navbar__link" href="/plugins">Plugins</a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Reference</a><ul class="dropdown__menu"><li><a href="https://backstage.io/api/stable" target="_self" rel="noopener noreferrer" class="dropdown__link">Stable (v1.47.0)<svg width="12" height="12" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li><a href="https://backstage.io/api/next" target="_self" rel="noopener noreferrer" class="dropdown__link">Next<svg width="12" height="12" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><a class="navbar__item navbar__link" href="/docs/releases/v1.47.0">Releases</a><a class="navbar__item navbar__link" href="/blog">Blog</a><a class="navbar__item navbar__link" href="/demos">Demos</a><a class="navbar__item navbar__link" href="/community">Community</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/backstage/backstage" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><a href="https://discord.gg/backstage-687207715902193673" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-discord-link" aria-label="Discord community"></a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a aria-current="page" class="navbar__link active" aria-haspopup="true" aria-expanded="false" role="button" href="/docs/features/software-catalog/extending-the-model--old">Stable</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/next/features/software-catalog/extending-the-model--old">Next</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/docs/features/software-catalog/extending-the-model--old">Stable</a></li></ul></div><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search (Meta+k)" aria-keyshortcuts="Meta+k"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 24 24" aria-hidden="true"><circle cx="11" cy="11" r="8" stroke="currentColor" fill="none" stroke-width="1.4"></circle><path d="m21 21-4.3-4.3" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><main class="docMainContainer_TBSr docMainContainerEnhanced_lQrH"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_xLCN"><div class="docItemContainer_jfFK"><article><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Extending the model</h1></header><div class="row"><div class="col col--12 markdown"><p>The Backstage catalog <a class="" href="/docs/features/software-catalog/descriptor-format">entity data model</a> is based on the
<a href="https://kubernetes.io/docs/concepts/overview/working-with-objects/kubernetes-objects/" target="_blank" rel="noopener noreferrer" class="">Kubernetes objects format</a>,
and borrows a lot of its semantics as well. This page describes those semantics
at a higher level and how to extend them to fit your organization.</p>
<p>Backstage comes with a number of catalog concepts out of the box:</p>
<ul>
<li class="">There are a number of builtin versioned <em>kinds</em>, such as <code>Component</code>, <code>User</code>
etc. These encapsulate the high level concept of an entity, and define the
schema for its entity definition data.</li>
<li class="">An entity has both a <em>metadata</em> object and a <em>spec</em> object at the root.</li>
<li class="">Each kind may or may not have a <em>type</em>. For example, there are several well
known types of component, such as <code>service</code> and <code>website</code>. These clarify the
more detailed nature of the entity, and may affect what features are exposed
in the interface.</li>
<li class="">Entities may have a number of <em><a class="" href="/docs/features/software-catalog/well-known-annotations">annotations</a></em> on
them. These can be added either by humans into the descriptor files, or added
by automated processes when the entity is ingested into the catalog.</li>
<li class="">Entities may have a number of <em>labels</em> on them.</li>
<li class="">Entities may have a number of <em>relations</em>, expressing how they relate to each
other in different ways.</li>
</ul>
<p>We&#x27;ll list different possibilities for extending this below.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="adding-a-new-apiversion-of-an-existing-kind">Adding a New <code>apiVersion</code> of an Existing Kind<a href="#adding-a-new-apiversion-of-an-existing-kind" class="hash-link" aria-label="Direct link to adding-a-new-apiversion-of-an-existing-kind" title="Direct link to adding-a-new-apiversion-of-an-existing-kind" translate="no">​</a></h2>
<p>Example intents:</p>
<blockquote>
<p>&quot;I want to evolve this core kind, tweaking the semantics a bit so I will bump
the <code>apiVersion</code> a step&quot;</p>
</blockquote>
<blockquote>
<p>&quot;This core kind is a decent fit but we want to evolve it at will so we&#x27;ll move
it to our own company&#x27;s <code>apiVersion</code> space and use that instead of
<code>backstage.io</code>.&quot;</p>
</blockquote>
<p>The <code>backstage.io</code> <code>apiVersion</code> space is reserved for use by the Backstage
maintainers. Please do not change or add versions within that space.</p>
<p>If you add an <a class="" href="/docs/features/software-catalog/descriptor-format#apiversion-and-kind-required"><code>apiVersion</code></a>
space of your own, you are effectively branching out from the underlying kind
and making your own. An entity kind is identified by the <code>apiVersion</code> + <code>kind</code> pair,
so even though the resulting entity may be similar to the core one, there will
be no guarantees that plugins will be able to parse or understand its data. See
below about adding a new kind.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="adding-a-new-kind">Adding a New Kind<a href="#adding-a-new-kind" class="hash-link" aria-label="Direct link to Adding a New Kind" title="Direct link to Adding a New Kind" translate="no">​</a></h2>
<p>Example intents:</p>
<blockquote>
<p>&quot;The kinds that come with the package are lacking. I want to model this other
thing that is a poor fit for either of the builtins.&quot;</p>
</blockquote>
<blockquote>
<p>&quot;This core kind is a decent fit but we want to evolve it at will so we&#x27;ll move
it to our own company&#x27;s <code>apiVersion</code> space and use that instead of
<code>backstage.io</code>.&quot;</p>
</blockquote>
<p>A <a class="" href="/docs/features/software-catalog/descriptor-format#apiversion-and-kind-required">kind</a> is an overarching
family, or an idea if you will, of entities that also share a schema. Backstage
comes with a number of builtin ones that we believe are useful for a large
variety of needs that one may want to model in Backstage. The primary ambition
is to map things to these kinds, but sometimes you may want or need to extend
beyond them.</p>
<p>Introducing a new <code>apiVersion</code> is basically the same as adding a new kind. Bear in
mind that most plugins will be compiled against the builtin
<code>@backstage/catalog-model</code> package and have expectations that kinds align with
that.</p>
<p>The catalog backend itself, from a storage and API standpoint, does not care
about the kind of entities it stores. Extending with new kinds is mainly a
matter of permitting them to pass validation when building the backend catalog
using the <code>CatalogBuilder</code>, and then to make plugins be able to understand the
new kind.</p>
<p>For the consuming side, it&#x27;s a different story. Adding a kind has a very large
impact. The very foundation of Backstage is to attach behavior and views and
functionality to entities that we ascribe some meaning to. There will be many
places where code checks <code>if (kind === &#x27;X&#x27;)</code> for some hard coded <code>X</code>, and casts
it to a concrete type that it imported from a package such as
<code>@backstage/catalog-model</code>.</p>
<p>If you want to model something that doesn&#x27;t feel like a fit for either of the
builtin kinds, feel free to reach out to the Backstage maintainers to discuss
how to best proceed.</p>
<p>If you end up adding that new kind, you must namespace its <code>apiVersion</code>
accordingly with a prefix that makes sense, typically based on your organization
name - e.g. <code>my-company.net/v1</code>. Also do pick a new <code>kind</code> identifier that does
not collide with the builtin kinds.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="adding-a-new-type-of-an-existing-kind">Adding a New Type of an Existing Kind<a href="#adding-a-new-type-of-an-existing-kind" class="hash-link" aria-label="Direct link to Adding a New Type of an Existing Kind" title="Direct link to Adding a New Type of an Existing Kind" translate="no">​</a></h2>
<p>Example intents:</p>
<blockquote>
<p>&quot;This is clearly a component, but it&#x27;s of a type that doesn&#x27;t quite fit with
the ones I&#x27;ve seen before.&quot;</p>
</blockquote>
<blockquote>
<p>&quot;We don&#x27;t call our teams &quot;team&quot;, can&#x27;t we put &quot;flock&quot; as the group type?&quot;</p>
</blockquote>
<p>Some entity kinds have a <code>type</code> field in its spec. This is where an organization
are free to express the variety of entities within a kind. This field is
expected to follow some taxonomy that makes sense for yourself. The chosen value
may affect what operations and views are enabled in Backstage for that entity.
Inside Spotify our model has grown significantly over the years, and our
component types now include ML models, apps, data pipelines and many more.</p>
<p>It might be tempting to put software that doesn&#x27;t fit into any of the existing
types into an Other catch-all type. There are a few reasons why we advise
against this; firstly, we have found that it is preferred to match the
conceptual model that your engineers have when describing your software.
Secondly, Backstage helps your engineers manage their software by integrating
the infrastructure tooling through plugins. Different plugins are used for
managing different types of components.</p>
<p>For example, the
<a href="https://github.com/backstage/community-plugins/tree/main/workspaces/lighthouse/plugins/lighthouse" target="_blank" rel="noopener noreferrer" class="">Lighthouse plugin</a>
only makes sense for Websites. The more specific you can be in how you model
your software, the easier it is to provide plugins that are contextual.</p>
<p>Adding a new type takes relatively little effort and carries little risk. Any
type value is accepted by the catalog backend, but plugins may have to be
updated if you want particular behaviors attached to that new type.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="changing-the-validation-rules-for-the-entity-envelope-or-metadata-fields">Changing the Validation Rules for The Entity Envelope or Metadata Fields<a href="#changing-the-validation-rules-for-the-entity-envelope-or-metadata-fields" class="hash-link" aria-label="Direct link to Changing the Validation Rules for The Entity Envelope or Metadata Fields" title="Direct link to Changing the Validation Rules for The Entity Envelope or Metadata Fields" translate="no">​</a></h2>
<p>Example intents:</p>
<blockquote>
<p>&quot;We want to import our old catalog but the default set of allowed characters
for a metadata.name are too strict.&quot;</p>
</blockquote>
<blockquote>
<p>&quot;I want to change the rules for annotations so that I&#x27;m allowed to store any
data in annotation values, not just strings.&quot;</p>
</blockquote>
<p>After pieces of raw entity data have been read from a location, they are passed
through a field format validation step. This ensures that the types and syntax
of the base envelope and metadata make sense - in short, things that aren&#x27;t
entity-kind-specific. Some or all of these validators can be replaced when
building the backend using the catalog&#x27;s dedicated <code>catalogModelExtensionPoint</code>
(or directly on the <code>CatalogBuilder</code> if you are still using the old backend
system).</p>
<p>The risk and impact of this type of extension varies, based on what it is that
you want to do. For example, extending the valid character set for kinds,
namespaces and names can be fairly harmless, with a few notable exceptions -
there is code that expects these to never ever contain a colon or slash, for
example, and introducing URL-unsafe characters risks breaking plugins that
aren&#x27;t careful about encoding arguments. Supporting non-strings in annotations
may be possible but has not yet been tried out in the real world - there is
likely to be some level of plugin breakage that can be hard to predict.</p>
<p>You must also be careful about not making the rules <em>more strict</em> than they used
to be after populating the catalog with data. This risks making previously valid
entities start having processing errors and fail to update.</p>
<p>Before making this kind of extension, we recommend that you contact the
Backstage maintainers or a support partner to discuss your use case.</p>
<p>This is an example of relaxing the format rules of the <code>metadata.name</code> field:</p>
<div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#232323"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar" style="color:#9CDCFE;background-color:#232323"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token keyword" style="color:rgb(86, 156, 214)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> createBackend </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;@backstage/backend-defaults&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> createBackendModule </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;@backstage/backend-plugin-api&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> catalogModelExtensionPoint </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;@backstage/plugin-catalog-node/alpha&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> myCatalogCustomizations </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">createBackendModule</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  pluginId</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;catalog&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  moduleId</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;catalog-customization&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token function" style="color:rgb(220, 220, 170)">register</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">reg</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    reg</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token function" style="color:rgb(220, 220, 170)">registerInit</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      deps</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        catalogModel</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> catalogModelExtensionPoint</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token keyword" style="color:rgb(86, 156, 214)">async</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">init</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> catalogModel </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        catalogModel</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token function" style="color:rgb(220, 220, 170)">setFieldValidators</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">          </span><span class="token comment" style="color:rgb(106, 153, 85)">// This is only one of many methods that you can pass into</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">          </span><span class="token comment" style="color:rgb(106, 153, 85)">// setFieldValidators; your editor of choice should help you</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">          </span><span class="token comment" style="color:rgb(106, 153, 85)">// find the others. The length checks and regexp inside are</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">          </span><span class="token comment" style="color:rgb(106, 153, 85)">// just examples and can be adjusted as needed, but take care</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">          </span><span class="token comment" style="color:rgb(106, 153, 85)">// to test your changes thoroughly to ensure that you get</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">          </span><span class="token comment" style="color:rgb(106, 153, 85)">// them right.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">          </span><span class="token function" style="color:rgb(220, 220, 170)">isValidEntityName</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">value</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token keyword" style="color:rgb(86, 156, 214)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">              </span><span class="token keyword" style="color:rgb(86, 156, 214)">typeof</span><span class="token plain"> value </span><span class="token operator" style="color:rgb(212, 212, 212)">===</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;string&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">&amp;&amp;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">              value</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">length </span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;=</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">&amp;&amp;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">              value</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">length </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;=</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">63</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">&amp;&amp;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">              </span><span class="token regex regex-delimiter">/</span><span class="token regex regex-source language-regex anchor function" style="color:rgb(220, 220, 170)">^</span><span class="token regex regex-source language-regex char-class char-class-punctuation punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token regex regex-source language-regex char-class range">A</span><span class="token regex regex-source language-regex char-class range range-punctuation operator" style="color:rgb(212, 212, 212)">-</span><span class="token regex regex-source language-regex char-class range">Z</span><span class="token regex regex-source language-regex char-class range">a</span><span class="token regex regex-source language-regex char-class range range-punctuation operator" style="color:rgb(212, 212, 212)">-</span><span class="token regex regex-source language-regex char-class range">z</span><span class="token regex regex-source language-regex char-class range">0</span><span class="token regex regex-source language-regex char-class range range-punctuation operator" style="color:rgb(212, 212, 212)">-</span><span class="token regex regex-source language-regex char-class range">9</span><span class="token regex regex-source language-regex char-class">@+_.-</span><span class="token regex regex-source language-regex char-class char-class-punctuation punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token regex regex-source language-regex quantifier number" style="color:rgb(181, 206, 168)">+</span><span class="token regex regex-source language-regex anchor function" style="color:rgb(220, 220, 170)">$</span><span class="token regex regex-delimiter">/</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token function" style="color:rgb(220, 220, 170)">test</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">value</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">          </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> backend </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">createBackend</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">// ... add other backend features and the catalog backend itself here ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">backend</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token function" style="color:rgb(220, 220, 170)">add</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">myCatalogCustomizations</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">backend</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token function" style="color:rgb(220, 220, 170)">start</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="changing-the-validation-rules-for-core-entity-fields">Changing the Validation Rules for Core Entity Fields<a href="#changing-the-validation-rules-for-core-entity-fields" class="hash-link" aria-label="Direct link to Changing the Validation Rules for Core Entity Fields" title="Direct link to Changing the Validation Rules for Core Entity Fields" translate="no">​</a></h2>
<p>Example intent:</p>
<blockquote>
<p>&quot;I don&#x27;t like that the owner is mandatory. I&#x27;d like it to be optional.&quot;</p>
</blockquote>
<p>After reading and policy-checked entity data from a location, it is sent through
the processor chain looking for processors that implement the
<code>validateEntityKind</code> step, to see that the data is of a known kind and abides by
its schema. There is a builtin processor that implements this for all known core
kinds and matches the data against their fixed validation schema. This processor
can be replaced when building the backend catalog using the <code>CatalogBuilder</code>,
with a processor of your own that validates the data differently.
This replacement processor must have a name that matches the builtin processor, <code>BuiltinKindsEntityProcessor</code>.</p>
<p>This type of extension is high risk, and may have high impact across the
ecosystem depending on the type of change that is made. It is therefore not
recommended in normal cases. There will be a large number of plugins and
processors - and even the core itself - that make assumptions about the shape of
the data and import the typescript data type from the <code>@backstage/catalog-model</code>
package.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="adding-new-fields-to-the-metadata-object">Adding New Fields to the Metadata Object<a href="#adding-new-fields-to-the-metadata-object" class="hash-link" aria-label="Direct link to Adding New Fields to the Metadata Object" title="Direct link to Adding New Fields to the Metadata Object" translate="no">​</a></h2>
<p>Example intent:</p>
<blockquote>
<p>&quot;Our entities have this auxiliary property that I would like to express for
several entity kinds and it doesn&#x27;t really fit as a spec field.&quot;</p>
</blockquote>
<p>The metadata object is currently left open for extension. Any unknown fields
found in the metadata will just be stored verbatim in the catalog. However we
want to caution against extending the metadata excessively. Firstly, you run the
risk of colliding with future extensions to the model. Secondly, it is common
that this type of extension lives more comfortably elsewhere - primarily in the
metadata labels or annotations, but sometimes you even may want to make a new
component type or similar instead.</p>
<p>There are some situations where metadata can be the right place. If you feel
that you have run into such a case and that it would apply to others, do feel
free to contact the Backstage maintainers or a support partner to discuss your
use case. Maybe we can extend the core model to benefit both you and others.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="adding-new-fields-to-the-spec-object-of-an-existing-kind">Adding New Fields to the Spec Object of an Existing Kind<a href="#adding-new-fields-to-the-spec-object-of-an-existing-kind" class="hash-link" aria-label="Direct link to Adding New Fields to the Spec Object of an Existing Kind" title="Direct link to Adding New Fields to the Spec Object of an Existing Kind" translate="no">​</a></h2>
<p>Example intent:</p>
<blockquote>
<p>&quot;The builtin Component kind is fine but we want to add an additional field to
the spec for describing whether it&#x27;s in prod or staging.&quot;</p>
</blockquote>
<p>A kind&#x27;s schema validation typically doesn&#x27;t forbid &quot;unknown&quot; fields in an
entity <code>spec</code>, and the catalog will happily store whatever is in it. So doing
this will usually work from the catalog&#x27;s point of view.</p>
<p>Adding fields like this is subject to the same risks as mentioned about metadata
extensions above. Firstly, you run the risk of colliding with future extensions
to the model. Secondly, it is common that this type of extension lives more
comfortably elsewhere - primarily in the metadata labels or annotations, but
sometimes you even may want to make a new component type or similar instead.</p>
<p>There are some situations where the spec can be the right place. If you feel
that you have run into such a case and that it would apply to others, do feel
free to contact the Backstage maintainers or a support partner to discuss your
use case. Maybe we can extend the core model to benefit both you and others.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="adding-a-new-annotation">Adding a New Annotation<a href="#adding-a-new-annotation" class="hash-link" aria-label="Direct link to Adding a New Annotation" title="Direct link to Adding a New Annotation" translate="no">​</a></h2>
<p>Example intents:</p>
<blockquote>
<p>&quot;Our custom made build system has the concept of a named pipeline-set, and we
want to associate individual components with their corresponding pipeline-sets
so we can show their build status.&quot;</p>
</blockquote>
<blockquote>
<p>&quot;We have an alerting system that automatically monitors service health, and
there&#x27;s this integration key that binds the service to an alerts pool. We want
to be able to show the ongoing alerts for our services in Backstage so it&#x27;d be
nice to attach that integration key to the entity somehow.&quot;</p>
</blockquote>
<p>Annotations are mainly intended to be consumed by plugins, for feature detection
or linking into external systems. Sometimes they are added by humans, but often
they are automatically generated at ingestion time by processors. There is a set
of <a class="" href="/docs/features/software-catalog/well-known-annotations">well-known annotations</a>, but you are free to add
additional ones. This carries no risk or impact to other systems as long as you
abide by the following naming rules.</p>
<ul>
<li class="">The <code>backstage.io</code> annotation prefix is reserved for use by the Backstage
maintainers. Reach out to us if you feel that you would like to make an
addition to that prefix.</li>
<li class="">Annotations that pertain to a well known third party system should ideally be
prefixed with a domain, in a way that makes sense to a reader and connects it
clearly to the system (or the maker of the system). For example, you might use
a <code>pagerduty.com</code> prefix for pagerduty related annotations, but maybe not
<code>ldap.com</code> for LDAP annotations since it&#x27;s not directly affiliated with or
owned by an LDAP foundation/company/similar.</li>
<li class="">Annotations that have no prefix at all, are considered local to your Backstage
instance and can be used freely as such, but you should not make use of them
outside of your organization. For example, if you were to open source a plugin
that generates or consumes annotations, then those annotations must be
properly prefixed with your company domain or a domain that pertains to the
annotation at hand.</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="adding-a-new-label">Adding a New Label<a href="#adding-a-new-label" class="hash-link" aria-label="Direct link to Adding a New Label" title="Direct link to Adding a New Label" translate="no">​</a></h2>
<p>Example intents:</p>
<blockquote>
<p>&quot;Our process reaping system wants to periodically scrape for components that
have a certain property.&quot;</p>
</blockquote>
<blockquote>
<p>&quot;It&#x27;d be nice if our service owners could just tag their components somehow to
let the CD system know to automatically generate SRV records or not for that
service.&quot;</p>
</blockquote>
<p>Labels are mainly intended to be used for filtering of entities, by external
systems that want to find entities that have some certain property. This is
sometimes used for feature detection / selection. An example could be to add a
label <code>deployments.my-company.net/register-srv: &quot;true&quot;</code>.</p>
<p>At the time of writing this, the use of labels is very limited and we are still
settling together with the community on how to best use them. If you feel that
your use case fits the labels best, we would appreciate if you let the Backstage
maintainers know.</p>
<p>You are free to add labels. This carries no risk or impact to other systems as
long as you abide by the following naming rules.</p>
<ul>
<li class="">The <code>backstage.io</code> label prefix is reserved for use by the Backstage
maintainers. Reach out to us if you feel that you would like to make an
addition to that prefix.</li>
<li class="">Labels that pertain to a well known third party system should ideally be
prefixed with a domain, in a way that makes sense to a reader and connects it
clearly to the system (or the maker of the system). For example, you might use
a <code>pagerduty.com</code> prefix for pagerduty related labels, but maybe not
<code>ldap.com</code> for LDAP labels since it&#x27;s not directly affiliated with or owned by
an LDAP foundation/company/similar.</li>
<li class="">Labels that have no prefix at all, are considered local to your Backstage
instance and can be used freely as such, but you should not make use of them
outside of your organization. For example, if you were to open source a plugin
that generates or consumes labels, then those labels must be properly prefixed
with your company domain or a domain that pertains to the label at hand.</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="adding-a-new-relation-type">Adding a New Relation Type<a href="#adding-a-new-relation-type" class="hash-link" aria-label="Direct link to Adding a New Relation Type" title="Direct link to Adding a New Relation Type" translate="no">​</a></h2>
<p>Example intents:</p>
<blockquote>
<p>&quot;We have this concept of service maintainership, separate from ownership, that
we would like to make relations to individual users for.&quot;</p>
</blockquote>
<blockquote>
<p>&quot;We feel that we want to explicitly model the team-to-global-department
mapping as a relation, because it is core to our org setup and we frequently
query for it.&quot;</p>
</blockquote>
<p>Any processor can emit relations for entities as they are being processed, and
new processors can be added when building the backend catalog using the
<code>CatalogBuilder</code>. They can emit relations based on the entity data itself, or
based on information gathered from elsewhere. Relations are directed and go from
a source entity to a target entity. They are also tied to the entity that
originated them - the one that was subject to processing when the relation was
emitted. Relations may be dangling (referencing something that does not actually
exist by that name in the catalog), and callers need to be aware of that.</p>
<p>There is a set of <a class="" href="/docs/features/software-catalog/well-known-relations">well-known relations</a>, but you are
free to emit your own as well. You cannot change the fact that they are directed
and have a source and target that have to be an
<a class="" href="/docs/features/software-catalog/references">entity reference</a>, but you can invent your own types. You do not
have to make any changes to the catalog backend in order to accept new relation
types.</p>
<p>At the time of writing this, we do not have any namespacing/prefixing scheme for
relation types. The type is also not validated to contain only some particular
set of characters. Until rules for this are settled, you should stick to using
only letters, dashes and digits, and to avoid collisions with future core
relation types, you may want to prefix the type somehow. For example:
<code>myCompany-maintainerOf</code> + <code>myCompany-maintainedBy</code>.</p>
<p>If you have a suggestion for a relation type to be elevated to the core
offering, reach out to the Backstage maintainers or a support partner.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="using-a-well-known-relation-type-for-a-new-purpose">Using a Well-Known Relation Type for a New Purpose<a href="#using-a-well-known-relation-type-for-a-new-purpose" class="hash-link" aria-label="Direct link to Using a Well-Known Relation Type for a New Purpose" title="Direct link to Using a Well-Known Relation Type for a New Purpose" translate="no">​</a></h2>
<p>Example intents:</p>
<blockquote>
<p>&quot;The ownerOf/ownedBy relation types sound like a good fit for expressing how
users are technical owners of our company specific ServiceAccount kind, and we
want to reuse those relation types for that.&quot;</p>
</blockquote>
<p>At the time of writing, this is uncharted territory. If the documented use of a
relation states that one end of the relation commonly is a User or a Group, for
example, then consumers are likely to have conditional statements on the form
<code>if (x.kind === &#x27;User&#x27;) {} else {}</code>, which get confused when an unexpected kind
appears.</p>
<p>If you want to extend the use of an established relation type in a way that has
an effect outside of your organization, reach out to the Backstage maintainers
or a support partner to discuss risk/impact. It may even be that one end of the
relation could be considered for addition to the core.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="adding-a-new-status-field">Adding a New Status field<a href="#adding-a-new-status-field" class="hash-link" aria-label="Direct link to Adding a New Status field" title="Direct link to Adding a New Status field" translate="no">​</a></h2>
<p>Example intent:</p>
<blockquote>
<p>&quot;We would like to convey entity statuses through the catalog in a generic way,
as an integration layer. Our monitoring and alerting system has a plugin with
Backstage, and it would be useful if the entity&#x27;s status field contained the
current alert state close to the actual entity data for anyone to consume. We
find the <code>status.items</code> semantics a poor fit, so we would prefer to make our
own custom field under <code>status</code> for these purposes.&quot;</p>
</blockquote>
<p>We have not yet ventured to define any generic semantics for the <code>status</code>
object. We recommend sticking with the <code>status.items</code> mechanism where possible
(see below), since third party consumers will not be able to consume your status
information otherwise. Please reach out to the maintainers on Discord or by
making a GitHub issue describing your use case if you are interested in this
topic.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="adding-a-new-status-item-type">Adding a New Status Item Type<a href="#adding-a-new-status-item-type" class="hash-link" aria-label="Direct link to Adding a New Status Item Type" title="Direct link to Adding a New Status Item Type" translate="no">​</a></h2>
<p>Example intent:</p>
<blockquote>
<p>&quot;The semantics of the entity <code>status.items</code> field are fine for our needs, but
we want to contribute our own type of status into that array instead of the
catalog specific one.&quot;</p>
</blockquote>
<p>This is a simple, low risk way of adding your own status information to
entities. Consumers will be able to easily track and display the status together
with other types / sources.</p>
<p>We recommend that any status type that are not strictly private within the
organization be namespaced to avoid collisions. Statuses emitted by Backstage
core processes will for example be prefixed with <code>backstage.io/</code>, your
organization may prefix with <code>my-org.net/</code>, and <code>pagerduty.com/active-alerts</code>
could be a sensible complete status item type for that particular external
system.</p>
<p>The mechanics for how to emit custom statuses is not in place yet, so if this is
of interest to you, you might consider contacting the maintainers on Discord or
my making a GitHub issue describing your use case.
<a href="https://github.com/backstage/backstage/issues/2292" target="_blank" rel="noopener noreferrer" class="">This issue</a> also contains
more context.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="referencing-different-environments-with-the-model">Referencing different environments with the model<a href="#referencing-different-environments-with-the-model" class="hash-link" aria-label="Direct link to Referencing different environments with the model" title="Direct link to Referencing different environments with the model" translate="no">​</a></h2>
<p>Example intent:</p>
<blockquote>
<p>&quot;I have multiple versions of my API deployed in different environments so I
want to have <code>mytool-dev</code> and <code>mytool-prod</code> as different entities.&quot;</p>
</blockquote>
<p>While it&#x27;s possible to have different versions of the same thing represented as
separate entities, it&#x27;s something we generally recommend against. We believe
that a developer should be able to just find for example one <code>Component</code>
representing a service, and to be able to see the different code versions that
are deployed throughout your stack within its view. This reasoning works
similarly for other kinds as well, such as <code>API</code>.</p>
<p>That being said - sometimes the differences between versions are so large, that
they represent what is for all intents and purposes an entirely new entity as
seen from the consumer&#x27;s point of view. This can happen for example for
different <em>significant</em> major versions of an API, and in particular if the two
major versions coexist in the ecosystem for some time. In those cases, it can be
motivated to have one <code>my-api-v2</code> and one <code>my-api-v3</code> named entity. This matches
the end user&#x27;s expectations when searching for the API, and matches the desire
to maybe have separate documentation for the two and similar. But use this
sparingly - only do it if the extra modelling burden is outweighed by any
potential better clarity for users.</p>
<p>When writing your custom plugins, we encourage designing them such that they can
show all the different variations through environments etc under one canonical
reference to your software in the catalog. For example for a continuous
deployment plugin, a user is likely to be greatly helped by being able to see
the entity&#x27;s versions deployed in all different environments next to each other
in one view. That is also where they might be offered the ability to promote
from one environment to the other, do rollbacks, see their relative performance
metrics, and similar. This coherency and collection of tooling in one place is
where something like Backstage can offer the most value and effectiveness of
use. Splitting your entities apart into small islands makes this harder.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="implementing-custom-model-extensions">Implementing custom model extensions<a href="#implementing-custom-model-extensions" class="hash-link" aria-label="Direct link to Implementing custom model extensions" title="Direct link to Implementing custom model extensions" translate="no">​</a></h2>
<p>This section walks you through the steps involved extending the catalog model
with a new Entity type.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="creating-a-custom-entity-definition">Creating a custom entity definition<a href="#creating-a-custom-entity-definition" class="hash-link" aria-label="Direct link to Creating a custom entity definition" title="Direct link to Creating a custom entity definition" translate="no">​</a></h3>
<p>The first step of introducing a custom entity is to define what shape and schema
it has. We do this using a TypeScript type, as well as a JSONSchema schema.</p>
<p>Most of the time you will want to have at least the TypeScript type of your
extension available in both frontend and backend code, which means you likely
want to have an isomorphic package that houses these types. Within the Backstage
main repo the package naming pattern of <code>&lt;plugin&gt;-common</code> is used for isomorphic
packages, and you may choose to adopt this pattern as well.</p>
<p>You can generate an isomorphic plugin package by running: <code>yarn new</code> and then
select &quot;plugin-common&quot; from the list of options</p>
<p>There&#x27;s at this point no existing templates for generating isomorphic plugins
using the <code>@backstage/cli</code>. Perhaps the simplest way to get started right now is
to copy the contents of one of the existing packages in the main repository,
such as <code>plugins/scaffolder-common</code>, and rename the folder and file contents to
the desired name. This example uses <em>foobar</em> as the plugin name so the plugin
will be named <em>foobar-common</em>.</p>
<p>Once you have a common package in place you can start adding your own entity
definitions. For the exact details on how to do that we defer to getting
inspired by the existing
<a href="https://github.com/backstage/backstage/tree/master/plugins/scaffolder-common/src/index.ts" target="_blank" rel="noopener noreferrer" class="">scaffolder-common</a>
package. But in short you will need to declare a TypeScript type and a
JSONSchema for the new entity kind.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="building-a-custom-processor-for-the-entity">Building a custom processor for the entity<a href="#building-a-custom-processor-for-the-entity" class="hash-link" aria-label="Direct link to Building a custom processor for the entity" title="Direct link to Building a custom processor for the entity" translate="no">​</a></h3>
<p>The next step is to create a custom processor for your new entity kind. This
will be used within the catalog to make sure that it&#x27;s able to ingest and
validate entities of our new kind. Just like with the definition package, you
can find inspiration in for example the existing
<a href="https://github.com/backstage/backstage/tree/master/plugins/catalog-backend-module-scaffolder-entity-model/src/processor/ScaffolderEntitiesProcessor.ts" target="_blank" rel="noopener noreferrer" class="">ScaffolderEntitiesProcessor</a>.
We also provide a high-level example of what a catalog process for a custom
entity might look like:</p>
<div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#232323"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar" style="color:#9CDCFE;background-color:#232323"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token keyword" style="color:rgb(86, 156, 214)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> CatalogProcessor</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> CatalogProcessorEmit</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> processingResult </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;@backstage/plugin-catalog-node&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> LocationSpec </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;@backstage/plugin-catalog-common&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> Entity</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> entityKindSchemaValidator </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;@backstage/catalog-model&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">// For an example of the JSONSchema format and how to use $ref markers to the</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">// base definitions, see:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">// https://github.com/backstage/backstage/tree/master/packages/catalog-model/src/schema/kinds/Component.v1alpha1.schema.json</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> foobarEntityV1alpha1Schema </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;@internal/catalog-model&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">export</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">class</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(78, 201, 176)">FoobarEntitiesProcessor</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">implements</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(78, 201, 176)">CatalogProcessor</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)">// You often end up wanting to support multiple versions of your kind as you</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)">// iterate on the definition, so we keep each version inside this array as a</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)">// convenient pattern.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">private</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">readonly</span><span class="token plain"> validators </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)">// This is where we use the JSONSchema that we export from our isomorphic</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)">// package</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token function" style="color:rgb(220, 220, 170)">entityKindSchemaValidator</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">foobarEntityV1alpha1Schema</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)">// Return processor name</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token function" style="color:rgb(220, 220, 170)">getProcessorName</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(86, 156, 214)">string</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">return</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;FoobarEntitiesProcessor&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)">// validateEntityKind is responsible for signaling to the catalog processing</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)">// engine that this entity is valid and should therefore be submitted for</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)">// further processing.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">async</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">validateEntityKind</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">entity</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> Entity</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(86, 156, 214)">Promise</span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token builtin" style="color:rgb(86, 156, 214)">boolean</span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">for</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> validator </span><span class="token keyword" style="color:rgb(86, 156, 214)">of</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">this</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">validators</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token comment" style="color:rgb(106, 153, 85)">// If the validator throws an exception, the entity will be marked as</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token comment" style="color:rgb(106, 153, 85)">// invalid.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token keyword" style="color:rgb(86, 156, 214)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token function" style="color:rgb(220, 220, 170)">validator</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">entity</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token keyword" style="color:rgb(86, 156, 214)">return</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)">// Returning false signals that we don&#x27;t know what this is, passing the</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)">// responsibility to other processors to try to validate it instead.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">return</span><span class="token plain"> </span><span class="token boolean">false</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">async</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">postProcessEntity</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    entity</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> Entity</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    _location</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> LocationSpec</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    emit</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> CatalogProcessorEmit</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(86, 156, 214)">Promise</span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token plain">Entity</span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      entity</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">apiVersion </span><span class="token operator" style="color:rgb(212, 212, 212)">===</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;example.com/v1alpha1&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">&amp;&amp;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      entity</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">kind </span><span class="token operator" style="color:rgb(212, 212, 212)">===</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;Foobar&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> foobarEntity </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> entity </span><span class="token keyword" style="color:rgb(86, 156, 214)">as</span><span class="token plain"> FoobarEntityV1alpha1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token comment" style="color:rgb(106, 153, 85)">// Typically you will want to emit any relations associated with the</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token comment" style="color:rgb(106, 153, 85)">// entity here.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token function" style="color:rgb(220, 220, 170)">emit</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">processingResult</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token function" style="color:rgb(220, 220, 170)">relation</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">...</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">return</span><span class="token plain"> entity</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><br></span></code></pre></div></div>
<p>Once the processor is created it can be wired up to the catalog via the
<code>CatalogBuilder</code> in <code>packages/backend/src/plugins/catalog.ts</code>:</p>
<div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#232323"><div class="codeBlockTitle_OeMC">packages/backend/src/plugins/catalog.ts</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar" style="color:#9CDCFE;background-color:#232323"><code class="codeBlockLines_e6Vv"><span class="token-line code-block-add-line" style="color:#9CDCFE"><span class="token keyword" style="color:rgb(86, 156, 214)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> FoobarEntitiesProcessor </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;@internal/plugin-foobar-backend&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">export</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">default</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">async</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">createPlugin</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  env</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> PluginEnvironment</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(86, 156, 214)">Promise</span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token plain">Router</span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> builder </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">await</span><span class="token plain"> CatalogBuilder</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token function" style="color:rgb(220, 220, 170)">create</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">env</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line code-block-add-line" style="color:#9CDCFE"><span class="token plain">  builder</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token function" style="color:rgb(220, 220, 170)">addProcessor</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token keyword" style="color:rgb(86, 156, 214)">new</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(78, 201, 176)">FoobarEntitiesProcessor</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> processingEngine</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> router </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">await</span><span class="token plain"> builder</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token function" style="color:rgb(220, 220, 170)">build</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)">// ..</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><br></span></code></pre></div></div></div></div></div><div class="row"><div class="col col--12"><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col noPrint_WFHX"><a href="https://github.com/backstage/backstage/edit/master/docs/features/software-catalog/extending-the-model--old.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></div></div></article><div class="row"><div class="col col--12"><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"></nav></div></div></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#adding-a-new-apiversion-of-an-existing-kind" class="table-of-contents__link toc-highlight">Adding a New <code>apiVersion</code> of an Existing Kind</a></li><li><a href="#adding-a-new-kind" class="table-of-contents__link toc-highlight">Adding a New Kind</a></li><li><a href="#adding-a-new-type-of-an-existing-kind" class="table-of-contents__link toc-highlight">Adding a New Type of an Existing Kind</a></li><li><a href="#changing-the-validation-rules-for-the-entity-envelope-or-metadata-fields" class="table-of-contents__link toc-highlight">Changing the Validation Rules for The Entity Envelope or Metadata Fields</a></li><li><a href="#changing-the-validation-rules-for-core-entity-fields" class="table-of-contents__link toc-highlight">Changing the Validation Rules for Core Entity Fields</a></li><li><a href="#adding-new-fields-to-the-metadata-object" class="table-of-contents__link toc-highlight">Adding New Fields to the Metadata Object</a></li><li><a href="#adding-new-fields-to-the-spec-object-of-an-existing-kind" class="table-of-contents__link toc-highlight">Adding New Fields to the Spec Object of an Existing Kind</a></li><li><a href="#adding-a-new-annotation" class="table-of-contents__link toc-highlight">Adding a New Annotation</a></li><li><a href="#adding-a-new-label" class="table-of-contents__link toc-highlight">Adding a New Label</a></li><li><a href="#adding-a-new-relation-type" class="table-of-contents__link toc-highlight">Adding a New Relation Type</a></li><li><a href="#using-a-well-known-relation-type-for-a-new-purpose" class="table-of-contents__link toc-highlight">Using a Well-Known Relation Type for a New Purpose</a></li><li><a href="#adding-a-new-status-field" class="table-of-contents__link toc-highlight">Adding a New Status field</a></li><li><a href="#adding-a-new-status-item-type" class="table-of-contents__link toc-highlight">Adding a New Status Item Type</a></li><li><a href="#referencing-different-environments-with-the-model" class="table-of-contents__link toc-highlight">Referencing different environments with the model</a></li><li><a href="#implementing-custom-model-extensions" class="table-of-contents__link toc-highlight">Implementing custom model extensions</a><ul><li><a href="#creating-a-custom-entity-definition" class="table-of-contents__link toc-highlight">Creating a custom entity definition</a></li><li><a href="#building-a-custom-processor-for-the-entity" class="table-of-contents__link toc-highlight">Building a custom processor for the entity</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title"></div><ul class="footer__items clean-list"><li class="footer__item">
                <a href="/" aria-label="Backstage Home">
                  <div class="footerLogo"></div>
                </a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/overview/what-is-backstage">What is Backstage?</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/getting-started/">Getting started</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/features/software-catalog/">Software Catalog</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/plugins/create-a-plugin">Create a Plugin</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/dls/design">Designing for Backstage</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://discord.gg/backstage-687207715902193673" target="_blank" rel="noopener noreferrer" class="footer__link-item">Support chatroom</a></li><li class="footer__item"><a href="https://github.com/backstage/backstage/blob/master/CONTRIBUTING.md" target="_blank" rel="noopener noreferrer" class="footer__link-item">Contributing</a></li><li class="footer__item"><a href="https://backstage.io/docs/getting-started/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Adopting</a></li><li class="footer__item"><a href="https://spoti.fi/backstagenewsletter" target="_blank" rel="noopener noreferrer" class="footer__link-item">Subscribe to our newsletter</a></li><li class="footer__item"><a href="https://www.cncf.io/projects/" target="_blank" rel="noopener noreferrer" class="footer__link-item">CNCF Incubation</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/backstage/" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li><li class="footer__item"><a href="https://github.com/cncf/artwork/tree/main/projects/backstage" target="_blank" rel="noopener noreferrer" class="footer__link-item">Assets</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright"><p style="text-align:center"><a href="https://spotify.github.io/">Made with ❤️ at Spotify</a></p><p class="copyright">Copyright © 2026 Backstage Project Authors. All rights reserved. The Linux Foundation has registered trademarks and uses trademarks. For a list of trademarks of The Linux Foundation, please see our Trademark Usage page: <a href="https://www.linuxfoundation.org/trademark-usage">https://www.linuxfoundation.org/trademark-usage</p></div></div></div></footer></div>
<script type="module" src="https://cdn.jsdelivr.net/npm/pushfeedback@latest/dist/pushfeedback/pushfeedback.esm.js"></script>
<script>const feedbackButton=document.createElement("feedback-button");feedbackButton.setAttribute("project","q8w1i6cair"),feedbackButton.setAttribute("modal-position","bottom-right"),feedbackButton.setAttribute("button-style","dark"),feedbackButton.setAttribute("button-position","bottom-right"),feedbackButton.setAttribute("hide-icon","true"),feedbackButton.setAttribute("custom-font","true"),feedbackButton.setAttribute("rating-mode","stars"),feedbackButton.setAttribute("id","default"),feedbackButton.textContent="Feedback",document.body.appendChild(feedbackButton)</script></body>
</html>