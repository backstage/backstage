"use strict";(self.webpackChunkbackstage_microsite=self.webpackChunkbackstage_microsite||[]).push([["36437"],{122142(e,s,i){i.r(s),i.d(s,{assets:()=>a,contentTitle:()=>c,default:()=>m,frontMatter:()=>o,metadata:()=>r,toc:()=>l});var r=i(35074),n=i(474848),t=i(28453);let o={id:"permissions-registry",title:"Permissions Registry Service",sidebar_label:"Permissions Registry",description:"Documentation for the Permissions Registry service"},c,a={},l=[{value:"Using the service",id:"using-the-service",level:2},{value:"Migrating from <code>createPermissionIntegrationRouter</code>",id:"migrating-from-createpermissionintegrationrouter",level:2}];function d(e){let s={a:"a",code:"code",h2:"h2",p:"p",pre:"pre",...(0,t.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(s.p,{children:["This service allows your plugins to register new permissions, rules, and resource types and integrate with ",(0,n.jsx)(s.a,{href:"/docs/next/permissions/overview",children:"the permissions framework"}),"."]}),"\n",(0,n.jsx)(s.h2,{id:"using-the-service",children:"Using the service"}),"\n",(0,n.jsxs)(s.p,{children:["For a deep dive into how to use the ",(0,n.jsx)(s.code,{children:"permissionsRegistry"})," service, see the ",(0,n.jsx)(s.a,{href:"/docs/next/permissions/plugin-authors/01-setup",children:"permission guide for plugin authors"}),"."]}),"\n",(0,n.jsxs)(s.p,{children:["If all you want to do is add new custom permission rules to an existing plugin, you can instead refer to the ",(0,n.jsx)(s.a,{href:"/docs/next/permissions/custom-rules",children:"custom permission rules guide"}),"."]}),"\n",(0,n.jsxs)(s.h2,{id:"migrating-from-createpermissionintegrationrouter",children:["Migrating from ",(0,n.jsx)(s.code,{children:"createPermissionIntegrationRouter"})]}),"\n",(0,n.jsxs)(s.p,{children:["Before this service was introduced, plugins would use\n",(0,n.jsx)(s.code,{children:"createPermissionIntegrationRouter"})," to implement the same functionality. To\nmigrate a plugin, locate the ",(0,n.jsx)(s.code,{children:"createPermissionIntegrationRouter"})," call for your\nrouter and remove it, but copy all options that are passed to it, for example:"]}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-ts",children:"export async function createRouter() {\n  const router = Router();\n\n  /* highlight-remove-start */\n  const permissionIntegrationRouter = createPermissionIntegrationRouter({\n    resourceType: RESOURCE_TYPE_MY_RESOURCE,\n    permissions: [myResourcePermissions],\n    rules: [myResourceRule],\n  });\n\n  router.use(permissionIntegrationRouter);\n  /* highlight-remove-end */\n\n  // ...\n}\n"})}),"\n",(0,n.jsxs)(s.p,{children:["Next, add a dependency on the ",(0,n.jsx)(s.code,{children:"PermissionsRegistryService"})," to your plugin,\nand pass it the same options:"]}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-ts",children:"export const examplePlugin = createBackendPlugin({\n  pluginId: 'example',\n  register(env) {\n    env.registerInit({\n      deps: {\n        logger: coreServices.logger,\n        /* highlight-add-next-line */\n        permissionsRegistry: coreServices.permissionsRegistry,\n      },\n      /* highlight-remove-next-line */\n      async init({ logger }) {\n        /* highlight-add-next-line */\n      async init({ logger, permissionsRegistry }) {\n        logger.log('This is a silly example plugin with no functionality');\n\n        /* highlight-add-start */\n        permissionsRegistry.addResourceType({\n          resourceType: RESOURCE_TYPE_MY_RESOURCE,\n          permissions: [myResourcePermissions],\n          rules: [myResourceRule],\n        });\n        /* highlight-add-end */\n      },\n    });\n  },\n});\n"})}),"\n",(0,n.jsxs)(s.p,{children:["If you only passed the ",(0,n.jsx)(s.code,{children:"permissions"})," option to\n",(0,n.jsx)(s.code,{children:"createPermissionIntegrationRouter"}),", you will want to use\n",(0,n.jsx)(s.code,{children:"permissionsRegistry.addPermissions"})," instead."]}),"\n",(0,n.jsxs)(s.p,{children:["If you passed multiple resources types to ",(0,n.jsx)(s.code,{children:"createPermissionIntegrationRouter"}),"\nvia the ",(0,n.jsx)(s.code,{children:"resources"})," option, you will want to call\n",(0,n.jsx)(s.code,{children:"permissionsRegistry.addResourceType"})," multiple times for each of those\nresource types."]})]})}function m(e={}){let{wrapper:s}={...(0,t.R)(),...e.components};return s?(0,n.jsx)(s,{...e,children:(0,n.jsx)(d,{...e})}):d(e)}},28453(e,s,i){i.d(s,{R:()=>o,x:()=>c});var r=i(296540);let n={},t=r.createContext(n);function o(e){let s=r.useContext(t);return r.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function c(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:o(e.components),r.createElement(t.Provider,{value:s},e.children)}},35074(e){e.exports=JSON.parse('{"id":"backend-system/core-services/permissions-registry","title":"Permissions Registry Service","description":"Documentation for the Permissions Registry service","source":"@site/../docs/backend-system/core-services/permissionsRegistry.md","sourceDirName":"backend-system/core-services","slug":"/backend-system/core-services/permissions-registry","permalink":"/docs/next/backend-system/core-services/permissions-registry","draft":false,"unlisted":false,"editUrl":"https://github.com/backstage/backstage/edit/master/docs/backend-system/core-services/permissionsRegistry.md","tags":[],"version":"current","frontMatter":{"id":"permissions-registry","title":"Permissions Registry Service","sidebar_label":"Permissions Registry","description":"Documentation for the Permissions Registry service"},"sidebar":"docs","previous":{"title":"Permissions","permalink":"/docs/next/backend-system/core-services/permissions"},"next":{"title":"Plugin Metadata","permalink":"/docs/next/backend-system/core-services/plugin-metadata"}}')}}]);