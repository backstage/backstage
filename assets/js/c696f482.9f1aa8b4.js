"use strict";(self.webpackChunkbackstage_microsite=self.webpackChunkbackstage_microsite||[]).push([["97746"],{312389(e,t,n){n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>s,metadata:()=>c,toc:()=>d});var c=n(330615),i=n(474848),a=n(28453);let s={id:"builtin-actions",title:"Builtin actions",description:"Documentation describing the built-in template actions."},o,l={},d=[{value:"Action Modules",id:"action-modules",level:2},{value:"Installing Action Modules",id:"installing-action-modules",level:2},{value:"Listing Actions",id:"listing-actions",level:2},{value:"Migrating from <code>fetch:cookiecutter</code> to <code>fetch:template</code>",id:"migrating-from-fetchcookiecutter-to-fetchtemplate",level:2},{value:"Using <code>cookiecutterCompat</code> mode",id:"using-cookiecuttercompat-mode",level:3},{value:"Manual migration",id:"manual-migration",level:3}];function r(e){let t={a:"a",code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,a.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.p,{children:"The scaffolder comes with several built-in actions for fetching content,\nregistering in the catalog and of course actions for creating and publishing a\ngit repository."}),"\n",(0,i.jsx)(t.h2,{id:"action-modules",children:"Action Modules"}),"\n",(0,i.jsx)(t.p,{children:"There are several action modules that are available to be added:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.a,{href:"https://github.com/backstage/backstage/tree/master/plugins/scaffolder-backend-module-azure",children:"Azure DevOps"}),": ",(0,i.jsx)(t.code,{children:"@backstage/plugin-scaffolder-backend-module-azure"})]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.a,{href:"https://github.com/backstage/backstage/tree/master/plugins/scaffolder-backend-module-bitbucket-cloud",children:"Bitbucket Cloud"}),": ",(0,i.jsx)(t.code,{children:"@backstage/plugin-scaffolder-backend-module-bitbucket-cloud"})]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.a,{href:"https://github.com/backstage/backstage/tree/master/plugins/scaffolder-backend-module-bitbucket-server",children:"Bitbucket Server"}),": ",(0,i.jsx)(t.code,{children:"@backstage/plugin-scaffolder-backend-module-bitbucket-server"})]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.a,{href:"https://github.com/backstage/backstage/tree/master/plugins/scaffolder-backend-module-gerrit",children:"Gerrit"}),": ",(0,i.jsx)(t.code,{children:"@backstage/plugin-scaffolder-backend-module-gerrit"})]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.a,{href:"https://github.com/backstage/backstage/tree/master/plugins/scaffolder-backend-module-gitea",children:"Gitea"}),": ",(0,i.jsx)(t.code,{children:"@backstage/plugin-scaffolder-backend-module-gitea"})]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.a,{href:"https://github.com/backstage/backstage/tree/master/plugins/scaffolder-backend-module-github",children:"GitHub"}),": ",(0,i.jsx)(t.code,{children:"@backstage/plugin-scaffolder-backend-module-github"})]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.a,{href:"https://github.com/backstage/backstage/tree/master/plugins/scaffolder-backend-module-gitlab",children:"GitLab"}),": ",(0,i.jsx)(t.code,{children:"@backstage/plugin-scaffolder-backend-module-gitlab"})]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.a,{href:"https://github.com/backstage/backstage/tree/master/plugins/scaffolder-backend-module-rails",children:"Rails"}),": ",(0,i.jsx)(t.code,{children:"@backstage/plugin-scaffolder-backend-module-rails"})]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.a,{href:"https://github.com/backstage/backstage/tree/master/plugins/scaffolder-backend-module-yeoman",children:"Yeoman"}),": ",(0,i.jsx)(t.code,{children:"@backstage/plugin-scaffolder-backend-module-yeoman"})]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.a,{href:"https://github.com/backstage/backstage/tree/master/plugins/scaffolder-backend-module-sentry",children:"Sentry"}),": ",(0,i.jsx)(t.code,{children:"@backstage/plugin-scaffolder-backend-module-sentry"})]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.a,{href:"https://github.com/backstage/backstage/tree/master/plugins/scaffolder-backend-module-cookiecutter",children:"Cookiecutter"}),": ",(0,i.jsx)(t.code,{children:"@backstage/plugin-scaffolder-backend-module-cookiecutter"})]}),"\n"]}),"\n",(0,i.jsx)(t.h2,{id:"installing-action-modules",children:"Installing Action Modules"}),"\n",(0,i.jsx)(t.p,{children:"Here's how to add an action module, first you need to run this command:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-sh",metastring:'title="From your Backstage root directory"',children:"yarn --cwd packages/backend add @backstage/plugin-scaffolder-backend-module-github\n"})}),"\n",(0,i.jsx)(t.p,{children:"Then you need to add it to your backend, this is a simplified new backend system for example purposes:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-ts",metastring:'title="/packages/backend/src/index.ts"',children:"import { createBackend } from '@backstage/backend-defaults';\n\nconst backend = createBackend();\n\nbackend.add(import('@backstage/plugin-app-backend'));\n\nbackend.add(import('@backstage/plugin-catalog-backend'));\nbackend.add(\n  import('@backstage/plugin-catalog-backend-module-scaffolder-entity-model'),\n);\n\n// scaffolder plugin\nbackend.add(import('@backstage/plugin-scaffolder-backend'));\n/* highlight-add-next-line */\nbackend.add(import('@backstage/plugin-scaffolder-backend-module-github'));\n\nbackend.start();\n"})}),"\n",(0,i.jsx)(t.h2,{id:"listing-actions",children:"Listing Actions"}),"\n",(0,i.jsxs)(t.p,{children:["A list of all registered actions can be found under ",(0,i.jsx)(t.code,{children:"/create/actions"}),". For local\ndevelopment you should be able to reach them at\n",(0,i.jsx)(t.code,{children:"http://localhost:3000/create/actions"}),"."]}),"\n",(0,i.jsxs)(t.h2,{id:"migrating-from-fetchcookiecutter-to-fetchtemplate",children:["Migrating from ",(0,i.jsx)(t.code,{children:"fetch:cookiecutter"})," to ",(0,i.jsx)(t.code,{children:"fetch:template"})]}),"\n",(0,i.jsxs)(t.p,{children:["The ",(0,i.jsx)(t.code,{children:"fetch:template"})," action is a new action with a similar API to\n",(0,i.jsx)(t.code,{children:"fetch:cookiecutter"})," but no dependency on ",(0,i.jsx)(t.code,{children:"cookiecutter"}),". There are two options\nfor migrating templates that use ",(0,i.jsx)(t.code,{children:"fetch:cookiecutter"})," to use ",(0,i.jsx)(t.code,{children:"fetch:template"}),":"]}),"\n",(0,i.jsxs)(t.h3,{id:"using-cookiecuttercompat-mode",children:["Using ",(0,i.jsx)(t.code,{children:"cookiecutterCompat"})," mode"]}),"\n",(0,i.jsxs)(t.p,{children:["The new ",(0,i.jsx)(t.code,{children:"fetch:template"})," action has a ",(0,i.jsx)(t.code,{children:"cookiecutterCompat"})," flag which should\nallow most templates built for ",(0,i.jsx)(t.code,{children:"fetch:cookiecutter"})," to work without any changes."]}),"\n",(0,i.jsxs)(t.ol,{children:["\n",(0,i.jsxs)(t.li,{children:["Update action name in ",(0,i.jsx)(t.code,{children:"template.yaml"}),". The name should be changed from\n",(0,i.jsx)(t.code,{children:"fetch:cookiecutter"})," to ",(0,i.jsx)(t.code,{children:"fetch:template"}),"."]}),"\n",(0,i.jsxs)(t.li,{children:["Set ",(0,i.jsx)(t.code,{children:"cookiecutterCompat"})," to ",(0,i.jsx)(t.code,{children:"true"})," in the ",(0,i.jsx)(t.code,{children:"fetch:template"})," step input in\n",(0,i.jsx)(t.code,{children:"template.yaml"}),"."]}),"\n"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-yaml",metastring:'title="template.yaml"',children:"steps:\n   - id: fetchBase\n     name: Fetch Base\n     # highlight-remove-next-line\n     action: fetch:cookiecutter\n     # highlight-add-next-line\n     action: fetch:template\n     input:\n        url: ./skeleton\n        # highlight-add-next-line\n        cookiecutterCompat: true\n        values:\n"})}),"\n",(0,i.jsx)(t.h3,{id:"manual-migration",children:"Manual migration"}),"\n",(0,i.jsx)(t.p,{children:"If you prefer, you can manually migrate your templates to avoid the need for\nenabling cookiecutter compatibility mode, which will result in slightly less\nverbose template variables expressions."}),"\n",(0,i.jsxs)(t.ol,{children:["\n",(0,i.jsxs)(t.li,{children:["Update action name in ",(0,i.jsx)(t.code,{children:"template.yaml"}),". The name should be changed from\n",(0,i.jsx)(t.code,{children:"fetch:cookiecutter"})," to ",(0,i.jsx)(t.code,{children:"fetch:template"}),"."]}),"\n",(0,i.jsxs)(t.li,{children:["Update variable syntax in file names and content. ",(0,i.jsx)(t.code,{children:"fetch:cookiecutter"}),"\nexpects variables to be enclosed in ",(0,i.jsx)(t.code,{children:"{{"})," ",(0,i.jsx)(t.code,{children:"}}"})," and prefixed with\n",(0,i.jsx)(t.code,{children:"cookiecutter."}),", while ",(0,i.jsx)(t.code,{children:"fetch:template"})," expects variables to be enclosed in\n",(0,i.jsx)(t.code,{children:"${{"})," ",(0,i.jsx)(t.code,{children:"}}"})," and prefixed with ",(0,i.jsx)(t.code,{children:"values."}),". For example, a reference to variable\n",(0,i.jsx)(t.code,{children:"myInputVariable"})," would need to be migrated from\n",(0,i.jsx)(t.code,{children:"{{ cookiecutter.myInputVariable }}"})," to ",(0,i.jsx)(t.code,{children:"${{ values.myInputVariable }}"}),"."]}),"\n",(0,i.jsxs)(t.li,{children:["Replace uses of ",(0,i.jsx)(t.code,{children:"jsonify"})," with ",(0,i.jsx)(t.code,{children:"dump"}),". The\n",(0,i.jsxs)(t.a,{href:"https://cookiecutter.readthedocs.io/en/latest/advanced/template_extensions.html#jsonify-extension",children:[(0,i.jsx)(t.code,{children:"jsonify"})," filter"]}),"\nis built in to ",(0,i.jsx)(t.code,{children:"cookiecutter"}),", and is not available by default when using\n",(0,i.jsx)(t.code,{children:"fetch:template"}),". The\n",(0,i.jsxs)(t.a,{href:"https://mozilla.github.io/nunjucks/templating.html#dump",children:[(0,i.jsx)(t.code,{children:"dump"})," filter"]})," is\nthe equivalent filter in nunjucks, so an expression like\n",(0,i.jsx)(t.code,{children:"{{ cookiecutter.myAwesomeList | jsonify }}"})," should be migrated to\n",(0,i.jsx)(t.code,{children:"${{ values.myAwesomeList | dump }}"}),"."]}),"\n"]})]})}function h(e={}){let{wrapper:t}={...(0,a.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(r,{...e})}):r(e)}},28453(e,t,n){n.d(t,{R:()=>s,x:()=>o});var c=n(296540);let i={},a=c.createContext(i);function s(e){let t=c.useContext(a);return c.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:s(e.components),c.createElement(a.Provider,{value:t},e.children)}},330615(e){e.exports=JSON.parse('{"id":"features/software-templates/builtin-actions","title":"Builtin actions","description":"Documentation describing the built-in template actions.","source":"@site/versioned_docs/version-stable/features/software-templates/builtin-actions.md","sourceDirName":"features/software-templates","slug":"/features/software-templates/builtin-actions","permalink":"/docs/features/software-templates/builtin-actions","draft":false,"unlisted":false,"editUrl":"https://github.com/backstage/backstage/edit/master/docs/features/software-templates/builtin-actions.md","tags":[],"version":"stable","frontMatter":{"id":"builtin-actions","title":"Builtin actions","description":"Documentation describing the built-in template actions."},"sidebar":"docs","previous":{"title":"Input Examples","permalink":"/docs/features/software-templates/input-examples"},"next":{"title":"Writing Custom Actions","permalink":"/docs/features/software-templates/writing-custom-actions"}}')}}]);