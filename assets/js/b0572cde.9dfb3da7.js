"use strict";(self.webpackChunkbackstage_microsite=self.webpackChunkbackstage_microsite||[]).push([["46002"],{827731(e,t,n){n.r(t),n.d(t,{assets:()=>r,contentTitle:()=>l,default:()=>u,frontMatter:()=>i,metadata:()=>o,toc:()=>d});var o=n(91398),s=n(474848),a=n(28453);let i={id:"poking-around",sidebar_label:"002 - Poking around",title:"002 - Poking around"},l,r={},d=[{value:"Default plugin functionality",id:"default-plugin-functionality",level:2},{value:"Testing locally",id:"testing-locally",level:2}];function c(e){let t={code:"code",h2:"h2",li:"li",ol:"ol",p:"p",pre:"pre",...(0,a.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.h2,{id:"default-plugin-functionality",children:"Default plugin functionality"}),"\n",(0,s.jsxs)(t.p,{children:["By default, that plugin that you just created hosts a simple todo list application. It exposes an HTTP API at ",(0,s.jsx)(t.code,{children:"http://localhost:7007/api/todo/todos"})," that allows you to create TODOs, list existing TODOs, and get a specific TODO. It stores those TODOs in memory, which means that you would lose all of your TODOs if you restarted your application. It also allows you to tag TODOs with a Software Catalog entity, which will be useful for our frontend integration."]}),"\n",(0,s.jsx)(t.p,{children:"To make this plugin production ready, we'll need to adjust a few things,"}),"\n",(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsx)(t.li,{children:"Write our TODOs to a database so they don't get lost on restart."}),"\n",(0,s.jsx)(t.li,{children:"Write some proper tests to make sure everything works the way we expect."}),"\n",(0,s.jsx)(t.li,{children:"Get user feedback."}),"\n"]}),"\n",(0,s.jsx)(t.h2,{id:"testing-locally",children:"Testing locally"}),"\n",(0,s.jsxs)(t.p,{children:["Before we jump in to making this plugin ready to ship, let's walk through how to run it locally. If you open your backend plugin's manifest (",(0,s.jsx)(t.code,{children:"plugins/todo-backend/package.json"}),"), and look at the ",(0,s.jsx)(t.code,{children:"scripts"})," section, you'll notice a few important commands. The ones relevant to us right now are"]}),"\n",(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"yarn start"})," - Starts a local development server using the content in ",(0,s.jsx)(t.code,{children:"dev/index.ts"})," as the backend."]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"yarn test"})," - Runs all of the tests for your backend plugin."]}),"\n"]}),"\n",(0,s.jsxs)(t.p,{children:["If you run ",(0,s.jsx)(t.code,{children:"yarn start"}),", you should see a custom backend for just your plugin start up. This will simplify plugin development and iteration for you or your team by easily testing out new features in just your plugin - just make sure you add what you need to the global ",(0,s.jsx)(t.code,{children:"packages/backend"}),". The important log for us to look for is"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{children:"2025-06-08T16:14:53.229Z rootHttpRouter info Listening on :7007\n"})}),"\n",(0,s.jsx)(t.p,{children:"This indicates that your HTTP server is up and running and we can start sending test HTTP requests. Grab your favorite HTTP client and let's get testing!"}),"\n",(0,s.jsx)(t.p,{children:"To start, let's make sure we're starting from a clean slate. You can list all existing TODOs by running the command below. You should get back an empty list:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-sh",children:"curl http://localhost:7007/api/todo/todos\n"})}),"\n",(0,s.jsx)(t.p,{children:"To create a new TODO, you can send a POST request to the same endpoint. However, you will get a 401 error right now."}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-sh",children:'curl -X POST http://localhost:7007/api/todo/todos \\\n-H \'Content-Type: application/json; charset=utf-8\' \\\n--data-binary @- << EOF\n{\n    "title": "My Todo"\n}\nEOF\n'})}),"\n",(0,s.jsxs)(t.p,{children:["The 401 error is because we track the ID of the user that created each TODO. If you send a request to create a TODO but don't provide an ",(0,s.jsx)(t.code,{children:"Authorization"})," header, you will see this failure. For plugins that have a frontend as well, this credential management should happen automatically. Let's try this:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-sh",children:'curl -v -X POST http://localhost:7007/api/todo/todos \\\n-H \'Content-Type: application/json; charset=utf-8\' \\\n-H "Authorization: Bearer $(curl -s http://localhost:7007/api/auth/guest/refresh | jq -r \'.backstageIdentity.token\')" \\\n--data-binary @- << EOF\n{\n    "title": "My Todo"\n}\nEOF\n'})}),"\n",(0,s.jsx)(t.p,{children:"We can then list all TODOs to see our new TODO!"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-sh",children:"curl http://localhost:7007/api/todo/todos\n"})}),"\n",(0,s.jsxs)(t.p,{children:["You'll notice that ",(0,s.jsx)(t.code,{children:"createdBy"})," is ",(0,s.jsx)(t.code,{children:"user:development/guest"})," which is the token we used to create the TODO. That's the ",(0,s.jsx)(t.code,{children:"-H \"Authorization: Bearer $(curl -s http://localhost:7007/api/auth/guest/refresh | jq -r '.backstageIdentity.token')\""})," part of the request."]})]})}function u(e={}){let{wrapper:t}={...(0,a.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},28453(e,t,n){n.d(t,{R:()=>i,x:()=>l});var o=n(296540);let s={},a=o.createContext(s);function i(e){let t=o.useContext(a);return o.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function l(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),o.createElement(a.Provider,{value:t},e.children)}},91398(e){e.exports=JSON.parse('{"id":"golden-path/plugins/backend/poking-around","title":"002 - Poking around","description":"Default plugin functionality","source":"@site/versioned_docs/version-stable/golden-path/plugins/backend/002-poking-around.md","sourceDirName":"golden-path/plugins/backend","slug":"/golden-path/plugins/backend/poking-around","permalink":"/docs/golden-path/plugins/backend/poking-around","draft":false,"unlisted":false,"editUrl":"https://github.com/backstage/backstage/edit/master/docs/golden-path/plugins/backend/002-poking-around.md","tags":[],"version":"stable","sidebarPosition":2,"frontMatter":{"id":"poking-around","sidebar_label":"002 - Poking around","title":"002 - Poking around"}}')}}]);