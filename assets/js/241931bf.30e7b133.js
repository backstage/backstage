/*! For license information please see 241931bf.30e7b133.js.LICENSE.txt */
"use strict";(self.webpackChunkbackstage_microsite=self.webpackChunkbackstage_microsite||[]).push([[839511],{851975:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>r,contentTitle:()=>o,default:()=>h,frontMatter:()=>s,metadata:()=>l,toc:()=>c});var a=n(474848),i=n(28453);const s={id:"catalog-customization",title:"Catalog Customization",description:"How to add custom filters or interface elements to the Backstage software catalog"},o=void 0,l={id:"features/software-catalog/catalog-customization",title:"Catalog Customization",description:"How to add custom filters or interface elements to the Backstage software catalog",source:"@site/versioned_docs/version-stable/features/software-catalog/catalog-customization.md",sourceDirName:"features/software-catalog",slug:"/features/software-catalog/catalog-customization",permalink:"/docs/features/software-catalog/catalog-customization",draft:!1,unlisted:!1,editUrl:"https://github.com/backstage/backstage/edit/master/docs/features/software-catalog/catalog-customization.md",tags:[],version:"stable",frontMatter:{id:"catalog-customization",title:"Catalog Customization",description:"How to add custom filters or interface elements to the Backstage software catalog"},sidebar:"docs",previous:{title:"External integrations",permalink:"/docs/features/software-catalog/external-integrations"},next:{title:"API",permalink:"/docs/category/catalog-api"}},r={},c=[{value:"Pagination",id:"pagination",level:2},{value:"Initially Selected Filter",id:"initially-selected-filter",level:2},{value:"Initially Selected Kind",id:"initially-selected-kind",level:2},{value:"Owner Picker Mode",id:"owner-picker-mode",level:2},{value:"Table Options",id:"table-options",level:2},{value:"Customize Columns",id:"customize-columns",level:2},{value:"Adding a column to an existing Kind",id:"adding-a-column-to-an-existing-kind",level:3},{value:"Adding columns to a custom or specific Kind",id:"adding-columns-to-a-custom-or-specific-kind",level:3},{value:"Customize Actions",id:"customize-actions",level:2},{value:"Customize Filters",id:"customize-filters",level:2},{value:"Default Filter Props",id:"default-filter-props",level:3},{value:"Removing Default Filters",id:"removing-default-filters",level:3},{value:"Custom Filters",id:"custom-filters",level:3},{value:"Advanced Customization",id:"advanced-customization",level:2},{value:"New Frontend System",id:"new-frontend-system",level:2},{value:"Entity filters",id:"entity-filters",level:3},{value:"Entity predicate queries",id:"entity-predicate-queries",level:3},{value:"Entity predicate logical operators",id:"entity-predicate-logical-operators",level:3},{value:"<code>$all</code>",id:"all",level:4},{value:"<code>$any</code>",id:"any",level:4},{value:"<code>$not</code>",id:"not",level:4},{value:"Entity predicate value operators",id:"entity-predicate-value-operators",level:3},{value:"<code>$exists</code>",id:"exists",level:4},{value:"<code>$in</code>",id:"in",level:4},{value:"<code>$contains</code>",id:"contains",level:4}];function d(e){const t={a:"a",admonition:"admonition",code:"code",em:"em",h2:"h2",h3:"h3",h4:"h4",p:"p",pre:"pre",...(0,i.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(t.p,{children:["The Backstage software catalog comes with a default ",(0,a.jsx)(t.code,{children:"CatalogIndexPage"})," to filter and find catalog entities. This is already set up by default by ",(0,a.jsx)(t.code,{children:"@backstage/create-app"}),". If you want to change the default index page - to set the initially selected filter, adjust columns, add actions, or to add a custom filter to the catalog - the following sections will show you how."]}),"\n",(0,a.jsx)(t.h2,{id:"pagination",children:"Pagination"}),"\n",(0,a.jsxs)(t.p,{children:["Initial support for pagination of the ",(0,a.jsx)(t.code,{children:"CatalogIndexPage"})," was added in v1.21.0 of Backstage, so make sure you are on that version or newer to use this feature. To enable pagination you simply need to pass in the ",(0,a.jsx)(t.code,{children:"pagination"})," prop like this:"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-tsx",metastring:'title="packages/app/src/App.tsx"',children:'<Route path="/catalog" element={<CatalogIndexPage pagination />} />\n'})}),"\n",(0,a.jsx)(t.h2,{id:"initially-selected-filter",children:"Initially Selected Filter"}),"\n",(0,a.jsx)(t.p,{children:"By default, the initially selected filter defaults to Owned. If you are still building up your catalog this may show an empty list to start. If you would prefer this to show All as the default, here's how you can make that change:"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-tsx",metastring:'title="packages/app/src/App.tsx"',children:'<Route\n  path="/catalog"\n  element={<CatalogIndexPage initiallySelectedFilter="all" />}\n/>\n'})}),"\n",(0,a.jsx)(t.p,{children:"Possible options are: owned, starred, or all"}),"\n",(0,a.jsx)(t.h2,{id:"initially-selected-kind",children:"Initially Selected Kind"}),"\n",(0,a.jsx)(t.p,{children:"By default, the initially selected Kind when viewing the Catalog is Component, but you may have reasons that you want this to be different. Let's say at your Organization they would like it to always default to Domain, here's how you would do that:"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-tsx",metastring:'title="packages/app/src/App.tsx"',children:'<Route path="/catalog" element={<CatalogIndexPage initialKind="domain" />} />\n'})}),"\n",(0,a.jsxs)(t.p,{children:["Possible options are all the ",(0,a.jsx)(t.a,{href:"/docs/features/software-catalog/system-model",children:"default Kinds"})," as well as any custom Kinds that you have added."]}),"\n",(0,a.jsx)(t.h2,{id:"owner-picker-mode",children:"Owner Picker Mode"}),"\n",(0,a.jsx)(t.p,{children:"The Owner filter by default will only contain a list of Users and/or Groups that actually own an entity in the Catalog, now you may have reason to change this. Here's how:"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-tsx",metastring:'title="packages/app/src/App.tsx"',children:'<Route path="/catalog" element={<CatalogIndexPage ownerPickerMode="all" />} />\n'})}),"\n",(0,a.jsx)(t.p,{children:"Possible options are: owners-only or all"}),"\n",(0,a.jsx)(t.h2,{id:"table-options",children:"Table Options"}),"\n",(0,a.jsxs)(t.p,{children:["The tables used within Backstage are built on top of ",(0,a.jsx)(t.a,{href:"https://material-table-core.github.io/",children:(0,a.jsx)(t.code,{children:"@material-table/core"})})," and the ",(0,a.jsx)(t.code,{children:"CatalogIndexPage"})," has a ",(0,a.jsx)(t.code,{children:"tableOptions"})," prop that allows you to customize the underlying table to a certain extent, but there are some hard coded Backstage settings that can't be changed. Here's an example of how to use this prop to disable the search filter field in the table's header:"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-tsx",metastring:'title="packages/app/src/App.tsx"',children:'<Route\n  path="/catalog"\n  element={<CatalogIndexPage tableOptions={{ search: false }} />}\n/>\n'})}),"\n",(0,a.jsxs)(t.p,{children:["There are many options that can be set using ",(0,a.jsx)(t.code,{children:"tableOptions"}),", the full list of settings can be found in the ",(0,a.jsxs)(t.a,{href:"https://github.com/material-table-core/core/blob/v3.1.0/types/index.d.ts#L323",children:[(0,a.jsx)(t.code,{children:"@material-table/core"})," ",(0,a.jsx)(t.code,{children:"Options"})," interface"]})," (this link goes to ",(0,a.jsx)(t.code,{children:"v3.1.0"})," of ",(0,a.jsx)(t.code,{children:"@material-table/core"})," as that is the version currently used by Backstage)."]}),"\n",(0,a.jsx)(t.h2,{id:"customize-columns",children:"Customize Columns"}),"\n",(0,a.jsxs)(t.p,{children:["The columns you see in the ",(0,a.jsx)(t.code,{children:"CatalogIndexPage"})," were selected to be a good starting point for most, but there may be cases where you would like to add or remove columns from existing or custom Kinds."]}),"\n",(0,a.jsx)(t.h3,{id:"adding-a-column-to-an-existing-kind",children:"Adding a column to an existing Kind"}),"\n",(0,a.jsxs)(t.p,{children:["Suppose we want to add a new User Email column to the ",(0,a.jsx)(t.code,{children:"User"})," kind in the Catalog. We can do this by overriding the ",(0,a.jsx)(t.code,{children:"columns"})," that we pass into the ",(0,a.jsx)(t.code,{children:"CatalogIndexPage"})," component in our ",(0,a.jsx)(t.code,{children:"App.tsx"}),". First, we need to match the entity kind that we want to override, and then define the columns to show:"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-tsx",metastring:'title="packages/app/src/App.tsx"',children:"{/* prettier-ignore */ /* highlight-add-start */}\nconst myColumnsFunc: CatalogTableColumnsFunc = entityListContext => {\n  if (entityListContext.filters.kind?.value === 'user') {\n    return [\n      // Render existing columns\n      ...CatalogTable.defaultColumnsFunc(entityListContext),\n      // Add new columns here\n    ];\n  }\n\n  return CatalogTable.defaultColumnsFunc(entityListContext);\n};\n{/* prettier-ignore */ /* highlight-add-end */}\n"})}),"\n",(0,a.jsxs)(t.p,{children:["Then, we can implement the ",(0,a.jsx)(t.code,{children:"createUserEmailColumn"})," function and add it to the list of columns. ",(0,a.jsx)(t.code,{children:"field"})," is used to access the data from the entity, while ",(0,a.jsx)(t.code,{children:"render"})," lets us customize how we display the data:"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-tsx",metastring:'title="packages/app/src/App.tsx"',children:"{/* highlight-add-start */}\nconst createUserEmailColumn = (): TableColumn<CatalogTableRow> => ({\n  title: 'User Email',\n  field: 'entity.spec.profile.email',\n  render: ({ entity }) => (\n    <OverflowTooltip\n      text={entity.spec?.profile?.['email'] || 'N/A'}\n      placement=\"bottom-start\"\n    />\n  ),\n});\n{/* highlight-add-end */}\n\nconst myColumnsFunc: CatalogTableColumnsFunc = entityListContext => {\n  if (entityListContext.filters.kind?.value === 'user') {\n    return [\n      // Render existing columns\n      ...CatalogTable.defaultColumnsFunc(entityListContext),\n      // Add new columns here\n      {/* highlight-add-next-line */}\n      createUserEmailColumn(),\n    ];\n  }\n\n  return CatalogTable.defaultColumnsFunc(entityListContext);\n};\n"})}),"\n",(0,a.jsxs)(t.p,{children:["Finally, we can pass the ",(0,a.jsx)(t.code,{children:"myColumnsFunc"})," to the ",(0,a.jsx)(t.code,{children:"CatalogIndexPage"})," component:"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-tsx",metastring:'title="packages/app/src/App.tsx"',children:"const routes = (\n  <FlatRoutes>\n    <Route\n      path=\"/catalog\"\n      element={\n        <CatalogIndexPage\n          pagination={{ mode: 'offset', limit: 20 }}\n          {/* highlight-add-next-line */}\n          columns={myColumnsFunc}\n        />\n      }\n    />\n    {/* Other routes */}\n  </FlatRoutes>\n)\n"})}),"\n",(0,a.jsx)(t.h3,{id:"adding-columns-to-a-custom-or-specific-kind",children:"Adding columns to a custom or specific Kind"}),"\n",(0,a.jsxs)(t.p,{children:["Another use case for customization is when adding a custom ",(0,a.jsx)(t.code,{children:"Kind"}),". This feature is available in Backstage >= ",(0,a.jsx)(t.code,{children:"v1.23.0"}),". For example:"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-tsx",metastring:'title="packages/app/src/App.tsx"',children:"import {\n  CatalogEntityPage,\n  CatalogIndexPage,\n  catalogPlugin,\n  {/* highlight-add-start */}\n  CatalogTable,\n  CatalogTableColumnsFunc,\n  {/* highlight-add-end */}\n} from '@backstage/plugin-catalog';\n\n{/* highlight-add-start */}\nconst myColumnsFunc: CatalogTableColumnsFunc = entityListContext => {\n  if (entityListContext.filters.kind?.value === 'MyKind') {\n    return [\n      CatalogTable.columns.createNameColumn(),\n      CatalogTable.columns.createOwnerColumn(),\n    ];\n  }\n\n  return CatalogTable.defaultColumnsFunc(entityListContext);\n};\n{/* highlight-add-end */}\n\n{/* highlight-remove-next-line */}\n<Route path=\"/catalog\" element={<CatalogIndexPage />} />\n{/* highlight-add-next-line */}\n<Route path=\"/catalog\" element={<CatalogIndexPage columns={myColumnsFunc} />} />\n"})}),"\n",(0,a.jsx)(t.admonition,{title:"Note",type:"note",children:(0,a.jsx)(t.p,{children:"In the examples above, the contents of the files have been shortened for simplicity."})}),"\n",(0,a.jsx)(t.h2,{id:"customize-actions",children:"Customize Actions"}),"\n",(0,a.jsxs)(t.p,{children:["The ",(0,a.jsx)(t.code,{children:"CatalogIndexPage"})," comes with three default actions - view, edit, and star. You might want to add more."]}),"\n",(0,a.jsxs)(t.p,{children:["To do this, first you'll need to add ",(0,a.jsx)(t.code,{children:"@mui/utils"})," to your ",(0,a.jsx)(t.code,{children:"packages/app/package.json"}),":"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-sh",children:"yarn --cwd packages/app add @mui/utils\n"})}),"\n",(0,a.jsx)(t.p,{children:"Then you'll do the following:"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-tsx",metastring:'title="packages/app/src/App.tsx"',children:"import {\n  AlertDisplay,\n  OAuthRequestDialog,\n  SignInPage,\n  {/* highlight-add-next-line */}\n  TableProps,\n} from '@backstage/core-components';\n\nimport {\n  CatalogEntityPage,\n  CatalogIndexPage,\n  {/* highlight-add-next-line */}\n  CatalogTableRow,\n  catalogPlugin,\n} from '@backstage/plugin-catalog';\n\n{/* highlight-add-start */}\nimport { Typography } from '@material-ui/core';\nimport OpenInNew from '@material-ui/icons/OpenInNew';\nimport { visuallyHidden } from '@mui/utils';\n{/* highlight-add-end */}\n\n{/* highlight-add-start */}\nconst customActions: TableProps<CatalogTableRow>['actions'] = [\n  ({ entity }) => {\n    const url = 'https://backstage.io/';\n    const title = `View - ${entity.metadata.name}`;\n\n    return {\n      icon: () => (\n        <>\n          <Typography style={visuallyHidden}>{title}</Typography>\n          <OpenInNew fontSize=\"small\" />\n        </>\n      ),\n      tooltip: title,\n      disabled: !url,\n      onClick: () => {\n        if (!url) return;\n        window.open(url, '_blank');\n      },\n    };\n  },\n];\n{/* highlight-add-end */}\n\n{/* highlight-remove-next-line */}\n<Route path=\"/catalog\" element={<CatalogIndexPage />} />\n{/* highlight-add-next-line */}\n<Route path=\"/catalog\" element={<CatalogIndexPage actions={customActions} />} />\n"})}),"\n",(0,a.jsx)(t.admonition,{title:"Note",type:"note",children:(0,a.jsxs)(t.p,{children:["In the example above, the contents of ",(0,a.jsx)(t.code,{children:"App.tsx"})," has been shortened for simplicity."]})}),"\n",(0,a.jsxs)(t.p,{children:["The above customization will override the existing actions. Currently, the only way to keep them and add your own is to also include the existing actions in your array by copying them from the ",(0,a.jsx)(t.a,{href:"https://github.com/backstage/backstage/blob/57397e7d6d2d725712c439f4ab93f2ac6aa27bf8/plugins/catalog/src/components/CatalogTable/CatalogTable.tsx#L113-L168",children:(0,a.jsx)(t.code,{children:"defaultActions"})}),"."]}),"\n",(0,a.jsx)(t.h2,{id:"customize-filters",children:"Customize Filters"}),"\n",(0,a.jsx)(t.p,{children:"There are various ways to customize filters: adjusting the existing filters with props, adding or removing default filters, creating brand-new custom filters, etc. The following sections cover these cases:"}),"\n",(0,a.jsx)(t.h3,{id:"default-filter-props",children:"Default Filter Props"}),"\n",(0,a.jsx)(t.p,{children:"There are a set of default filters that you can use, which surface all the props mentioned earlier in this document. Here's how they can be used:"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-tsx",metastring:'title="packages/app/src/App.tsx"',children:'import { DefaultFilters } from \'@backstage/plugin-catalog-react\';\n\n<Route\n  path="/catalog"\n  element={\n    <CatalogIndexPage\n      filters={\n        <>\n          <DefaultFilters\n            initialKind="Domain"\n            initiallySelectedFilter="all"\n            ownerPickerMode="all"\n          />\n        </>\n      }\n    />\n  }\n/>;\n'})}),"\n",(0,a.jsx)(t.h3,{id:"removing-default-filters",children:"Removing Default Filters"}),"\n",(0,a.jsx)(t.p,{children:"If you have reasons not to use the Lifecycle, Tag, and Processing Status filters, here's an example of how to remove them:"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-tsx",metastring:'title="packages/app/src/App.tsx"',children:"import {\n  EntityKindPicker,\n  EntityTypePicker,\n  UserListPicker,\n  EntityOwnerPicker,\n  EntityNamespacePicker,\n} from '@backstage/plugin-catalog-react';\n\n<Route\n  path=\"/catalog\"\n  element={\n    <CatalogIndexPage\n      filters={\n        <>\n          <EntityKindPicker />\n          <EntityTypePicker />\n          <UserListPicker />\n          <EntityOwnerPicker />\n          <EntityNamespacePicker />\n        </>\n      }\n    />\n  }\n/>;\n"})}),"\n",(0,a.jsx)(t.h3,{id:"custom-filters",children:"Custom Filters"}),"\n",(0,a.jsxs)(t.p,{children:["You can add custom filters. For example, suppose that we want to allow filtering by a custom annotation added to entities, ",(0,a.jsx)(t.code,{children:"company.com/security-tier"}),". Here is how we can build a filter to support that need."]}),"\n",(0,a.jsxs)(t.p,{children:["First we need to create a new filter that implements the ",(0,a.jsx)(t.code,{children:"EntityFilter"})," interface:"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-ts",children:"import { EntityFilter } from '@backstage/plugin-catalog-react';\nimport { Entity } from '@backstage/catalog-model';\n\nclass EntitySecurityTierFilter implements EntityFilter {\n  constructor(readonly values: string[]) {}\n  filterEntity(entity: Entity): boolean {\n    const tier = entity.metadata.annotations?.['company.com/security-tier'];\n    return tier !== undefined && this.values.includes(tier);\n  }\n}\n"})}),"\n",(0,a.jsxs)(t.p,{children:["The ",(0,a.jsx)(t.code,{children:"EntityFilter"})," interface permits backend filters, which are passed along to the ",(0,a.jsx)(t.code,{children:"catalog-backend"})," - or frontend filters, which are applied after entities are loaded from the backend."]}),"\n",(0,a.jsx)(t.p,{children:"We'll use this filter to extend the default filters in a type-safe way. Let's create the custom filter shape extending the default somewhere alongside this filter:"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-ts",children:"export type CustomFilters = DefaultEntityFilters & {\n  securityTiers?: EntitySecurityTierFilter;\n};\n"})}),"\n",(0,a.jsxs)(t.p,{children:["To control this filter, we can create a React component that shows checkboxes for the security tiers. This component will make use of the ",(0,a.jsx)(t.code,{children:"useEntityList"})," hook, which accepts this extended filter type as a ",(0,a.jsx)(t.a,{href:"https://www.typescriptlang.org/docs/handbook/2/generics.html",children:"generic"})," parameter:"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-tsx",children:"export const EntitySecurityTierPicker = () => {\n  // The securityTiers key is recognized due to the CustomFilter generic\n  const {\n    filters: { securityTiers },\n    updateFilters,\n  } = useEntityList<CustomFilters>();\n\n  // Toggles the value, depending on whether it's already selected\n  function onChange(value: string) {\n    const newTiers = securityTiers?.values.includes(value)\n      ? securityTiers.values.filter(tier => tier !== value)\n      : [...(securityTiers?.values ?? []), value];\n    updateFilters({\n      securityTiers: newTiers.length\n        ? new EntitySecurityTierFilter(newTiers)\n        : undefined,\n    });\n  }\n\n  const tierOptions = ['1', '2', '3'];\n  return (\n    <FormControl component=\"fieldset\">\n      <Typography variant=\"button\">Security Tier</Typography>\n      <FormGroup>\n        {tierOptions.map(tier => (\n          <FormControlLabel\n            key={tier}\n            control={\n              <Checkbox\n                checked={securityTiers?.values.includes(tier)}\n                onChange={() => onChange(tier)}\n              />\n            }\n            label={`Tier ${tier}`}\n          />\n        ))}\n      </FormGroup>\n    </FormControl>\n  );\n};\n"})}),"\n",(0,a.jsxs)(t.p,{children:["Now we can add the component to ",(0,a.jsx)(t.code,{children:"CatalogIndexPage"}),":"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-tsx",metastring:'title="packages/app/src/App.tsx"',children:'{/* prettier-ignore */ /* highlight-add-start */}\nimport { DefaultFilters } from \'@backstage/plugin-catalog-react\';\n{/* prettier-ignore */ /* highlight-add-end */}\n\nconst routes = (\n  <FlatRoutes>\n    <Navigate key="/" to="catalog" />\n    {/* highlight-remove-next-line */}\n    <Route path="/catalog" element={<CatalogIndexPage />} />\n    {/* highlight-add-start */}\n    <Route\n      path="/catalog"\n      element={\n        <CatalogIndexPage\n          filters={\n            <>\n              <DefaultFilters />\n              <EntitySecurityTierPicker />\n            </>\n          }\n        />\n      }\n    />\n    {/* highlight-add-end */}\n    {/* ... */}\n  </FlatRoutes>\n);\n'})}),"\n",(0,a.jsxs)(t.p,{children:["The same method can be used to customize the ",(0,a.jsx)(t.em,{children:"default"})," filters with a different interface - for such usage, the generic argument isn't needed since the filter shape remains the same as the default."]}),"\n",(0,a.jsx)(t.h2,{id:"advanced-customization",children:"Advanced Customization"}),"\n",(0,a.jsxs)(t.p,{children:["For those where none of the above fits their needs you can take the option of creating a fully custom ",(0,a.jsx)(t.code,{children:"CatalogIndexPage"}),"."]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-tsx",metastring:'title="packages/app/src/components/catalog/CustomCatalogIndex.tsx"',children:"import {\n  PageWithHeader,\n  Content,\n  ContentHeader,\n  SupportButton,\n} from '@backstage/core-components';\nimport { useApi, configApiRef } from '@backstage/core-plugin-api';\nimport { CatalogTable } from '@backstage/plugin-catalog';\nimport {\n  EntityListProvider,\n  CatalogFilterLayout,\n  EntityKindPicker,\n  EntityLifecyclePicker,\n  EntityNamespacePicker,\n  EntityOwnerPicker,\n  EntityProcessingStatusPicker,\n  EntityTagPicker,\n  EntityTypePicker,\n  UserListPicker,\n} from '@backstage/plugin-catalog-react';\n\nexport const CustomCatalogPage = () => {\n  const orgName =\n    useApi(configApiRef).getOptionalString('organization.name') ?? 'Backstage';\n\n  return (\n    <PageWithHeader title={orgName} themeId=\"home\">\n      <Content>\n        <ContentHeader title=\"\">\n          <SupportButton>All your software catalog entities</SupportButton>\n        </ContentHeader>\n        <EntityListProvider pagination>\n          <CatalogFilterLayout>\n            <CatalogFilterLayout.Filters>\n              <EntityKindPicker />\n              <EntityTypePicker />\n              <UserListPicker />\n              <EntityOwnerPicker />\n              <EntityLifecyclePicker />\n              <EntityTagPicker />\n              <EntityProcessingStatusPicker />\n              <EntityNamespacePicker />\n            </CatalogFilterLayout.Filters>\n            <CatalogFilterLayout.Content>\n              <CatalogTable />\n            </CatalogFilterLayout.Content>\n          </CatalogFilterLayout>\n        </EntityListProvider>\n      </Content>\n    </PageWithHeader>\n  );\n};\n"})}),"\n",(0,a.jsxs)(t.p,{children:["The above is a very basic version of a fully custom ",(0,a.jsx)(t.code,{children:"CatalogIndexPage"}),", you'll want to explore the various props to see what you can all do with them. This was built off the building blocks seen in the ",(0,a.jsx)(t.a,{href:"https://github.com/backstage/backstage/blob/master/plugins/catalog/src/components/CatalogPage/DefaultCatalogPage.tsx",children:(0,a.jsx)(t.code,{children:"DefaultCatalogPage"})})]}),"\n",(0,a.jsx)(t.admonition,{title:"Note",type:"note",children:(0,a.jsxs)(t.p,{children:["The catalog index page is designed to have a minimal code footprint to support easy customization, but creating a replica does introduce a possibility of drifting out of date over time. Be sure to check the catalog ",(0,a.jsx)(t.a,{href:"https://github.com/backstage/backstage/blob/master/plugins/catalog/CHANGELOG.md",children:"CHANGELOG"})," periodically."]})}),"\n",(0,a.jsxs)(t.p,{children:["To use this custom ",(0,a.jsx)(t.code,{children:"CatalogIndexPage"})," which we called ",(0,a.jsx)(t.code,{children:"CustomCatalogPage"}),", you'll need to make the following change:"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-tsx",metastring:'title="packages/app/src/App.tsx"',children:'const routes = (\n  <FlatRoutes>\n    <Navigate key="/" to="catalog" />\n    {/* highlight-remove-next-line */}\n    <Route path="/catalog" element={<CatalogIndexPage />} />\n    {/* highlight-add-start */}\n    <Route path="/catalog" element={<CatalogIndexPage />}>\n      <CustomCatalogPage />\n    </Route>\n    {/* highlight-add-end */}\n    {/* ... */}\n  </FlatRoutes>\n);\n'})}),"\n",(0,a.jsx)(t.h2,{id:"new-frontend-system",children:"New Frontend System"}),"\n",(0,a.jsxs)(t.p,{children:["This section of the documentation explains how to create and configure catalog extensions in the ",(0,a.jsx)(t.a,{href:"/docs/frontend-system/",children:"new frontend system"}),"."]}),"\n",(0,a.jsx)(t.admonition,{title:"Warning",type:"warning",children:(0,a.jsx)(t.p,{children:"This section is a work in progress."})}),"\n",(0,a.jsx)(t.h3,{id:"entity-filters",children:"Entity filters"}),"\n",(0,a.jsxs)(t.p,{children:["Many extensions that attach within the catalog entity pages accept a ",(0,a.jsx)(t.code,{children:"filter"})," configuration. The purpose of the ",(0,a.jsx)(t.code,{children:"filter"})," configuration is to select what entities the extension should be applied to or be present on. Many of these extension will have a default filter defined, but you can override it by providing your own. When defining filters in code you can use either a predicate function or a entity predicate query, while in configuration you can only use an entity predicate query."]}),"\n",(0,a.jsx)(t.h3,{id:"entity-predicate-queries",children:"Entity predicate queries"}),"\n",(0,a.jsxs)(t.p,{children:["The entity predicate syntax is a minimal JSON-based query language for filtering catalog entities. It is loosely inspired by the ",(0,a.jsx)(t.a,{href:"https://www.mongodb.com/docs/manual/tutorial/query-documents/",children:"MongoDB query syntax"}),", behaving roughly the same way but with a different set of operators."]}),"\n",(0,a.jsxs)(t.p,{children:["The most simple entity predicate is an object expression with key-value mappings where the key is the full dot-separated path to the value in the entity, and the value is the value to do a case insensitive match against. Each entry in this object is evaluated separately, but all of them must match for the overall predicate to result in a match. For example, the following will match any component entities of the type ",(0,a.jsx)(t.code,{children:"service"}),":"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-json",children:'{\n  "filter": {\n    "kind": "component",\n    "spec.type": "service"\n  }\n}\n'})}),"\n",(0,a.jsx)(t.p,{children:"Or when utilizing YAML syntax:"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-yaml",children:"filter:\n  kind: component\n  spec.type: service\n"})}),"\n",(0,a.jsxs)(t.p,{children:["In addition to this basic syntax, entity predicates support logical operators that can be nested and applied around these object expressions. For example, the following will match all components entities that are of type ",(0,a.jsx)(t.code,{children:"service"})," or ",(0,a.jsx)(t.code,{children:"website"}),":"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-json",children:'{\n  "filter": {\n    "$all": [\n      {\n        "kind": "component"\n      },\n      {\n        "$any": [{ "spec.type": "service" }, { "spec.type": "website" }]\n      }\n    ]\n  }\n}\n'})}),"\n",(0,a.jsx)(t.p,{children:"Or when utilizing YAML syntax:"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-yaml",children:"filter:\n  $all:\n    - kind: component\n    - $any:\n        - spec.type: service\n        - spec.type: website\n"})}),"\n",(0,a.jsx)(t.p,{children:"Finally, entity predicates also support value operators that can be used in place of the values in the object expression. For example, the following is a simpler way to express the previous example:"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-json",children:'{\n  "filter": {\n    "kind": "component",\n    "spec.type": { "$in": ["service", "website"] }\n  }\n}\n'})}),"\n",(0,a.jsx)(t.p,{children:"Or when utilizing YAML syntax:"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-yaml",children:"filter:\n  kind: component\n  spec.type:\n    $in: [service, website]\n"})}),"\n",(0,a.jsx)(t.h3,{id:"entity-predicate-logical-operators",children:"Entity predicate logical operators"}),"\n",(0,a.jsx)(t.p,{children:"The following section lists all logical operators for entity predicates."}),"\n",(0,a.jsx)(t.h4,{id:"all",children:(0,a.jsx)(t.code,{children:"$all"})}),"\n",(0,a.jsxs)(t.p,{children:["The ",(0,a.jsx)(t.code,{children:"$all"})," operator has the following syntax:"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-json",children:"{ $all: [ { <expression1> }, { <expression2> }, ...] }\n"})}),"\n",(0,a.jsxs)(t.p,{children:["The ",(0,a.jsx)(t.code,{children:"$all"})," operator evaluates to ",(0,a.jsx)(t.code,{children:"true"})," if all expressions within the provided array evaluate to ",(0,a.jsx)(t.code,{children:"true"}),". This includes an empty array, which means that ",(0,a.jsx)(t.code,{children:'{ "$all": [] }'})," always evaluates to ",(0,a.jsx)(t.code,{children:"true"}),"."]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-yaml",metastring:'title="Example usage of $all"',children:"filter:\n  $all:\n    - kind: component\n    - $not:\n        spec.type: service\n"})}),"\n",(0,a.jsx)(t.h4,{id:"any",children:(0,a.jsx)(t.code,{children:"$any"})}),"\n",(0,a.jsxs)(t.p,{children:["The ",(0,a.jsx)(t.code,{children:"$any"})," operator has the following syntax:"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-json",children:"{ $any: [ { <expression1> }, { <expression2> }, ...] }\n"})}),"\n",(0,a.jsxs)(t.p,{children:["The ",(0,a.jsx)(t.code,{children:"$any"})," operator evaluates to ",(0,a.jsx)(t.code,{children:"true"})," if at least one of the expressions within the provided array evaluate to ",(0,a.jsx)(t.code,{children:"true"}),". This includes an empty array, which means that ",(0,a.jsx)(t.code,{children:'{ "$any": [] }'})," always evaluates to ",(0,a.jsx)(t.code,{children:"false"}),"."]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-yaml",metastring:'title="Example usage of $any"',children:"filter:\n  $any:\n    - kind: component\n    - metadata.annotations.github.com/project-slug: { $exists: true }\n"})}),"\n",(0,a.jsx)(t.h4,{id:"not",children:(0,a.jsx)(t.code,{children:"$not"})}),"\n",(0,a.jsxs)(t.p,{children:["The ",(0,a.jsx)(t.code,{children:"$not"})," operator has the following syntax:"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-json",children:"{ $not: { <expression> } }\n"})}),"\n",(0,a.jsxs)(t.p,{children:["The ",(0,a.jsx)(t.code,{children:"$not"})," operator inverts the result of the provided express. If the expression evaluates to ",(0,a.jsx)(t.code,{children:"true"})," then ",(0,a.jsx)(t.code,{children:"$not"})," will evaluate to false, and the other way around."]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-yaml",metastring:'title="Example usage of $not"',children:"filter:\n  $not:\n    kind: template\n"})}),"\n",(0,a.jsx)(t.h3,{id:"entity-predicate-value-operators",children:"Entity predicate value operators"}),"\n",(0,a.jsx)(t.p,{children:"The following section lists all value operators for entity predicates."}),"\n",(0,a.jsx)(t.h4,{id:"exists",children:(0,a.jsx)(t.code,{children:"$exists"})}),"\n",(0,a.jsxs)(t.p,{children:["The ",(0,a.jsx)(t.code,{children:"$exists"})," operator has the following syntax:"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-json",children:"{ field: { $exists: <boolean> } }\n"})}),"\n",(0,a.jsxs)(t.p,{children:["The ",(0,a.jsx)(t.code,{children:"$exists"})," operator will evaluate to ",(0,a.jsx)(t.code,{children:"true"})," if the existence of the value it matches against matches the provided boolean. That is ",(0,a.jsx)(t.code,{children:"{ $exists: true }"})," will evaluate to ",(0,a.jsx)(t.code,{children:"true"})," if and only if the value is defined, and ",(0,a.jsx)(t.code,{children:"{ $exists: false }"})," will evaluate to ",(0,a.jsx)(t.code,{children:"true"})," if and only if the value is not defined."]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-yaml",metastring:'title="Example usage of $exists"',children:"filter:\n  metadata.annotations.github.com/project-slug: { $exists: true }\n"})}),"\n",(0,a.jsx)(t.h4,{id:"in",children:(0,a.jsx)(t.code,{children:"$in"})}),"\n",(0,a.jsxs)(t.p,{children:["The ",(0,a.jsx)(t.code,{children:"$in"})," operator has the following syntax:"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-json",children:"{ field: { $in: [ <primitive1>, <primitive2>, ... ] } }\n"})}),"\n",(0,a.jsxs)(t.p,{children:["The ",(0,a.jsx)(t.code,{children:"$in"})," operator will evaluate to ",(0,a.jsx)(t.code,{children:"true"})," if the value it is matched against is exists within the array of primitives. The comparison is case insensitive and can only be done across primitive values. If the value matched against is an object or array, the operator will always evaluate to ",(0,a.jsx)(t.code,{children:"false"}),"."]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-yaml",metastring:'title="Example usage of $in"',children:"filter:\n  kind:\n    $in: [component, api]\n"})}),"\n",(0,a.jsx)(t.h4,{id:"contains",children:(0,a.jsx)(t.code,{children:"$contains"})}),"\n",(0,a.jsxs)(t.p,{children:["The ",(0,a.jsx)(t.code,{children:"$contains"})," operator has the following syntax:"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-json",children:"{ field: { $contains: { <expression> } } }\n"})}),"\n",(0,a.jsxs)(t.p,{children:["The ",(0,a.jsx)(t.code,{children:"$contains"})," operator will evaluate to ",(0,a.jsx)(t.code,{children:"true"})," if the value it is matched against is an array, and at least one of the elements in the array fully matches the provided expression. If the value matched against is not an array, or if the array is empty, the operator will always evaluate to ",(0,a.jsx)(t.code,{children:"false"}),"."]}),"\n",(0,a.jsx)(t.p,{children:"The expression used to match against the array can be any valid entity predicate expression, including logical operators and value operators."}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-yaml",metastring:'title="Example usage of $contains"',children:"filter:\n  relations:\n    $contains:\n      type: ownedBy\n      targetRef:\n        $in: [group:default/admins, group:default/viewers]\n"})})]})}function h(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,a.jsx)(t,{...e,children:(0,a.jsx)(d,{...e})}):d(e)}},221020:(e,t,n)=>{var a=n(296540),i=Symbol.for("react.element"),s=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,l=a.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,r={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var a,s={},c=null,d=null;for(a in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(d=t.ref),t)o.call(t,a)&&!r.hasOwnProperty(a)&&(s[a]=t[a]);if(e&&e.defaultProps)for(a in t=e.defaultProps)void 0===s[a]&&(s[a]=t[a]);return{$$typeof:i,type:e,key:c,ref:d,props:s,_owner:l.current}}t.Fragment=s,t.jsx=c,t.jsxs=c},474848:(e,t,n)=>{e.exports=n(221020)},28453:(e,t,n)=>{n.d(t,{R:()=>o,x:()=>l});var a=n(296540);const i={},s=a.createContext(i);function o(e){const t=a.useContext(s);return a.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function l(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),a.createElement(s.Provider,{value:t},e.children)}}}]);