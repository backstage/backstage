"use strict";(self.webpackChunkbackstage_microsite=self.webpackChunkbackstage_microsite||[]).push([["83461"],{497350(e,n,t){t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>i,metadata:()=>o,toc:()=>r});var o=t(513874),s=t(474848),d=t(28453);let i={id:"addons",title:"TechDocs Addons",description:"How to find, use, or create TechDocs Addons."},a,c={},r=[{value:"Concepts",id:"concepts",level:2},{value:"Addons",id:"addons",level:3},{value:"Locations",id:"locations",level:3},{value:"Addon Registry",id:"addon-registry",level:3},{value:"Installing and using Addons",id:"installing-and-using-addons",level:2},{value:"Available Addons",id:"available-addons",level:2},{value:"Creating an Addon",id:"creating-an-addon",level:2},{value:"Addons in the Content location",id:"addons-in-the-content-location",level:3},{value:"Testing Addons",id:"testing-addons",level:3}];function l(e){let n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,d.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.admonition,{type:"info",children:(0,s.jsxs)(n.p,{children:["This documentation is written for ",(0,s.jsx)(n.a,{href:"/docs/next/features/techdocs/getting-started#adding-techdocs-frontend-plugin",children:"the old frontend system"}),". If you are on the ",(0,s.jsx)(n.a,{href:"/docs/next/frontend-system/",children:"new frontend system"})," you may want to read ",(0,s.jsx)(n.a,{href:"/docs/next/features/techdocs/addons--new",children:"its own article"})," instead."]})}),"\n",(0,s.jsx)(n.h2,{id:"concepts",children:"Concepts"}),"\n",(0,s.jsx)(n.p,{children:"TechDocs is a centralized platform for publishing, viewing, and discovering\ntechnical documentation across an entire organization. It's a solid foundation!\nBut it doesn't solve higher-order documentation needs on its own: how do you\ncreate and reinforce a culture of documentation? How do you build trust in the\nquality of technical documentation?"}),"\n",(0,s.jsx)(n.p,{children:"TechDocs Addons are a mechanism by which you can customize the TechDocs\nexperience in order to try and address some of these higher-order needs."}),"\n",(0,s.jsx)(n.h3,{id:"addons",children:"Addons"}),"\n",(0,s.jsx)(n.p,{children:"An Addon is just a react component. Like any react component, it can retrieve\nand render data using normal Backstage or native hooks, APIs, and components.\nProps can be used to configure its behavior, where appropriate."}),"\n",(0,s.jsx)(n.h3,{id:"locations",children:"Locations"}),"\n",(0,s.jsxs)(n.p,{children:["Addons declare a ",(0,s.jsx)(n.code,{children:"location"})," where they will be rendered. Most locations are\nrepresentative of physical spaces in the TechDocs UI:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"Header"}),": For Addons which fill up the header from the right, on the same\nline as the title."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"Subheader"}),": For Addons that sit below the header but above all content.\nThis is a great location for tooling/configuration of TechDocs display."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"Settings"}),": These addons are items added to the settings menu list and are designed to make\nthe reader experience customizable, for example accessibility options."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"PrimarySidebar"}),": Left of the content, above of the navigation."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"SecondarySidebar"}),": Right of the content, above the table of contents."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"Content"}),": A special location intended for Addons which augment the\nstatically generated content of the documentation itself."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"Component"}),": A ",(0,s.jsx)(n.a,{href:"https://github.com/backstage/backstage/issues/11109",children:"proposed-but-not-yet-implemented"}),"\nvirtual location, aimed at simplifying a common type of Addon."]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"TechDocs Addon Location Guide",src:t(961439).A+"",width:"3582",height:"1968"})}),"\n",(0,s.jsx)(n.h3,{id:"addon-registry",children:"Addon Registry"}),"\n",(0,s.jsxs)(n.p,{children:["The installation and configuration of Addons happens within a Backstage app's\nfrontend. Addons are imported from plugins and added underneath a registry\ncomponent called ",(0,s.jsx)(n.code,{children:"<TechDocsAddons>"}),". This registry can be configured for both\nthe TechDocs Reader page as well as the Entity docs page."]}),"\n",(0,s.jsx)(n.p,{children:"Addons are rendered in the order in which they are registered."}),"\n",(0,s.jsx)(n.h2,{id:"installing-and-using-addons",children:"Installing and using Addons"}),"\n",(0,s.jsxs)(n.p,{children:["To start using Addons you need to add the ",(0,s.jsx)(n.code,{children:"@backstage/plugin-techdocs-module-addons-contrib"})," package to your app. You can do that by running this command from the root of your project: ",(0,s.jsx)(n.code,{children:"yarn --cwd packages/app add @backstage/plugin-techdocs-module-addons-contrib"})]}),"\n",(0,s.jsxs)(n.p,{children:["Addons can be installed and configured in much the same way as extensions for\nother Backstage plugins: by adding them underneath an extension registry\ncomponent (",(0,s.jsx)(n.code,{children:"<TechDocsAddons>"}),") under the route representing the TechDocs Reader\npage in your ",(0,s.jsx)(n.code,{children:"App.tsx"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:"// packages/app/src/App.tsx\n\nimport { TechDocsReaderPage } from '@backstage/plugin-techdocs';\nimport { TechDocsAddons } from '@backstage/plugin-techdocs-react';\nimport { ReportIssue } from '@backstage/plugin-techdocs-module-addons-contrib';\n\n// ...\n\n<Route path=\"/docs/:namespace/:kind/:name/*\" element={<TechDocsReaderPage />}>\n  <TechDocsAddons>\n    <ReportIssue />\n    {/* Other addons can be added here. */}\n  </TechDocsAddons>\n</Route>;\n"})}),"\n",(0,s.jsxs)(n.p,{children:["If you are using a custom ",(0,s.jsx)(n.a,{href:"/docs/next/features/techdocs/how-to-guides#how-to-customize-the-techdocs-reader-page",children:"TechDocs reader page"})," your setup will be very similar, here's an example:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:'<Route path="/docs/:namespace/:kind/:name/*" element={<TechDocsReaderPage />}>\n  <TechDocsAddons>\n    <ReportIssue />\n    {/* Other addons can be added here. */}\n  </TechDocsAddons>\n  {techDocsPage} // This is your custom TechDocs reader page\n</Route>\n'})}),"\n",(0,s.jsxs)(n.p,{children:["The process for configuring Addons on the documentation tab on the entity page\nis very similar; instead of adding the ",(0,s.jsx)(n.code,{children:"<TechDocsAddons>"})," registry under a\n",(0,s.jsx)(n.code,{children:"<Route>"}),", you'd add it as a child of ",(0,s.jsx)(n.code,{children:"<EntityTechdocsContent />"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:"// packages/app/src/components/catalog/EntityPage.tsx\n\nimport { EntityLayout } from '@backstage/plugin-catalog';\nimport { EntityTechdocsContent } from '@backstage/plugin-techdocs';\nimport { TechDocsAddons } from '@backstage/plugin-techdocs-react';\nimport { ReportIssue } from '@backstage/plugin-techdocs-module-addons-contrib';\n\n// ...\n\n<EntityLayout.Route path=\"/docs\" title=\"Docs\">\n  <EntityTechdocsContent>\n    <TechDocsAddons>\n      <ReportIssue />\n      {/* Other addons can be added here. */}\n    </TechDocsAddons>\n  </EntityTechdocsContent>\n</EntityLayout.Route>;\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Note that on the entity page, because the Catalog plugin is responsible for the\npage header, TechDocs Addons whose location is ",(0,s.jsx)(n.code,{children:"Header"})," will not be rendered."]}),"\n",(0,s.jsx)(n.h2,{id:"available-addons",children:"Available Addons"}),"\n",(0,s.jsx)(n.p,{children:"Addons can, in principle, be provided by any plugin! To make it easier to\ndiscover available Addons, we've compiled a list of them here:"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Addon"}),(0,s.jsx)(n.th,{children:"Package/Plugin"}),(0,s.jsx)(n.th,{children:"Description"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.a,{href:"https://backstage.io/api/stable/variables/_backstage_plugin-techdocs-module-addons-contrib.index.ExpandableNavigation.html",children:(0,s.jsx)(n.code,{children:"<ExpandableNavigation />"})})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"@backstage/plugin-techdocs-module-addons-contrib"})}),(0,s.jsx)(n.td,{children:"Allows TechDocs users to expand or collapse the entire TechDocs main navigation, and keeps the user's preferred state between documentation sites."})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.a,{href:"https://backstage.io/api/stable/variables/_backstage_plugin-techdocs-module-addons-contrib.index.ReportIssue.html",children:(0,s.jsx)(n.code,{children:"<ReportIssue />"})})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"@backstage/plugin-techdocs-module-addons-contrib"})}),(0,s.jsx)(n.td,{children:"Allows TechDocs users to select a portion of text on a TechDocs page and open an issue against the repository that contains the documentation, populating the issue description with the selected text according to a configurable template."})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.a,{href:"https://backstage.io/api/stable/variables/_backstage_plugin-techdocs-module-addons-contrib.index.TextSize.html",children:(0,s.jsx)(n.code,{children:"<TextSize />"})})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"@backstage/plugin-techdocs-module-addons-contrib"})}),(0,s.jsx)(n.td,{children:"This TechDocs addon allows users to customize text size on documentation pages, they can select how much they want to increase or decrease the font size via slider or buttons. The default value for font size is 100% and this setting is kept in the browser's local storage whenever it is changed."})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.a,{href:"https://backstage.io/api/stable/variables/_backstage_plugin-techdocs-module-addons-contrib.index.LightBox.html",children:(0,s.jsx)(n.code,{children:"<LightBox />"})})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"@backstage/plugin-techdocs-module-addons-contrib"})}),(0,s.jsxs)(n.td,{children:["This TechDocs addon allows users to open images in a light-box on documentation pages, they can navigate between images if there are several on one page. The image size of the light-box image is the same as the image size on the document page. When clicking on the zoom icon it zooms the image to fit in the screen (similar to ",(0,s.jsx)(n.code,{children:"background-size: contain"}),")."]})]})]})]}),"\n",(0,s.jsx)(n.p,{children:"Got an Addon to contribute? Feel free to add a row above!"}),"\n",(0,s.jsx)(n.h2,{id:"creating-an-addon",children:"Creating an Addon"}),"\n",(0,s.jsx)(n.p,{children:"The simplest Addons are plain old react components that get rendered in\nspecific locations within a TechDocs site. To package such a react component as\nan Addon, follow these steps:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"Write the component in your plugin like any other component"}),"\n",(0,s.jsx)(n.li,{children:"Create, provide, and export the component from your plugin"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// plugins/your-plugin/src/plugin.ts\n\nimport {\n  createTechDocsAddonExtension,\n  TechDocsAddonLocations,\n} from '@backstage/plugin-techdocs-react';\nimport { CatGifComponent, CatGifComponentProps } from './addons';\n\n// ...\n\n// You must \"provide\" your Addon, just like any extension, via your plugin.\nexport const CatGif = yourPlugin.provide(\n  // This function \"creates\" the Addon given a component and location. If your\n  // component can be configured via props, pass the prop type here too.\n  createTechDocsAddonExtension<CatGifComponentProps>({\n    name: 'CatGif',\n    location: TechDocsAddonLocations.Header,\n    component: CatGifComponent,\n  }),\n);\n"})}),"\n",(0,s.jsx)(n.h3,{id:"addons-in-the-content-location",children:"Addons in the Content location"}),"\n",(0,s.jsx)(n.p,{children:"Beyond the \"render a component in a region\" use-case, it's also possible for\nAddons to access and manipulate a TechDocs site's DOM; this could be used to,\nfor example, load and instantiate client-side diagramming libraries, replace\nelements with dynamically loaded content, etc."}),"\n",(0,s.jsxs)(n.p,{children:["This type of Addon is still expressed as a react component, but instead of\nreturning a react element to be rendered, it updates the DOM via side-effects\n(e.g. with ",(0,s.jsx)(n.code,{children:"useEffect"}),"). Access to the DOM is made available via utility hooks\nprovided by the Addon framework."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:"// plugins/your-plugin/src/addons/MakeAllImagesCatGifs.tsx\nimport { useEffect } from 'react';\nimport { useShadowRootElements } from '@backstage/plugin-techdocs-react';\n\n// This is a normal react component; in order to make it an Addon, you would\n// still create and provide it via your plugin as described above. The only\n// difference is that you'd set `location` to `TechDocsAddonLocations.Content`.\nexport const MakeAllImagesCatGifsAddon = () => {\n  // This hook can be used to get references to specific elements. If you need\n  // access to the whole shadow DOM, use the underlying useShadowRoot()\n  // hook instead.\n  const images = useShadowRootElements<HTMLImageElement>(['img']);\n\n  useEffect(() => {\n    images.forEach(img => {\n      if (img.src !== 'https://example.com/cat.gif') {\n        img.src = 'https://example.com/cat.gif';\n      }\n    });\n  }, [images]);\n\n  // Nothing to render directly, so we can just return null.\n  return null;\n};\n"})}),"\n",(0,s.jsx)(n.h3,{id:"testing-addons",children:"Testing Addons"}),"\n",(0,s.jsxs)(n.p,{children:["Install ",(0,s.jsx)(n.code,{children:"@backstage/plugin-techdocs-addons-test-utils"})," as a ",(0,s.jsx)(n.code,{children:"devDependency"})," in\nyour plugin for access to utilities that make testing such Addons easier."]}),"\n",(0,s.jsx)(n.p,{children:"A test for the above Addon might look something like this:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:"// plugins/your-plugin/src/addons/MakeAllImagesCatGifs.test.tsx\nimport { TechDocsAddonTester } from '@backstage/plugin-techdocs-addons-test-utils';\n\n// Note: import your actual addon (the one provided by your plugin).\nimport { MakeAllImagesCatGifs } from '../plugin.ts';\n\ndescribe('MakeAllImagesCatGifs', () => {\n  it('replaces img srcs with cat gif', async () => {\n    const { getByTestId } = await TechDocsAddonTester.buildAddonsInTechDocs([\n      <MakeAllImagesCatGifs />,\n    ])\n      .withDom(<img data-testid=\"fixture\" src=\"http://example.com/dog.jpg\" />)\n      .renderWithEffects();\n\n    expect(getByTestId('fixture')).toHaveAttribute(\n      'src',\n      'https://example.com/cat.gif',\n    );\n  });\n});\n"})})]})}function h(e={}){let{wrapper:n}={...(0,d.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}},961439(e,n,t){t.d(n,{A:()=>o});let o=t.p+"assets/images/addon-locations-684d47051de7f2b16c25d8354d4f1f2f.png"},28453(e,n,t){t.d(n,{R:()=>i,x:()=>a});var o=t(296540);let s={},d=o.createContext(s);function i(e){let n=o.useContext(d);return o.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),o.createElement(d.Provider,{value:n},e.children)}},513874(e){e.exports=JSON.parse('{"id":"features/techdocs/addons","title":"TechDocs Addons","description":"How to find, use, or create TechDocs Addons.","source":"@site/../docs/features/techdocs/addons.md","sourceDirName":"features/techdocs","slug":"/features/techdocs/addons","permalink":"/docs/next/features/techdocs/addons","draft":false,"unlisted":false,"editUrl":"https://github.com/backstage/backstage/edit/master/docs/features/techdocs/addons.md","tags":[],"version":"current","frontMatter":{"id":"addons","title":"TechDocs Addons","description":"How to find, use, or create TechDocs Addons."},"sidebar":"docs","previous":{"title":"Concepts","permalink":"/docs/next/features/techdocs/concepts"},"next":{"title":"TechDocs Architecture","permalink":"/docs/next/features/techdocs/architecture"}}')}}]);