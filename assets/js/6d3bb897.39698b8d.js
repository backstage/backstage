"use strict";(self.webpackChunkbackstage_microsite=self.webpackChunkbackstage_microsite||[]).push([["15213"],{536802(e,t,n){n.r(t),n.d(t,{assets:()=>r,contentTitle:()=>l,default:()=>p,frontMatter:()=>a,metadata:()=>s,toc:()=>d});var s=n(178541),i=n(474848),o=n(28453);let a={id:"01-setup",title:"1. Tutorial setup",description:"How to get started with the permission framework as a plugin author"},l,r={},d=[{value:"Setup for the Tutorial",id:"setup-for-the-tutorial",level:2},{value:"Integrate the new plugin",id:"integrate-the-new-plugin",level:2}];function c(e){let t={a:"a",admonition:"admonition",code:"code",h2:"h2",hr:"hr",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.admonition,{type:"info",children:(0,i.jsxs)(t.p,{children:["This documentation is written for ",(0,i.jsx)(t.a,{href:"/docs/next/backend-system/",children:"the new backend system"})," which is the default since Backstage ",(0,i.jsx)(t.a,{href:"/docs/next/releases/v1.24.0",children:"version 1.24"}),". If you are still on the old backend system, you may want to read ",(0,i.jsx)(t.a,{href:"https://github.com/backstage/backstage/blob/v1.37.0/docs/permissions/plugin-authors/01-setup--old.md",children:"its own article"})," instead, and ",(0,i.jsx)(t.a,{href:"/docs/next/backend-system/building-backends/migrating",children:"consider migrating"}),"!"]})}),"\n",(0,i.jsxs)(t.p,{children:["The following tutorial is designed to help plugin authors add support for permissions to their plugins. We'll add support for permissions to example ",(0,i.jsx)(t.code,{children:"todo-list"})," and ",(0,i.jsx)(t.code,{children:"todo-list-backend"})," plugins, but the process should be similar for other plugins!"]}),"\n",(0,i.jsxs)(t.p,{children:["The rest of this page is focused on adding the ",(0,i.jsx)(t.code,{children:"todo-list"})," and ",(0,i.jsx)(t.code,{children:"todo-list-backend"})," plugins to your Backstage instance. If you want to add support for permissions to your own plugin instead, feel free to skip to the ",(0,i.jsx)(t.a,{href:"/docs/next/permissions/plugin-authors/02-adding-a-basic-permission-check",children:"next section"}),"."]}),"\n",(0,i.jsx)(t.h2,{id:"setup-for-the-tutorial",children:"Setup for the Tutorial"}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"Note"}),": We will be updating files created as part of the ",(0,i.jsx)(t.a,{href:"/docs/next/permissions/getting-started",children:"Getting Started"})," documentation, this tutorial assumes you have already viewed and gone through those steps!"]}),"\n",(0,i.jsxs)(t.p,{children:['We are going to make a "Todo list" feature, composed of the ',(0,i.jsx)(t.code,{children:"todo-list"})," and ",(0,i.jsx)(t.code,{children:"todo-list-backend"})," plugins, as well as their dependency, ",(0,i.jsx)(t.code,{children:"todo-list-common"}),"."]}),"\n",(0,i.jsx)(t.p,{children:"The source code is available here:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.a,{href:"https://github.com/backstage/backstage/blob/master/plugins/example-todo-list",children:"todo-list"})}),"\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.a,{href:"https://github.com/backstage/backstage/blob/master/plugins/example-todo-list-backend",children:"todo-list-backend"})}),"\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.a,{href:"https://github.com/backstage/backstage/blob/master/plugins/example-todo-list-common",children:"todo-list-common"})}),"\n"]}),"\n",(0,i.jsxs)(t.ol,{children:["\n",(0,i.jsxs)(t.li,{children:["\n",(0,i.jsxs)(t.p,{children:["Copy-paste the three folders into the plugins folder of your backstage application repository (removing the ",(0,i.jsx)(t.code,{children:"example-"})," prefix from each folder) or run the following script from the root of your backstage application:"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-bash",children:"$ cd $(mktemp -d)\n  git clone --depth 1 --quiet --no-checkout --filter=blob:none https://github.com/backstage/backstage.git .\n  git checkout master -- plugins/example-todo-list/\n  git checkout master -- plugins/example-todo-list-backend/\n  git checkout master -- plugins/example-todo-list-common/\n  sed -i '' 's/workspace:\\^/\\*/g' plugins/example-todo-list/package.json\n  sed -i '' 's/workspace:\\^/\\*/g' plugins/example-todo-list-backend/package.json\n  sed -i '' 's/workspace:\\^/\\*/g' plugins/example-todo-list-common/package.json\n  for file in plugins/*; do mv \"$file\" \"$OLDPWD/${file/example-todo/todo}\"; done\n  cd -\n"})}),"\n",(0,i.jsxs)(t.p,{children:["The ",(0,i.jsx)(t.code,{children:"plugins"})," directory of your project should now include ",(0,i.jsx)(t.code,{children:"todo-list"}),", ",(0,i.jsx)(t.code,{children:"todo-list-backend"}),", and ",(0,i.jsx)(t.code,{children:"todo-list-common"}),"."]}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"Important"}),": if you are on ",(0,i.jsx)(t.strong,{children:"Windows"}),", make sure you have WSL and git installed on your machine before executing the script above."]}),"\n"]}),"\n",(0,i.jsxs)(t.li,{children:["\n",(0,i.jsx)(t.p,{children:"Add these packages as dependencies for your Backstage app:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-sh",metastring:'title="From your Backstage root directory"',children:"yarn --cwd packages/backend add @backstage/plugin-permission-backend @backstage/plugin-permission-backend-module-allow-all-policy @internal/plugin-todo-list-backend @internal/plugin-todo-list-common\nyarn --cwd packages/app add @internal/plugin-todo-list\n"})}),"\n"]}),"\n",(0,i.jsxs)(t.li,{children:["\n",(0,i.jsx)(t.p,{children:"Include the backend and frontend plugin in your application:"}),"\n",(0,i.jsxs)(t.p,{children:["Apply the following changes to ",(0,i.jsx)(t.code,{children:"packages/backend/src/index.ts"}),":"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-ts",metastring:'title="packages/backend/src/index.ts"',children:"import { createBackend } from '@backstage/backend-defaults';\n//...\nconst backend = createBackend();\n//...\n/* highlight-add-start */\n// Installing the permission plugin\nbackend.add(import('@backstage/plugin-permission-backend'));\n// Installing the allow all permission policy module\nbackend.add(\n  import('@backstage/plugin-permission-backend-module-allow-all-policy'),\n);\n// Installing the todolist plugin\nbackend.add(import('@internal/plugin-todo-list-backend'));\n/* highlight-add-end */\n//...\nbackend.start();\n"})}),"\n",(0,i.jsxs)(t.p,{children:["Apply the following changes to ",(0,i.jsx)(t.code,{children:"packages/app/src/App.tsx"}),":"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-tsx",metastring:'title="packages/app/src/App.tsx"',children:"/* highlight-add-next-line */\nimport { TodoListPage } from '@internal/plugin-todo-list';\n//...\n\nconst routes = (\n  <FlatRoutes>\n    {/* ... */}\n    {/* highlight-add-next-line */}\n    <Route path=\"/todo-list\" element={<TodoListPage />} />\n    {/* ... */}\n  </FlatRoutes>\n);\n"})}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(t.p,{children:["Now if you start your application you should be able to reach the ",(0,i.jsx)(t.code,{children:"/todo-list"})," page:"]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"Todo List plugin page",src:n(83836).A+"",width:"1323",height:"611"})}),"\n",(0,i.jsx)(t.hr,{}),"\n",(0,i.jsx)(t.h2,{id:"integrate-the-new-plugin",children:"Integrate the new plugin"}),"\n",(0,i.jsx)(t.p,{children:"If you play with the UI, you will notice that it is possible to perform a few actions:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:["create a new todo item (",(0,i.jsx)(t.code,{children:"POST /todos"}),")"]}),"\n",(0,i.jsxs)(t.li,{children:["view todo items (",(0,i.jsx)(t.code,{children:"GET /todos"}),")"]}),"\n",(0,i.jsxs)(t.li,{children:["edit an existing todo item (",(0,i.jsx)(t.code,{children:"PUT /todos"}),")"]}),"\n"]}),"\n",(0,i.jsx)(t.p,{children:"Let's try to bring authorization on top of each one of them."})]})}function p(e={}){let{wrapper:t}={...(0,o.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},83836(e,t,n){n.d(t,{A:()=>s});let s=n.p+"assets/images/permission-todo-list-page-6cbdeae87098cd84d982e8ece2442ce9.png"},28453(e,t,n){n.d(t,{R:()=>a,x:()=>l});var s=n(296540);let i={},o=s.createContext(i);function a(e){let t=s.useContext(o);return s.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function l(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),s.createElement(o.Provider,{value:t},e.children)}},178541(e){e.exports=JSON.parse('{"id":"permissions/plugin-authors/01-setup","title":"1. Tutorial setup","description":"How to get started with the permission framework as a plugin author","source":"@site/../docs/permissions/plugin-authors/01-setup.md","sourceDirName":"permissions/plugin-authors","slug":"/permissions/plugin-authors/01-setup","permalink":"/docs/next/permissions/plugin-authors/01-setup","draft":false,"unlisted":false,"editUrl":"https://github.com/backstage/backstage/edit/master/docs/permissions/plugin-authors/01-setup.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"id":"01-setup","title":"1. Tutorial setup","description":"How to get started with the permission framework as a plugin author"},"sidebar":"docs","previous":{"title":"Tutorial: using Permissions in your plugin","permalink":"/docs/next/tutorial--using-permissions-in-your-plugin/generated-index"},"next":{"title":"2. Adding a basic permission check","permalink":"/docs/next/permissions/plugin-authors/02-adding-a-basic-permission-check"}}')}}]);