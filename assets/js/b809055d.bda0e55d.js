/*! For license information please see b809055d.bda0e55d.js.LICENSE.txt */
"use strict";(self.webpackChunkbackstage_microsite=self.webpackChunkbackstage_microsite||[]).push([[779390],{13895:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>l,contentTitle:()=>a,default:()=>p,frontMatter:()=>i,metadata:()=>r,toc:()=>d});var n=s(474848),o=s(28453);const i={id:"01-setup",title:"1. Tutorial setup",description:"How to get started with the permission framework as a plugin author"},a=void 0,r={id:"permissions/plugin-authors/01-setup",title:"1. Tutorial setup",description:"How to get started with the permission framework as a plugin author",source:"@site/versioned_docs/version-stable/permissions/plugin-authors/01-setup.md",sourceDirName:"permissions/plugin-authors",slug:"/permissions/plugin-authors/01-setup",permalink:"/docs/permissions/plugin-authors/01-setup",draft:!1,unlisted:!1,editUrl:"https://github.com/backstage/backstage/edit/master/docs/permissions/plugin-authors/01-setup.md",tags:[],version:"stable",sidebarPosition:1,frontMatter:{id:"01-setup",title:"1. Tutorial setup",description:"How to get started with the permission framework as a plugin author"},sidebar:"docs",previous:{title:"Defining custom permission rules",permalink:"/docs/permissions/custom-rules"},next:{title:"2. Adding a basic permission check",permalink:"/docs/permissions/plugin-authors/02-adding-a-basic-permission-check"}},l={},d=[{value:"Setup for the Tutorial",id:"setup-for-the-tutorial",level:2},{value:"Integrate the new plugin",id:"integrate-the-new-plugin",level:2}];function c(e){const t={a:"a",admonition:"admonition",code:"code",h2:"h2",hr:"hr",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.admonition,{type:"info",children:(0,n.jsxs)(t.p,{children:["This documentation is written for ",(0,n.jsx)(t.a,{href:"/docs/backend-system/",children:"the new backend system"})," which is the default since Backstage ",(0,n.jsx)(t.a,{href:"/docs/releases/v1.24.0",children:"version 1.24"}),". If you are still on the old backend system, you may want to read ",(0,n.jsx)(t.a,{href:"https://github.com/backstage/backstage/blob/v1.37.0/docs/permissions/plugin-authors/01-setup--old.md",children:"its own article"})," instead, and ",(0,n.jsx)(t.a,{href:"/docs/backend-system/building-backends/migrating",children:"consider migrating"}),"!"]})}),"\n",(0,n.jsxs)(t.p,{children:["The following tutorial is designed to help plugin authors add support for permissions to their plugins. We'll add support for permissions to example ",(0,n.jsx)(t.code,{children:"todo-list"})," and ",(0,n.jsx)(t.code,{children:"todo-list-backend"})," plugins, but the process should be similar for other plugins!"]}),"\n",(0,n.jsxs)(t.p,{children:["The rest of this page is focused on adding the ",(0,n.jsx)(t.code,{children:"todo-list"})," and ",(0,n.jsx)(t.code,{children:"todo-list-backend"})," plugins to your Backstage instance. If you want to add support for permissions to your own plugin instead, feel free to skip to the ",(0,n.jsx)(t.a,{href:"/docs/permissions/plugin-authors/02-adding-a-basic-permission-check",children:"next section"}),"."]}),"\n",(0,n.jsx)(t.h2,{id:"setup-for-the-tutorial",children:"Setup for the Tutorial"}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Note"}),": We will be updating files created as part of the ",(0,n.jsx)(t.a,{href:"/docs/permissions/getting-started",children:"Getting Started"})," documentation, this tutorial assumes you have already viewed and gone through those steps!"]}),"\n",(0,n.jsxs)(t.p,{children:['We are going to make a "Todo list" feature, composed of the ',(0,n.jsx)(t.code,{children:"todo-list"})," and ",(0,n.jsx)(t.code,{children:"todo-list-backend"})," plugins, as well as their dependency, ",(0,n.jsx)(t.code,{children:"todo-list-common"}),"."]}),"\n",(0,n.jsx)(t.p,{children:"The source code is available here:"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:(0,n.jsx)(t.a,{href:"https://github.com/backstage/backstage/blob/master/plugins/example-todo-list",children:"todo-list"})}),"\n",(0,n.jsx)(t.li,{children:(0,n.jsx)(t.a,{href:"https://github.com/backstage/backstage/blob/master/plugins/example-todo-list-backend",children:"todo-list-backend"})}),"\n",(0,n.jsx)(t.li,{children:(0,n.jsx)(t.a,{href:"https://github.com/backstage/backstage/blob/master/plugins/example-todo-list-common",children:"todo-list-common"})}),"\n"]}),"\n",(0,n.jsxs)(t.ol,{children:["\n",(0,n.jsxs)(t.li,{children:["\n",(0,n.jsxs)(t.p,{children:["Copy-paste the three folders into the plugins folder of your backstage application repository (removing the ",(0,n.jsx)(t.code,{children:"example-"})," prefix from each folder) or run the following script from the root of your backstage application:"]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-bash",children:"$ cd $(mktemp -d)\n  git clone --depth 1 --quiet --no-checkout --filter=blob:none https://github.com/backstage/backstage.git .\n  git checkout master -- plugins/example-todo-list/\n  git checkout master -- plugins/example-todo-list-backend/\n  git checkout master -- plugins/example-todo-list-common/\n  sed -i '' 's/workspace:\\^/\\*/g' plugins/example-todo-list/package.json\n  sed -i '' 's/workspace:\\^/\\*/g' plugins/example-todo-list-backend/package.json\n  sed -i '' 's/workspace:\\^/\\*/g' plugins/example-todo-list-common/package.json\n  for file in plugins/*; do mv \"$file\" \"$OLDPWD/${file/example-todo/todo}\"; done\n  cd -\n"})}),"\n",(0,n.jsxs)(t.p,{children:["The ",(0,n.jsx)(t.code,{children:"plugins"})," directory of your project should now include ",(0,n.jsx)(t.code,{children:"todo-list"}),", ",(0,n.jsx)(t.code,{children:"todo-list-backend"}),", and ",(0,n.jsx)(t.code,{children:"todo-list-common"}),"."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Important"}),": if you are on ",(0,n.jsx)(t.strong,{children:"Windows"}),", make sure you have WSL and git installed on your machine before executing the script above."]}),"\n"]}),"\n",(0,n.jsxs)(t.li,{children:["\n",(0,n.jsx)(t.p,{children:"Add these packages as dependencies for your Backstage app:"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-sh",metastring:'title="From your Backstage root directory"',children:"yarn --cwd packages/backend add @backstage/plugin-permission-backend @backstage/plugin-permission-backend-module-allow-all-policy @internal/plugin-todo-list-backend @internal/plugin-todo-list-common\nyarn --cwd packages/app add @internal/plugin-todo-list\n"})}),"\n"]}),"\n",(0,n.jsxs)(t.li,{children:["\n",(0,n.jsx)(t.p,{children:"Include the backend and frontend plugin in your application:"}),"\n",(0,n.jsxs)(t.p,{children:["Apply the following changes to ",(0,n.jsx)(t.code,{children:"packages/backend/src/index.ts"}),":"]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-ts",metastring:'title="packages/backend/src/index.ts"',children:"import { createBackend } from '@backstage/backend-defaults';\n//...\nconst backend = createBackend();\n//...\n/* highlight-add-start */\n// Installing the permission plugin\nbackend.add(import('@backstage/plugin-permission-backend'));\n// Installing the allow all permission policy module\nbackend.add(\n  import('@backstage/plugin-permission-backend-module-allow-all-policy'),\n);\n// Installing the todolist plugin\nbackend.add(import('@internal/plugin-todo-list-backend'));\n/* highlight-add-end */\n//...\nbackend.start();\n"})}),"\n",(0,n.jsxs)(t.p,{children:["Apply the following changes to ",(0,n.jsx)(t.code,{children:"packages/app/src/App.tsx"}),":"]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-tsx",metastring:'title="packages/app/src/App.tsx"',children:"/* highlight-add-next-line */\nimport { TodoListPage } from '@internal/plugin-todo-list';\n//...\n\nconst routes = (\n  <FlatRoutes>\n    {/* ... */}\n    {/* highlight-add-next-line */}\n    <Route path=\"/todo-list\" element={<TodoListPage />} />\n    {/* ... */}\n  </FlatRoutes>\n);\n"})}),"\n"]}),"\n"]}),"\n",(0,n.jsxs)(t.p,{children:["Now if you start your application you should be able to reach the ",(0,n.jsx)(t.code,{children:"/todo-list"})," page:"]}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"Todo List plugin page",src:s(902537).A+"",width:"1323",height:"611"})}),"\n",(0,n.jsx)(t.hr,{}),"\n",(0,n.jsx)(t.h2,{id:"integrate-the-new-plugin",children:"Integrate the new plugin"}),"\n",(0,n.jsx)(t.p,{children:"If you play with the UI, you will notice that it is possible to perform a few actions:"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:["create a new todo item (",(0,n.jsx)(t.code,{children:"POST /todos"}),")"]}),"\n",(0,n.jsxs)(t.li,{children:["view todo items (",(0,n.jsx)(t.code,{children:"GET /todos"}),")"]}),"\n",(0,n.jsxs)(t.li,{children:["edit an existing todo item (",(0,n.jsx)(t.code,{children:"PUT /todos"}),")"]}),"\n"]}),"\n",(0,n.jsx)(t.p,{children:"Let's try to bring authorization on top of each one of them."})]})}function p(e={}){const{wrapper:t}={...(0,o.R)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(c,{...e})}):c(e)}},221020:(e,t,s)=>{var n=s(296540),o=Symbol.for("react.element"),i=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,r=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function d(e,t,s){var n,i={},d=null,c=null;for(n in void 0!==s&&(d=""+s),void 0!==t.key&&(d=""+t.key),void 0!==t.ref&&(c=t.ref),t)a.call(t,n)&&!l.hasOwnProperty(n)&&(i[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps)void 0===i[n]&&(i[n]=t[n]);return{$$typeof:o,type:e,key:d,ref:c,props:i,_owner:r.current}}t.Fragment=i,t.jsx=d,t.jsxs=d},474848:(e,t,s)=>{e.exports=s(221020)},902537:(e,t,s)=>{s.d(t,{A:()=>n});const n=s.p+"assets/images/permission-todo-list-page-6cbdeae87098cd84d982e8ece2442ce9.png"},28453:(e,t,s)=>{s.d(t,{R:()=>a,x:()=>r});var n=s(296540);const o={},i=n.createContext(o);function a(e){const t=n.useContext(i);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function r(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:a(e.components),n.createElement(i.Provider,{value:t},e.children)}}}]);