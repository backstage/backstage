/*! For license information please see b8e8d5ae.56670ed5.js.LICENSE.txt */
"use strict";(self.webpackChunkbackstage_microsite=self.webpackChunkbackstage_microsite||[]).push([[977993],{292194:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>o,contentTitle:()=>c,default:()=>u,frontMatter:()=>r,metadata:()=>i,toc:()=>d});var a=t(474848),s=t(28453);const r={id:"backends",title:"Backend Instances",sidebar_label:"Backend",description:"Backend instances"},c=void 0,i={id:"backend-system/architecture/backends",title:"Backend Instances",description:"Backend instances",source:"@site/../docs/backend-system/architecture/02-backends.md",sourceDirName:"backend-system/architecture",slug:"/backend-system/architecture/backends",permalink:"/docs/next/backend-system/architecture/backends",draft:!1,unlisted:!1,editUrl:"https://github.com/backstage/backstage/edit/master/docs/backend-system/architecture/02-backends.md",tags:[],version:"current",sidebarPosition:2,frontMatter:{id:"backends",title:"Backend Instances",sidebar_label:"Backend",description:"Backend instances"}},o={},d=[{value:"The Backend Instance",id:"the-backend-instance",level:2},{value:"Backend Startup Result",id:"backend-startup-result",level:3}];function l(e){const n={a:"a",code:"code",h2:"h2",h3:"h3",p:"p",pre:"pre",...(0,s.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.h2,{id:"the-backend-instance",children:"The Backend Instance"}),"\n",(0,a.jsx)(n.p,{children:"This is the main entry point for creating a backend. It does not have any functionality in and of itself, but is simply responsible for wiring things together.\nIt is up to you to decide how many different backends you want to deploy. You can have all features in a single one, or split things out into multiple smaller deployments."}),"\n",(0,a.jsx)(n.p,{children:"Below is a simple example of a backend that installs only the catalog plugin and starts it up."}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-ts",children:"import { createBackend } from '@backstage/backend-defaults';\nimport scaffolderPlugin from '@backstage/plugin-scaffolder-backend';\n\n// Create your backend instance\nconst backend = createBackend();\n\n// Install desired features\nbackend.add(import('@backstage/plugin-catalog-backend'));\n\n// Features can also be installed using an explicit reference\nbackend.add(scaffolderPlugin);\n\n// Start up the backend\nbackend.start();\n"})}),"\n",(0,a.jsxs)(n.p,{children:["We call ",(0,a.jsx)(n.code,{children:"createBackend"})," to create a new backend instance, which is responsible for wiring together all of the features that we provide to the app. It also provides default implementations of all ",(0,a.jsx)(n.a,{href:"/docs/next/backend-system/core-services/index",children:"core services"})," for use in plugins. No real work is done at the point of creating the backend though, it's all deferred to the ",(0,a.jsx)(n.code,{children:"backend.start()"})," call."]}),"\n",(0,a.jsxs)(n.p,{children:["To add any feature to a backend instance you use the ",(0,a.jsx)(n.code,{children:".add(...)"})," method. Features are either plugins, modules, or service factories. You can read more about building plugins and modules in the ",(0,a.jsx)(n.a,{href:"/docs/next/backend-system/building-plugins-and-modules/index",children:"building plugins and modules docs"}),", as well as how to install services factories in the ",(0,a.jsx)(n.a,{href:"/docs/next/backend-system/building-backends/index",children:"building backends docs"}),"."]}),"\n",(0,a.jsxs)(n.p,{children:["Once you have added all desired features we call the ",(0,a.jsx)(n.code,{children:".start()"})," method. This causes the backend to start up and initialize all features. When starting up the backend will validate all features to make sure that there are no conflicts. For example making sure that there are no circular dependencies."]}),"\n",(0,a.jsxs)(n.p,{children:["Underneath the hood, ",(0,a.jsx)(n.code,{children:"createBackend"})," calls ",(0,a.jsx)(n.code,{children:"createSpecializedBackend"})," from ",(0,a.jsx)(n.code,{children:"@backstage/backend-app-api"})," which is responsible for actually creating the backend instance, without any services or features. You can think of ",(0,a.jsx)(n.code,{children:"createBackend"})," more of a 'batteries included' approach, while ",(0,a.jsx)(n.code,{children:"createSpecializedBackend"})," is more low level."]}),"\n",(0,a.jsx)(n.p,{children:"As mentioned previously there's also the ability to create multiple of these backends in your project so that you can split apart your backend and deploy different backends that can scale independently of each other. For instance you might choose to deploy a backend with only the catalog plugin enabled, and one with just the scaffolder plugin enabled."}),"\n",(0,a.jsx)(n.h3,{id:"backend-startup-result",children:"Backend Startup Result"}),"\n",(0,a.jsxs)(n.p,{children:["The ",(0,a.jsx)(n.code,{children:"Backend.start()"})," method returns a ",(0,a.jsx)(n.code,{children:"BackendStartupResult"})," with detailed success/failure status and timing information for all plugins and modules. When startup fails, a ",(0,a.jsx)(n.code,{children:"BackendStartupError"})," is thrown that includes the complete startup results, making it easier to diagnose which plugins or modules failed."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-ts",children:"backend.start(\n  ({ result }) => {\n    console.log(`Backend startup result: ${JSON.stringify(result, null, 2)}`);\n  },\n  error => {\n    if (error instanceof BackendStartupError) {\n      console.error(\n        `Backend startup failed: ${JSON.stringify(error.result, null, 2)}`,\n      );\n    } else {\n      console.error(\n        `Unexpected error during backend startup: ${error.message}`,\n      );\n    }\n  },\n);\n"})}),"\n",(0,a.jsx)(n.p,{children:"This information is mostly useful if you want to add additional monitoring or debugging tools to your backend. The information is a structured representation of what is already logged during startup."})]})}function u(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(l,{...e})}):l(e)}},221020:(e,n,t)=>{var a=t(296540),s=Symbol.for("react.element"),r=Symbol.for("react.fragment"),c=Object.prototype.hasOwnProperty,i=a.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o={key:!0,ref:!0,__self:!0,__source:!0};function d(e,n,t){var a,r={},d=null,l=null;for(a in void 0!==t&&(d=""+t),void 0!==n.key&&(d=""+n.key),void 0!==n.ref&&(l=n.ref),n)c.call(n,a)&&!o.hasOwnProperty(a)&&(r[a]=n[a]);if(e&&e.defaultProps)for(a in n=e.defaultProps)void 0===r[a]&&(r[a]=n[a]);return{$$typeof:s,type:e,key:d,ref:l,props:r,_owner:i.current}}n.Fragment=r,n.jsx=d,n.jsxs=d},474848:(e,n,t)=>{e.exports=t(221020)},28453:(e,n,t)=>{t.d(n,{R:()=>c,x:()=>i});var a=t(296540);const s={},r=a.createContext(s);function c(e){const n=a.useContext(r);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:c(e.components),a.createElement(r.Provider,{value:n},e.children)}}}]);