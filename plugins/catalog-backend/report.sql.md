## SQL Report file for "@backstage/plugin-catalog-backend"

> Do not edit this file. It is a report generated by `yarn build:api-reports`

> [!WARNING]
> Failed to migrate down from '20241003170511_alter_target_in_locations.js'

## Sequences

- `location_update_log_id_seq` (bigint)
- `refresh_state_references_id_seq` (integer)

## Table `final_entities`

| Column            | Type                       | Nullable | Max Length | Default |
| ----------------- | -------------------------- | -------- | ---------- | ------- |
| `entity_id`       | `character varying`        | false    | 255        | -       |
| `entity_ref`      | `character varying`        | false    | 255        | -       |
| `final_entity`    | `text`                     | true     | -          | -       |
| `hash`            | `character varying`        | false    | 255        | -       |
| `last_updated_at` | `timestamp with time zone` | true     | -          | -       |
| `stitch_ticket`   | `text`                     | false    | -          | -       |

### Indices

- `final_entities_entity_ref_uniq` (`entity_ref`) unique
- `final_entities_pkey` (`entity_id`) unique primary

## Table `location_update_log`

| Column        | Type                       | Nullable | Max Length | Default                                           |
| ------------- | -------------------------- | -------- | ---------- | ------------------------------------------------- |
| `created_at`  | `timestamp with time zone` | false    | -          | `CURRENT_TIMESTAMP`                               |
| `entity_name` | `text`                     | true     | -          | -                                                 |
| `id`          | `bigint`                   | false    | -          | `nextval('location_update_log_id_seq'::regclass)` |
| `location_id` | `uuid`                     | true     | -          | -                                                 |
| `message`     | `text`                     | true     | -          | -                                                 |
| `status`      | `text`                     | false    | -          | -                                                 |

### Indices

- `location_update_log_pkey` (`id`) unique primary
- `update_log_location_id_idx` (`location_id`)

## Table `locations`

| Column   | Type                | Nullable | Max Length | Default |
| -------- | ------------------- | -------- | ---------- | ------- |
| `id`     | `uuid`              | false    | -          | -       |
| `target` | `text`              | true     | -          | -       |
| `type`   | `character varying` | false    | 255        | -       |

### Indices

- `locations_pkey` (`id`) unique primary

## Table `refresh_keys`

| Column      | Type                | Nullable | Max Length | Default |
| ----------- | ------------------- | -------- | ---------- | ------- |
| `entity_id` | `character varying` | false    | 255        | -       |
| `key`       | `character varying` | false    | 255        | -       |

### Indices

- `refresh_keys_entity_id_idx` (`entity_id`)
- `refresh_keys_key_idx` (`key`)

## Table `refresh_state`

| Column               | Type                       | Nullable | Max Length | Default |
| -------------------- | -------------------------- | -------- | ---------- | ------- |
| `cache`              | `text`                     | true     | -          | -       |
| `entity_id`          | `character varying`        | false    | 255        | -       |
| `entity_ref`         | `character varying`        | false    | 255        | -       |
| `errors`             | `text`                     | false    | -          | -       |
| `last_discovery_at`  | `timestamp with time zone` | false    | -          | -       |
| `location_key`       | `text`                     | true     | -          | -       |
| `next_stitch_at`     | `timestamp with time zone` | true     | -          | -       |
| `next_stitch_ticket` | `character varying`        | true     | 255        | -       |
| `next_update_at`     | `timestamp with time zone` | false    | -          | -       |
| `processed_entity`   | `text`                     | true     | -          | -       |
| `result_hash`        | `text`                     | true     | -          | -       |
| `unprocessed_entity` | `text`                     | false    | -          | -       |
| `unprocessed_hash`   | `text`                     | true     | -          | -       |

### Indices

- `refresh_state_entity_ref_uniq` (`entity_ref`) unique
- `refresh_state_next_stitch_at_idx` (`next_stitch_at`)
- `refresh_state_next_update_at_idx` (`next_update_at`)
- `refresh_state_pkey` (`entity_id`) unique primary

## Table `refresh_state_references`

| Column              | Type      | Nullable | Max Length | Default                                                |
| ------------------- | --------- | -------- | ---------- | ------------------------------------------------------ |
| `id`                | `integer` | false    | -          | `nextval('refresh_state_references_id_seq'::regclass)` |
| `source_entity_ref` | `text`    | true     | -          | -                                                      |
| `source_key`        | `text`    | true     | -          | -                                                      |
| `target_entity_ref` | `text`    | false    | -          | -                                                      |

### Indices

- `refresh_state_references_pkey` (`id`) unique primary
- `refresh_state_references_source_entity_ref_idx` (`source_entity_ref`)
- `refresh_state_references_source_key_idx` (`source_key`)
- `refresh_state_references_target_entity_ref_idx` (`target_entity_ref`)

## Table `relations`

| Column                  | Type                | Nullable | Max Length | Default |
| ----------------------- | ------------------- | -------- | ---------- | ------- |
| `originating_entity_id` | `character varying` | false    | 255        | -       |
| `source_entity_ref`     | `character varying` | false    | 255        | -       |
| `target_entity_ref`     | `character varying` | false    | 255        | -       |
| `type`                  | `character varying` | false    | 255        | -       |

### Indices

- `relations_source_entity_id_idx` (`originating_entity_id`)
- `relations_source_entity_ref_idx` (`source_entity_ref`)

## Table `search`

| Column           | Type                | Nullable | Max Length | Default |
| ---------------- | ------------------- | -------- | ---------- | ------- |
| `entity_id`      | `character varying` | true     | 255        | -       |
| `key`            | `character varying` | false    | 255        | -       |
| `original_value` | `character varying` | true     | 255        | -       |
| `value`          | `character varying` | true     | 255        | -       |

### Indices

- `search_entity_id_idx` (`entity_id`)
- `search_key_original_value_idx` (`key`, `original_value`)
- `search_key_value_idx` (`key`, `value`)
