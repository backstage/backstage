## API Report File for "@backstage/plugin-search-backend-module-pg"

> Do not edit this file. It is a report generated by [API Extractor](https://api-extractor.com/).

```ts
import { BatchSearchEngineIndexer } from '@backstage/plugin-search-backend-node';
import { Config } from '@backstage/config';
import { DatabaseService } from '@backstage/backend-plugin-api';
import { IndexableDocument } from '@backstage/plugin-search-common';
import { IndexableResultSet } from '@backstage/plugin-search-common';
import { Knex } from 'knex';
import { LoggerService } from '@backstage/backend-plugin-api';
import { SearchEngine } from '@backstage/plugin-search-backend-node';
import { SearchQuery } from '@backstage/plugin-search-common';

// @public
export type ConcretePgSearchQuery = {
  pgQuery: PgSearchQuery;
  pageSize: number;
};

// @public (undocumented)
export class DatabaseDocumentStore implements DatabaseStore {
  constructor(db: Knex);
  // (undocumented)
  completeInsert(tx: Knex.Transaction, type: string): Promise<void>;
  // (undocumented)
  static create(database: DatabaseService): Promise<DatabaseDocumentStore>;
  // (undocumented)
  getTransaction(): Promise<Knex.Transaction>;
  // (undocumented)
  insertDocuments(
    tx: Knex.Transaction,
    type: string,
    documents: IndexableDocument[],
  ): Promise<void>;
  // (undocumented)
  prepareInsert(tx: Knex.Transaction): Promise<void>;
  // (undocumented)
  query(
    tx: Knex.Transaction,
    searchQuery: PgSearchQuery,
  ): Promise<DocumentResultRow[]>;
  // (undocumented)
  static supported(knex: Knex): Promise<boolean>;
  // (undocumented)
  transaction<T>(fn: (tx: Knex.Transaction) => Promise<T>): Promise<T>;
}

// @public (undocumented)
export interface DatabaseStore {
  // (undocumented)
  completeInsert(tx: Knex.Transaction, type: string): Promise<void>;
  // (undocumented)
  getTransaction(): Promise<Knex.Transaction>;
  // (undocumented)
  insertDocuments(
    tx: Knex.Transaction,
    type: string,
    documents: IndexableDocument[],
  ): Promise<void>;
  // (undocumented)
  prepareInsert(tx: Knex.Transaction): Promise<void>;
  // (undocumented)
  query(
    tx: Knex.Transaction,
    pgQuery: PgSearchQuery,
  ): Promise<DocumentResultRow[]>;
  // (undocumented)
  transaction<T>(fn: (tx: Knex.Transaction) => Promise<T>): Promise<T>;
}

// @public (undocumented)
export interface DocumentResultRow {
  // (undocumented)
  document: IndexableDocument;
  // (undocumented)
  highlight: IndexableDocument;
  // (undocumented)
  type: string;
}

// @public (undocumented)
export class PgSearchEngine implements SearchEngine {
  // @deprecated
  constructor(
    databaseStore: DatabaseStore,
    config: Config,
    logger?: LoggerService,
  );
  // @deprecated (undocumented)
  static from(options: {
    database: DatabaseService;
    config: Config;
    logger?: LoggerService;
  }): Promise<PgSearchEngine>;
  // (undocumented)
  static fromConfig(
    config: Config,
    options: PgSearchOptions,
  ): Promise<PgSearchEngine>;
  // (undocumented)
  getIndexer(type: string): Promise<PgSearchEngineIndexer>;
  // (undocumented)
  query(query: SearchQuery): Promise<IndexableResultSet>;
  // (undocumented)
  setTranslator(translator: PgSearchQueryTranslator): void;
  // (undocumented)
  static supported(database: DatabaseService): Promise<boolean>;
  // (undocumented)
  translator(
    query: SearchQuery,
    options: PgSearchQueryTranslatorOptions,
  ): ConcretePgSearchQuery;
}

// @public (undocumented)
export class PgSearchEngineIndexer extends BatchSearchEngineIndexer {
  constructor(options: PgSearchEngineIndexerOptions);
  // (undocumented)
  finalize(): Promise<void>;
  // (undocumented)
  index(documents: IndexableDocument[]): Promise<void>;
  // (undocumented)
  initialize(): Promise<void>;
}

// @public (undocumented)
export type PgSearchEngineIndexerOptions = {
  batchSize: number;
  type: string;
  databaseStore: DatabaseStore;
  logger?: LoggerService;
};

// @public
export type PgSearchHighlightOptions = {
  useHighlight?: boolean;
  maxWords?: number;
  minWords?: number;
  shortWord?: number;
  highlightAll?: boolean;
  maxFragments?: number;
  fragmentDelimiter?: string;
  preTag: string;
  postTag: string;
};

// @public
export type PgSearchOptions = {
  database: DatabaseService;
  logger?: LoggerService;
};

// @public (undocumented)
export interface PgSearchQuery {
  // (undocumented)
  fields?: Record<string, string | string[]>;
  // (undocumented)
  limit: number;
  // (undocumented)
  offset: number;
  // (undocumented)
  options: PgSearchHighlightOptions;
  // (undocumented)
  pgTerm?: string;
  // (undocumented)
  types?: string[];
}

// @public
export type PgSearchQueryTranslator = (
  query: SearchQuery,
  options: PgSearchQueryTranslatorOptions,
) => ConcretePgSearchQuery;

// @public
export type PgSearchQueryTranslatorOptions = {
  highlightOptions: PgSearchHighlightOptions;
};

// @public (undocumented)
export interface RawDocumentRow {
  // (undocumented)
  document: IndexableDocument;
  // (undocumented)
  hash: unknown;
  // (undocumented)
  type: string;
}

// Warnings were encountered during analysis:
//
// src/PgSearchEngine/PgSearchEngine.d.ts:51:1 - (ae-undocumented) Missing documentation for "PgSearchEngine".
// src/PgSearchEngine/PgSearchEngine.d.ts:63:5 - (ae-undocumented) Missing documentation for "from".
// src/PgSearchEngine/PgSearchEngine.d.ts:68:5 - (ae-undocumented) Missing documentation for "fromConfig".
// src/PgSearchEngine/PgSearchEngine.d.ts:69:5 - (ae-undocumented) Missing documentation for "supported".
// src/PgSearchEngine/PgSearchEngine.d.ts:70:5 - (ae-undocumented) Missing documentation for "translator".
// src/PgSearchEngine/PgSearchEngine.d.ts:71:5 - (ae-undocumented) Missing documentation for "setTranslator".
// src/PgSearchEngine/PgSearchEngine.d.ts:72:5 - (ae-undocumented) Missing documentation for "getIndexer".
// src/PgSearchEngine/PgSearchEngine.d.ts:73:5 - (ae-undocumented) Missing documentation for "query".
// src/PgSearchEngine/PgSearchEngineIndexer.d.ts:6:1 - (ae-undocumented) Missing documentation for "PgSearchEngineIndexerOptions".
// src/PgSearchEngine/PgSearchEngineIndexer.d.ts:13:1 - (ae-undocumented) Missing documentation for "PgSearchEngineIndexer".
// src/PgSearchEngine/PgSearchEngineIndexer.d.ts:20:5 - (ae-undocumented) Missing documentation for "initialize".
// src/PgSearchEngine/PgSearchEngineIndexer.d.ts:21:5 - (ae-undocumented) Missing documentation for "index".
// src/PgSearchEngine/PgSearchEngineIndexer.d.ts:22:5 - (ae-undocumented) Missing documentation for "finalize".
// src/database/DatabaseDocumentStore.d.ts:6:1 - (ae-undocumented) Missing documentation for "DatabaseDocumentStore".
// src/database/DatabaseDocumentStore.d.ts:8:5 - (ae-undocumented) Missing documentation for "create".
// src/database/DatabaseDocumentStore.d.ts:9:5 - (ae-undocumented) Missing documentation for "supported".
// src/database/DatabaseDocumentStore.d.ts:11:5 - (ae-undocumented) Missing documentation for "transaction".
// src/database/DatabaseDocumentStore.d.ts:12:5 - (ae-undocumented) Missing documentation for "getTransaction".
// src/database/DatabaseDocumentStore.d.ts:13:5 - (ae-undocumented) Missing documentation for "prepareInsert".
// src/database/DatabaseDocumentStore.d.ts:14:5 - (ae-undocumented) Missing documentation for "completeInsert".
// src/database/DatabaseDocumentStore.d.ts:15:5 - (ae-undocumented) Missing documentation for "insertDocuments".
// src/database/DatabaseDocumentStore.d.ts:16:5 - (ae-undocumented) Missing documentation for "query".
// src/database/types.d.ts:5:1 - (ae-undocumented) Missing documentation for "PgSearchQuery".
// src/database/types.d.ts:6:5 - (ae-undocumented) Missing documentation for "fields".
// src/database/types.d.ts:7:5 - (ae-undocumented) Missing documentation for "types".
// src/database/types.d.ts:8:5 - (ae-undocumented) Missing documentation for "pgTerm".
// src/database/types.d.ts:9:5 - (ae-undocumented) Missing documentation for "offset".
// src/database/types.d.ts:10:5 - (ae-undocumented) Missing documentation for "limit".
// src/database/types.d.ts:11:5 - (ae-undocumented) Missing documentation for "options".
// src/database/types.d.ts:14:1 - (ae-undocumented) Missing documentation for "DatabaseStore".
// src/database/types.d.ts:15:5 - (ae-undocumented) Missing documentation for "transaction".
// src/database/types.d.ts:16:5 - (ae-undocumented) Missing documentation for "getTransaction".
// src/database/types.d.ts:17:5 - (ae-undocumented) Missing documentation for "prepareInsert".
// src/database/types.d.ts:18:5 - (ae-undocumented) Missing documentation for "insertDocuments".
// src/database/types.d.ts:19:5 - (ae-undocumented) Missing documentation for "completeInsert".
// src/database/types.d.ts:20:5 - (ae-undocumented) Missing documentation for "query".
// src/database/types.d.ts:23:1 - (ae-undocumented) Missing documentation for "RawDocumentRow".
// src/database/types.d.ts:24:5 - (ae-undocumented) Missing documentation for "document".
// src/database/types.d.ts:25:5 - (ae-undocumented) Missing documentation for "type".
// src/database/types.d.ts:26:5 - (ae-undocumented) Missing documentation for "hash".
// src/database/types.d.ts:29:1 - (ae-undocumented) Missing documentation for "DocumentResultRow".
// src/database/types.d.ts:30:5 - (ae-undocumented) Missing documentation for "document".
// src/database/types.d.ts:31:5 - (ae-undocumented) Missing documentation for "type".
// src/database/types.d.ts:32:5 - (ae-undocumented) Missing documentation for "highlight".
```
