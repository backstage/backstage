## API Report File for "@backstage/core-plugin-api"

> Do not edit this file. It is a report generated by [API Extractor](https://api-extractor.com/).

```ts
/// <reference types="react" />

import { BackstageTheme } from '@backstage/theme';
import { ComponentType } from 'react';
import { Config } from '@backstage/config';
import { Observable as Observable_2 } from '@backstage/types';
import { Observer as Observer_2 } from '@backstage/types';
import { default as React_2 } from 'react';
import { ReactElement } from 'react';
import { ReactNode } from 'react';
import { Subscription as Subscription_2 } from '@backstage/types';
import { SvgIconProps } from '@material-ui/core';

// @public
export type AlertApi = {
  post(alert: AlertMessage): void;
  alert$(): Observable_2<AlertMessage>;
};

// @public
export const alertApiRef: ApiRef<AlertApi>;

// @public
export type AlertMessage = {
  message: string;
  severity?: 'success' | 'info' | 'warning' | 'error';
};

// @public
export type AnalyticsApi = {
  captureEvent(event: AnalyticsEvent): void;
};

// @public
export const analyticsApiRef: ApiRef<AnalyticsApi>;

// @public
export const AnalyticsContext: ({
  attributes,
  children,
}: {
  attributes: Partial<AnalyticsContextValue>;
  children: ReactNode;
}) => JSX.Element;

// @public
export type AnalyticsContextValue = CommonAnalyticsContext &
  AnyAnalyticsContext;

// @public
export type AnalyticsEvent = {
  action: string;
  subject: string;
  value?: number;
  attributes?: AnalyticsEventAttributes;
  context: AnalyticsContextValue;
};

// @public
export type AnalyticsEventAttributes = {
  [attribute in string]: string | boolean | number;
};

// @public
export type AnalyticsTracker = {
  captureEvent: (
    action: string,
    subject: string,
    options?: {
      value?: number;
      attributes?: AnalyticsEventAttributes;
    },
  ) => void;
};

// @public
export type AnyAnalyticsContext = {
  [param in string]: string | boolean | number | undefined;
};

// @public
export type AnyApiFactory = ApiFactory<
  unknown,
  unknown,
  {
    [key in string]: unknown;
  }
>;

// @public
export type AnyApiRef = ApiRef<unknown>;

// @public
export type AnyExternalRoutes = {
  [name: string]: ExternalRouteRef;
};

// @public
export type AnyParams =
  | {
      [param in string]: string;
    }
  | undefined;

// @public
export type AnyRoutes = {
  [name: string]: RouteRef | SubRouteRef;
};

// @public
export type ApiFactory<
  Api,
  Impl extends Api,
  Deps extends {
    [name in string]: unknown;
  },
> = {
  api: ApiRef<Api>;
  deps: TypesToApiRefs<Deps>;
  factory(deps: Deps): Impl;
};

// @public
export type ApiHolder = {
  get<T>(api: ApiRef<T>): T | undefined;
};

// @public
export type ApiRef<T> = {
  id: string;
  T: T;
};

// @public
export type ApiRefConfig = {
  id: string;
  description?: string;
};

// @public @deprecated
export type ApiRefsToTypes<
  T extends {
    [key in string]: ApiRef<unknown>;
  },
> = {
  [key in keyof T]: ApiRefType<T[key]>;
};

// @public @deprecated
export type ApiRefType<T> = T extends ApiRef<infer U> ? U : never;

// @public
export type AppComponents = {
  NotFoundErrorPage: ComponentType<{}>;
  BootErrorPage: ComponentType<BootErrorPageProps>;
  Progress: ComponentType<{}>;
  Router: ComponentType<{}>;
  ErrorBoundaryFallback: ComponentType<ErrorBoundaryFallbackProps>;
  SignInPage?: ComponentType<SignInPageProps>;
};

// @public
export type AppContext = {
  getPlugins(): BackstagePlugin<any, any>[];
  getSystemIcon(key: string): IconComponent | undefined;
  getComponents(): AppComponents;
};

// @public
export type AppTheme = {
  id: string;
  title: string;
  variant: 'light' | 'dark';
  theme: BackstageTheme;
  icon?: React.ReactElement;
};

// @public
export type AppThemeApi = {
  getInstalledThemes(): AppTheme[];
  activeThemeId$(): Observable_2<string | undefined>;
  getActiveThemeId(): string | undefined;
  setActiveThemeId(themeId?: string): void;
};

// @public
export const appThemeApiRef: ApiRef<AppThemeApi>;

// @public
export const atlassianAuthApiRef: ApiRef<
  OAuthApi & ProfileInfoApi & BackstageIdentityApi & SessionApi
>;

// @public
export function attachComponentData<P>(
  component: ComponentType<P>,
  type: string,
  data: unknown,
): void;

// @public
export const auth0AuthApiRef: ApiRef<
  OpenIdConnectApi & ProfileInfoApi & BackstageIdentityApi & SessionApi
>;

// @public
export type AuthProvider = {
  title: string;
  icon: IconComponent;
};

// @public
export type AuthRequester<AuthResponse> = (
  scopes: Set<string>,
) => Promise<AuthResponse>;

// @public
export type AuthRequesterOptions<AuthResponse> = {
  provider: AuthProvider;
  onAuthRequest(scopes: Set<string>): Promise<AuthResponse>;
};

// @public
export type AuthRequestOptions = {
  optional?: boolean;
  instantPopup?: boolean;
};

// @public
export type BackstageIdentity = {
  id: string;
  idToken: string;
  token: string;
};

// @public
export type BackstageIdentityApi = {
  getBackstageIdentity(
    options?: AuthRequestOptions,
  ): Promise<BackstageIdentity | undefined>;
};

// @public
export type BackstagePlugin<
  Routes extends AnyRoutes = {},
  ExternalRoutes extends AnyExternalRoutes = {},
> = {
  getId(): string;
  output(): PluginOutput[];
  getApis(): Iterable<AnyApiFactory>;
  provide<T>(extension: Extension<T>): T;
  routes: Routes;
  externalRoutes: ExternalRoutes;
};

// @public
export const bitbucketAuthApiRef: ApiRef<
  OAuthApi & ProfileInfoApi & BackstageIdentityApi & SessionApi
>;

// @public
export type BootErrorPageProps = {
  step: 'load-config' | 'load-chunk';
  error: Error;
};

// @public
export type CommonAnalyticsContext = {
  pluginId: string;
  routeRef: string;
  extension: string;
};

// @public
export type ComponentLoader<T> =
  | {
      lazy: () => Promise<T>;
    }
  | {
      sync: T;
    };

// @public
export type ConfigApi = Config;

// @public
export const configApiRef: ApiRef<ConfigApi>;

// @public
export function createApiFactory<
  Api,
  Impl extends Api,
  Deps extends {
    [name in string]: unknown;
  },
>(factory: ApiFactory<Api, Impl, Deps>): ApiFactory<Api, Impl, Deps>;

// @public
export function createApiFactory<Api, Impl extends Api>(
  api: ApiRef<Api>,
  instance: Impl,
): ApiFactory<Api, Impl, {}>;

// @public
export function createApiRef<T>(config: ApiRefConfig): ApiRef<T>;

// @public
export function createComponentExtension<
  T extends (props: any) => JSX.Element | null,
>(options: { component: ComponentLoader<T>; name?: string }): Extension<T>;

// @public
export function createExternalRouteRef<
  Params extends {
    [param in ParamKey]: string;
  },
  Optional extends boolean = false,
  ParamKey extends string = never,
>(options: {
  id: string;
  params?: ParamKey[];
  optional?: Optional;
}): ExternalRouteRef<OptionalParams<Params>, Optional>;

// @public
export function createPlugin<
  Routes extends AnyRoutes = {},
  ExternalRoutes extends AnyExternalRoutes = {},
>(
  config: PluginConfig<Routes, ExternalRoutes>,
): BackstagePlugin<Routes, ExternalRoutes>;

// @public
export function createReactExtension<
  T extends (props: any) => JSX.Element | null,
>(options: {
  component: ComponentLoader<T>;
  data?: Record<string, unknown>;
  name?: string;
}): Extension<T>;

// @public
export function createRoutableExtension<
  T extends (props: any) => JSX.Element | null,
>(options: {
  component: () => Promise<T>;
  mountPoint: RouteRef;
  name?: string;
}): Extension<T>;

// @public
export function createRouteRef<
  Params extends {
    [param in ParamKey]: string;
  },
  ParamKey extends string = never,
>(config: {
  id?: string;
  params?: ParamKey[];
  path?: string;
  icon?: OldIconComponent;
  title?: string;
}): RouteRef<OptionalParams<Params>>;

// @public
export function createSubRouteRef<
  Path extends string,
  ParentParams extends AnyParams = never,
>(config: {
  id: string;
  path: Path;
  parent: RouteRef<ParentParams>;
}): MakeSubRouteRef<PathParams<Path>, ParentParams>;

// @public
export type DiscoveryApi = {
  getBaseUrl(pluginId: string): Promise<string>;
};

// @public
export const discoveryApiRef: ApiRef<DiscoveryApi>;

// @public
export interface ElementCollection {
  findComponentData<T>(query: { key: string }): T[];
  getElements<
    Props extends {
      [name: string]: unknown;
    },
  >(): Array<ReactElement<Props>>;
  selectByComponentData(query: {
    key: string;
    withStrictError?: string;
  }): ElementCollection;
}

// @public
type Error_2 = {
  name: string;
  message: string;
  stack?: string;
};
export { Error_2 as Error };

// @public
export type ErrorApi = {
  post(error: Error_2, context?: ErrorContext): void;
  error$(): Observable_2<{
    error: Error_2;
    context?: ErrorContext;
  }>;
};

// @public
export const errorApiRef: ApiRef<ErrorApi>;

// @public
export type ErrorBoundaryFallbackProps = {
  plugin?: BackstagePlugin;
  error: Error;
  resetError: () => void;
};

// @public
export type ErrorContext = {
  hidden?: boolean;
};

// @public
export type Extension<T> = {
  expose(plugin: BackstagePlugin<any, any>): T;
};

// @public
export type ExternalRouteRef<
  Params extends AnyParams = any,
  Optional extends boolean = any,
> = {
  $$routeRefType: 'external';
  params: ParamKeys<Params>;
  optional?: Optional;
};

// @public
export type FeatureFlag = {
  name: string;
  pluginId: string;
};

// @public
export type FeatureFlagOutput = {
  type: 'feature-flag';
  name: string;
};

// @public
export interface FeatureFlagsApi {
  getRegisteredFlags(): FeatureFlag[];
  isActive(name: string): boolean;
  registerFlag(flag: FeatureFlag): void;
  save(options: FeatureFlagsSaveOptions): void;
}

// @public
export const featureFlagsApiRef: ApiRef<FeatureFlagsApi>;

// @public
export type FeatureFlagsHooks = {
  register(name: string): void;
};

// @public
export type FeatureFlagsSaveOptions = {
  states: Record<string, FeatureFlagState>;
  merge?: boolean;
};

// @public
export enum FeatureFlagState {
  Active = 1,
  None = 0,
}

// @public
export function getComponentData<T>(
  node: ReactNode,
  type: string,
): T | undefined;

// @public
export const githubAuthApiRef: ApiRef<
  OAuthApi & ProfileInfoApi & BackstageIdentityApi & SessionApi
>;

// @public
export const gitlabAuthApiRef: ApiRef<
  OAuthApi & ProfileInfoApi & BackstageIdentityApi & SessionApi
>;

// @public
export const googleAuthApiRef: ApiRef<
  OAuthApi &
    OpenIdConnectApi &
    ProfileInfoApi &
    BackstageIdentityApi &
    SessionApi
>;

// @public
export type IconComponent = ComponentType<{
  fontSize?: 'default' | 'small' | 'large';
}>;

// @public
export type IdentityApi = {
  getUserId(): string;
  getProfile(): ProfileInfo;
  getIdToken(): Promise<string | undefined>;
  signOut(): Promise<void>;
};

// @public
export const identityApiRef: ApiRef<IdentityApi>;

// @public
export type MakeSubRouteRef<
  Params extends {
    [param in string]: string;
  },
  ParentParams extends AnyParams,
> = keyof Params & keyof ParentParams extends never
  ? SubRouteRef<OptionalParams<MergeParams<Params, ParentParams>>>
  : never;

// @public
export type MergeParams<
  P1 extends {
    [param in string]: string;
  },
  P2 extends AnyParams,
> = (P1[keyof P1] extends never ? {} : P1) & (P2 extends undefined ? {} : P2);

// @public
export const microsoftAuthApiRef: ApiRef<
  OAuthApi &
    OpenIdConnectApi &
    ProfileInfoApi &
    BackstageIdentityApi &
    SessionApi
>;

// @public
export const oauth2ApiRef: ApiRef<
  OAuthApi &
    OpenIdConnectApi &
    ProfileInfoApi &
    BackstageIdentityApi &
    SessionApi
>;

// @public
export type OAuthApi = {
  getAccessToken(
    scope?: OAuthScope,
    options?: AuthRequestOptions,
  ): Promise<string>;
};

// @public
export type OAuthRequestApi = {
  createAuthRequester<AuthResponse>(
    options: AuthRequesterOptions<AuthResponse>,
  ): AuthRequester<AuthResponse>;
  authRequest$(): Observable_2<PendingAuthRequest[]>;
};

// @public
export const oauthRequestApiRef: ApiRef<OAuthRequestApi>;

// @public
export type OAuthScope = string | string[];

// @public @deprecated
export type Observable<T> = Observable_2<T>;

// @public @deprecated
export type Observer<T> = Observer_2<T>;

// @public
export const oidcAuthApiRef: ApiRef<
  OAuthApi &
    OpenIdConnectApi &
    ProfileInfoApi &
    BackstageIdentityApi &
    SessionApi
>;

// @public
export const oktaAuthApiRef: ApiRef<
  OAuthApi &
    OpenIdConnectApi &
    ProfileInfoApi &
    BackstageIdentityApi &
    SessionApi
>;

// @public
export type OldIconComponent = ComponentType<SvgIconProps>;

// @public
export const oneloginAuthApiRef: ApiRef<
  OAuthApi &
    OpenIdConnectApi &
    ProfileInfoApi &
    BackstageIdentityApi &
    SessionApi
>;

// @public
export type OpenIdConnectApi = {
  getIdToken(options?: AuthRequestOptions): Promise<string>;
};

// @public
export type OptionalParams<
  Params extends {
    [param in string]: string;
  },
> = Params[keyof Params] extends never ? undefined : Params;

// @public
export type ParamKeys<Params extends AnyParams> = keyof Params extends never
  ? []
  : (keyof Params)[];

// @public
export type ParamNames<S extends string> =
  S extends `${infer Part}/${infer Rest}`
    ? ParamPart<Part> | ParamNames<Rest>
    : ParamPart<S>;

// @public
export type ParamPart<S extends string> = S extends `:${infer Param}`
  ? Param
  : never;

// @public
export type PathParams<S extends string> = {
  [name in ParamNames<S>]: string;
};

// @public
export type PendingAuthRequest = {
  provider: AuthProvider;
  reject: () => void;
  trigger(): Promise<void>;
};

// @public
export type PluginConfig<
  Routes extends AnyRoutes,
  ExternalRoutes extends AnyExternalRoutes,
> = {
  id: string;
  apis?: Iterable<AnyApiFactory>;
  register?(hooks: PluginHooks): void;
  routes?: Routes;
  externalRoutes?: ExternalRoutes;
};

// @public
export type PluginHooks = {
  featureFlags: FeatureFlagsHooks;
};

// @public
export type PluginOutput = FeatureFlagOutput;

// @public
export type ProfileInfo = {
  email?: string;
  displayName?: string;
  picture?: string;
};

// @public
export type ProfileInfoApi = {
  getProfile(options?: AuthRequestOptions): Promise<ProfileInfo | undefined>;
};

// @public
export type RouteFunc<Params extends AnyParams> = (
  ...[params]: Params extends undefined ? readonly [] : readonly [Params]
) => string;

// @public
export type RouteOptions = {
  exact?: boolean;
};

// @public
export type RoutePath = string;

// @public
export type RouteRef<Params extends AnyParams = any> = {
  $$routeRefType: 'absolute';
  params: ParamKeys<Params>;
  path: string;
  icon?: OldIconComponent;
  title?: string;
};

// @public
export const samlAuthApiRef: ApiRef<
  ProfileInfoApi & BackstageIdentityApi & SessionApi
>;

// @public
export type SessionApi = {
  signIn(): Promise<void>;
  signOut(): Promise<void>;
  sessionState$(): Observable_2<SessionState>;
};

// @public
export enum SessionState {
  SignedIn = 'SignedIn',
  SignedOut = 'SignedOut',
}

// @public
export type SignInPageProps = {
  onResult(result: SignInResult): void;
};

// @public
export type SignInResult = {
  userId: string;
  profile: ProfileInfo;
  getIdToken?: () => Promise<string>;
  signOut?: () => Promise<void>;
};

// @public
export interface StorageApi {
  forBucket(name: string): StorageApi;
  get<T>(key: string): T | undefined;
  observe$<T>(key: string): Observable_2<StorageValueChange<T>>;
  remove(key: string): Promise<void>;
  set(key: string, data: any): Promise<void>;
}

// @public
export const storageApiRef: ApiRef<StorageApi>;

// @public
export type StorageValueChange<T = any> = {
  key: string;
  newValue?: T;
};

// @public
export type SubRouteRef<Params extends AnyParams = any> = {
  $$routeRefType: 'sub';
  parent: RouteRef;
  path: string;
  params: ParamKeys<Params>;
};

// @public @deprecated
export type Subscription = Subscription_2;

// @public
export type TypesToApiRefs<T> = {
  [key in keyof T]: ApiRef<T[key]>;
};

// @public
export function useAnalytics(): AnalyticsTracker;

// @public
export function useApi<T>(apiRef: ApiRef<T>): T;

// @public
export function useApiHolder(): ApiHolder;

// @public
export const useApp: () => AppContext;

// @public
export function useElementFilter<T>(
  node: ReactNode,
  filterFn: (arg: ElementCollection) => T,
  dependencies?: any[],
): T;

// @public
export function useRouteRef<Optional extends boolean, Params extends AnyParams>(
  routeRef: ExternalRouteRef<Params, Optional>,
): Optional extends true ? RouteFunc<Params> | undefined : RouteFunc<Params>;

// @public
export function useRouteRef<Params extends AnyParams>(
  routeRef: RouteRef<Params> | SubRouteRef<Params>,
): RouteFunc<Params>;

// @public
export function useRouteRefParams<Params extends AnyParams>(
  _routeRef: RouteRef<Params> | SubRouteRef<Params>,
): Params;

// @public
export function withApis<T>(apis: TypesToApiRefs<T>): <P extends T>(
  WrappedComponent: React_2.ComponentType<P>,
) => {
  (props: React_2.PropsWithChildren<Omit<P, keyof T>>): JSX.Element;
  displayName: string;
};
```
