/*
 * Copyright 2026 The Backstage Authors
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

// ******************************************************************
// * THIS IS AN AUTOGENERATED FILE. DO NOT EDIT THIS FILE DIRECTLY. *
// ******************************************************************
import { createValidatedOpenApiRouterFromGeneratedEndpointMap } from '@backstage/backend-openapi-utils';
import { EndpointMap } from './apis';

export const spec = {
  openapi: '3.1.0',
  info: {
    title: '.backstage/dynamic-features',
    version: '1',
    description:
      'The Backstage backend plugin that serves the frontend plugins module federation manifests and assets',
    license: {
      name: 'Apache-2.0',
      url: 'http://www.apache.org/licenses/LICENSE-2.0.html',
    },
    contact: {},
  },
  servers: [
    {
      url: '/',
    },
  ],
  components: {
    examples: {},
    headers: {},
    parameters: {},
    requestBodies: {},
    responses: {
      RemotesResponse: {
        description: 'List of Module Federation Remotes exposed by the backend',
        content: {
          'application/json': {
            schema: {
              $ref: '#/components/schemas/Remotes',
            },
          },
        },
      },
      ErrorResponse: {
        description: 'An error response from the backend.',
        content: {
          'application/json': {
            schema: {
              $ref: '#/components/schemas/Error',
            },
          },
        },
      },
    },
    schemas: {
      Remotes: {
        type: 'array',
        items: {
          $ref: '#/components/schemas/Remote',
        },
      },
      Remote: {
        description:
          'Definition of a frontend plugin Module Federation remote served by the backend',
        type: 'object',
        properties: {
          packageName: {
            description:
              'Name of the package exposed through this Module Federation remote',
            type: 'string',
          },
          remoteInfo: {
            $ref: '#/components/schemas/RemoteInfo',
          },
          exposedModules: {
            description:
              'Names of modules exposed by this module federation remote',
            type: 'array',
            items: {
              type: 'string',
            },
          },
        },
        required: ['packageName', 'remoteInfo', 'exposedModules'],
      },
      RemoteInfo: {
        description:
          'Definition of a frontend plugin Module Federation remote served by the backend',
        externalDocs: {
          url: 'https://module-federation.io/guide/basic/runtime.html#init',
        },
        type: 'object',
        properties: {
          name: {
            description: 'Name of the module federation remote',
            type: 'string',
          },
          entry: {
            description:
              'Remote entry, either the remote manifest file, or the remote entry Javascript file.',
            type: 'string',
          },
          entryGlobalName: {
            type: 'string',
          },
          shareScope: {
            type: 'string',
          },
          type: {
            type: 'string',
            enum: [
              'var',
              'module',
              'assign',
              'assign-properties',
              'this',
              'window',
              'self',
              'global',
              'commonjs',
              'commonjs2',
              'commonjs-module',
              'commonjs-static',
              'amd',
              'amd-require',
              'umd',
              'umd2',
              'jsonp',
              'system',
            ],
          },
        },
        required: ['name', 'entry'],
      },
      Error: {
        type: 'object',
        properties: {
          error: {
            type: 'object',
            properties: {
              name: {
                type: 'string',
              },
              message: {
                type: 'string',
              },
              stack: {
                type: 'string',
              },
              code: {
                type: 'string',
              },
            },
            required: ['name', 'message'],
          },
          request: {
            type: 'object',
            properties: {
              method: {
                type: 'string',
              },
              url: {
                type: 'string',
              },
            },
            required: ['method', 'url'],
          },
          response: {
            type: 'object',
            properties: {
              statusCode: {
                type: 'number',
              },
            },
            required: ['statusCode'],
          },
        },
        required: ['error', 'response'],
        additionalProperties: {},
      },
    },
    securitySchemes: {
      JWT: {
        type: 'http',
        scheme: 'bearer',
        bearerFormat: 'JWT',
      },
    },
  },
  paths: {
    '/remotes': {
      get: {
        operationId: 'GetRemotes',
        description: 'Get the Module Federation remote definitions.',
        responses: {
          '200': {
            $ref: '#/components/responses/RemotesResponse',
          },
          '400': {
            $ref: '#/components/responses/ErrorResponse',
          },
          default: {
            $ref: '#/components/responses/ErrorResponse',
          },
        },
        security: [
          {},
          {
            JWT: [],
          },
        ],
        parameters: [],
      },
    },
  },
} as const;
export const createOpenApiRouter = async (
  options?: Parameters<
    typeof createValidatedOpenApiRouterFromGeneratedEndpointMap
  >['1'],
) =>
  createValidatedOpenApiRouterFromGeneratedEndpointMap<EndpointMap>(
    spec,
    options,
  );
