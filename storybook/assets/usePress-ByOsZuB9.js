import{D as fe,i as y,E as Te,g as Ee,b as L,m as me,n as he,l as b,k as p,F as ke,G as Se,H as xe,I as ee,J as we,K as Ke,A as Ce,B as te}from"./useFocusable-BwFERnd_.js";import{R as _e,r as d}from"./iframe-M9O-K8SB.js";import{b as re,f as Ie,$ as ce}from"./useObjectRef-BPFp5snO.js";function Ue(r,s){if(s.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Me(r,s,i){Ue(r,s),s.set(r,i)}let w="default",V="",A=new WeakMap;function Le(r){if(fe()){if(w==="default"){const s=y(r);V=s.documentElement.style.webkitUserSelect,s.documentElement.style.webkitUserSelect="none"}w="disabled"}else if(r instanceof HTMLElement||r instanceof SVGElement){let s="userSelect"in r.style?"userSelect":"webkitUserSelect";A.set(r,r.style[s]),r.style[s]="none"}}function se(r){if(fe()){if(w!=="disabled")return;w="restoring",setTimeout(()=>{Te(()=>{if(w==="restoring"){const s=y(r);s.documentElement.style.webkitUserSelect==="none"&&(s.documentElement.style.webkitUserSelect=V||""),V="",w="default"}})},300)}else if((r instanceof HTMLElement||r instanceof SVGElement)&&r&&A.has(r)){let s=A.get(r),i="userSelect"in r.style?"userSelect":"webkitUserSelect";r.style[i]==="none"&&(r.style[i]=s),r.getAttribute("style")===""&&r.removeAttribute("style"),A.delete(r)}}const ue=_e.createContext({register:()=>{}});ue.displayName="PressResponderContext";function Oe(r,s){return s.get?s.get.call(r):s.value}function de(r,s,i){if(!s.has(r))throw new TypeError("attempted to "+i+" private field on non-instance");return s.get(r)}function De(r,s){var i=de(r,s,"get");return Oe(r,i)}function Ae(r,s,i){if(s.set)s.set.call(r,i);else{if(!s.writable)throw new TypeError("attempted to set read only private field");s.value=i}}function ne(r,s,i){var f=de(r,s,"set");return Ae(r,f,i),i}function He(r){let s=d.useContext(ue);if(s){let{register:i,...f}=s;r=ce(f,r),i()}return xe(s,r.ref),r}var O=new WeakMap;class D{continuePropagation(){ne(this,O,!1)}get shouldStopPropagation(){return De(this,O)}constructor(s,i,f,u){Me(this,O,{writable:!0,value:void 0}),ne(this,O,!0);var $;let v=($=u?.target)!==null&&$!==void 0?$:f.currentTarget;const c=v?.getBoundingClientRect();let K,h=0,k,g=null;f.clientX!=null&&f.clientY!=null&&(k=f.clientX,g=f.clientY),c&&(k!=null&&g!=null?(K=k-c.left,h=g-c.top):(K=c.width/2,h=c.height/2)),this.type=s,this.pointerType=i,this.target=f.currentTarget,this.shiftKey=f.shiftKey,this.metaKey=f.metaKey,this.ctrlKey=f.ctrlKey,this.altKey=f.altKey,this.x=K,this.y=h}}const ae=Symbol("linkClicked"),ie="react-aria-pressable-style",le="data-react-aria-pressable";function Xe(r){let{onPress:s,onPressChange:i,onPressStart:f,onPressEnd:u,onPressUp:$,onClick:v,isDisabled:c,isPressed:K,preventFocusOnPress:h,shouldCancelOnPointerExit:k,allowTextSelectionOnPress:g,ref:H,...ve}=He(r),[$e,N]=d.useState(!1),P=d.useRef({isPressed:!1,ignoreEmulatedMouseEvents:!1,didFirePressStart:!1,isTriggeringEvent:!1,activePointerId:null,target:null,isOverTarget:!1,pointerType:null,disposables:[]}),{addGlobalListener:S,removeAllGlobalListeners:C,removeGlobalListener:_}=Ee(),I=d.useCallback((e,n)=>{let t=P.current;if(c||t.didFirePressStart)return!1;let a=!0;if(t.isTriggeringEvent=!0,f){let o=new D("pressstart",n,e);f(o),a=o.shouldStopPropagation}return i&&i(!0),t.isTriggeringEvent=!1,t.didFirePressStart=!0,N(!0),a},[c,f,i]),T=d.useCallback((e,n,t=!0)=>{let a=P.current;if(!a.didFirePressStart)return!1;a.didFirePressStart=!1,a.isTriggeringEvent=!0;let o=!0;if(u){let l=new D("pressend",n,e);u(l),o=l.shouldStopPropagation}if(i&&i(!1),N(!1),s&&t&&!c){let l=new D("press",n,e);s(l),o&&(o=l.shouldStopPropagation)}return a.isTriggeringEvent=!1,o},[c,u,i,s]),ge=L(T),U=d.useCallback((e,n)=>{let t=P.current;if(c)return!1;if($){t.isTriggeringEvent=!0;let a=new D("pressup",n,e);return $(a),t.isTriggeringEvent=!1,a.shouldStopPropagation}return!0},[c,$]),be=L(U),x=d.useCallback(e=>{let n=P.current;if(n.isPressed&&n.target){n.didFirePressStart&&n.pointerType!=null&&T(m(n.target,e),n.pointerType,!1),n.isPressed=!1,Z(null),n.isOverTarget=!1,n.activePointerId=null,n.pointerType=null,C(),g||se(n.target);for(let t of n.disposables)t();n.disposables=[]}},[g,C,T]),R=L(x),j=d.useCallback(e=>{k&&x(e)},[k,x]),F=d.useCallback(e=>{c||v?.(e)},[c,v]),W=d.useCallback((e,n)=>{if(!c&&v){let t=new MouseEvent("click",e);me(t,n),v(he(t))}},[c,v]),ye=L(W),[J,q]=d.useState(!1);re(()=>{let e=P.current;if(J){let n=l=>{var E;if(e.isPressed&&e.target&&X(l,e.target)){var B;oe(p(l),l.key)&&l.preventDefault();let Y=p(l),M=b(e.target,p(l));ge(m(e.target,l),"keyboard",M),M&&ye(l,e.target),C(),l.key!=="Enter"&&z(e.target)&&b(e.target,Y)&&!l[ae]&&(l[ae]=!0,ee(e.target,l,!1)),e.isPressed=!1,q(!1),(B=e.metaKeyEvents)===null||B===void 0||B.delete(l.key)}else if(l.key==="Meta"&&(!((E=e.metaKeyEvents)===null||E===void 0)&&E.size)){var G;let Y=e.metaKeyEvents;e.metaKeyEvents=void 0;for(let M of Y.values())(G=e.target)===null||G===void 0||G.dispatchEvent(new KeyboardEvent("keyup",M))}},t=e.target,o=Ie(l=>{t&&X(l,t)&&!l.repeat&&b(t,p(l))&&e.target&&be(m(e.target,l),"keyboard")},n);return S(y(e.target),"keyup",o,!0),()=>{_(y(e.target),"keyup",o,!0)}}},[J,S,C,_]);let[Q,Z]=d.useState(null);re(()=>{let e=P.current;if(Q==="pointer"){let n=a=>{if(a.pointerId===e.activePointerId&&e.isPressed&&a.button===0&&e.target){if(b(e.target,p(a))&&e.pointerType!=null){let o=!1,l=setTimeout(()=>{e.isPressed&&e.target instanceof HTMLElement&&(o?R(a):(we(e.target),e.target.click()))},80);S(a.currentTarget,"click",()=>o=!0,!0),e.disposables.push(()=>clearTimeout(l))}else R(a);e.isOverTarget=!1}},t=a=>{R(a)};return S(y(e.target),"pointerup",n,!1),S(y(e.target),"pointercancel",t,!1),()=>{_(y(e.target),"pointerup",n,!1),_(y(e.target),"pointercancel",t,!1)}}},[Q,S,_]);let Pe=d.useMemo(()=>{let e=P.current,n={onKeyDown(t){if(X(t.nativeEvent,t.currentTarget)&&b(t.currentTarget,p(t.nativeEvent))){var a;oe(p(t.nativeEvent),t.key)&&t.preventDefault();let o=!0;!e.isPressed&&!t.repeat&&(e.target=t.currentTarget,e.isPressed=!0,q(!0),e.pointerType="keyboard",o=I(t,"keyboard")),o&&t.stopPropagation(),t.metaKey&&Ce()&&((a=e.metaKeyEvents)===null||a===void 0||a.set(t.key,t.nativeEvent))}else t.key==="Meta"&&(e.metaKeyEvents=new Map)},onClick(t){if(!(t&&!b(t.currentTarget,p(t.nativeEvent)))&&t&&t.button===0&&!e.isTriggeringEvent&&!ee.isOpening){let a=!0;if(c&&t.preventDefault(),!e.ignoreEmulatedMouseEvents&&!e.isPressed&&(e.pointerType==="virtual"||Ke(t.nativeEvent))){let o=I(t,"virtual"),l=U(t,"virtual"),E=T(t,"virtual");F(t),a=o&&l&&E}else if(e.isPressed&&e.pointerType!=="keyboard"){let o=e.pointerType||t.nativeEvent.pointerType||"virtual",l=U(m(t.currentTarget,t),o),E=T(m(t.currentTarget,t),o,!0);a=l&&E,e.isOverTarget=!1,F(t),x(t)}e.ignoreEmulatedMouseEvents=!1,a&&t.stopPropagation()}}};return typeof PointerEvent<"u"&&(n.onPointerDown=t=>{if(t.button!==0||!b(t.currentTarget,p(t.nativeEvent)))return;if(ke(t.nativeEvent)){e.pointerType="virtual";return}e.pointerType=t.pointerType;let a=!0;if(!e.isPressed){e.isPressed=!0,Z("pointer"),e.isOverTarget=!0,e.activePointerId=t.pointerId,e.target=t.currentTarget,g||Le(e.target),a=I(t,e.pointerType);let o=p(t.nativeEvent);"releasePointerCapture"in o&&o.releasePointerCapture(t.pointerId)}a&&t.stopPropagation()},n.onMouseDown=t=>{if(b(t.currentTarget,p(t.nativeEvent))&&t.button===0){if(h){let a=Se(t.target);a&&e.disposables.push(a)}t.stopPropagation()}},n.onPointerUp=t=>{!b(t.currentTarget,p(t.nativeEvent))||e.pointerType==="virtual"||t.button===0&&!e.isPressed&&U(t,e.pointerType||t.pointerType)},n.onPointerEnter=t=>{t.pointerId===e.activePointerId&&e.target&&!e.isOverTarget&&e.pointerType!=null&&(e.isOverTarget=!0,I(m(e.target,t),e.pointerType))},n.onPointerLeave=t=>{t.pointerId===e.activePointerId&&e.target&&e.isOverTarget&&e.pointerType!=null&&(e.isOverTarget=!1,T(m(e.target,t),e.pointerType,!1),j(t))},n.onDragStart=t=>{b(t.currentTarget,p(t.nativeEvent))&&x(t)}),n},[c,h,C,g,x,j,T,I,U,F,W]);return d.useEffect(()=>{if(!H)return;const e=y(H.current);if(!e||!e.head||e.getElementById(ie))return;const n=e.createElement("style");n.id=ie,n.textContent=`
@layer {
  [${le}] {
    touch-action: pan-x pan-y pinch-zoom;
  }
}
    `.trim(),e.head.prepend(n)},[H]),d.useEffect(()=>{let e=P.current;return()=>{var n;g||se((n=e.target)!==null&&n!==void 0?n:void 0);for(let t of e.disposables)t();e.disposables=[]}},[g]),{isPressed:K||$e,pressProps:ce(ve,Pe,{[le]:!0})}}function z(r){return r.tagName==="A"&&r.hasAttribute("href")}function X(r,s){const{key:i,code:f}=r,u=s,$=u.getAttribute("role");return(i==="Enter"||i===" "||i==="Spacebar"||f==="Space")&&!(u instanceof te(u).HTMLInputElement&&!pe(u,i)||u instanceof te(u).HTMLTextAreaElement||u.isContentEditable)&&!(($==="link"||!$&&z(u))&&i!=="Enter")}function m(r,s){let i=s.clientX,f=s.clientY;return{currentTarget:r,shiftKey:s.shiftKey,ctrlKey:s.ctrlKey,metaKey:s.metaKey,altKey:s.altKey,clientX:i,clientY:f}}function Re(r){return r instanceof HTMLInputElement?!1:r instanceof HTMLButtonElement?r.type!=="submit"&&r.type!=="reset":!z(r)}function oe(r,s){return r instanceof HTMLInputElement?!pe(r,s):Re(r)}const Fe=new Set(["checkbox","radio","range","color","file","image","button","submit","reset"]);function pe(r,s){return r.type==="checkbox"||r.type==="radio"?s===" ":Fe.has(r.type)}export{Xe as $,ue as a};
