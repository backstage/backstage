import{r as y}from"./iframe-M9O-K8SB.js";import{$ as x,a as m,b as M}from"./SelectionManager-AOhnTTKk.js";function z(i){const t=y.version.split(".");return parseInt(t[0],10)>=19?i:i?"true":void 0}class ${*[Symbol.iterator](){yield*this.iterable}get size(){return this._size}getKeys(){return this.keyMap.keys()}getKeyBefore(t){let e=this.keyMap.get(t);var l;return e&&(l=e.prevKey)!==null&&l!==void 0?l:null}getKeyAfter(t){let e=this.keyMap.get(t);var l;return e&&(l=e.nextKey)!==null&&l!==void 0?l:null}getFirstKey(){return this.firstKey}getLastKey(){return this.lastKey}getItem(t){var e;return(e=this.keyMap.get(t))!==null&&e!==void 0?e:null}at(t){const e=[...this.getKeys()];return this.getItem(e[t])}getChildren(t){let e=this.keyMap.get(t);return e?.childNodes||[]}constructor(t){this.keyMap=new Map,this.firstKey=null,this.lastKey=null,this.iterable=t;let e=n=>{if(this.keyMap.set(n.key,n),n.childNodes&&n.type==="section")for(let o of n.childNodes)e(o)};for(let n of t)e(n);let l=null,f=0,a=0;for(let[n,o]of this.keyMap)l?(l.nextKey=n,o.prevKey=l.key):(this.firstKey=n,o.prevKey=void 0),o.type==="item"&&(o.index=f++),(o.type==="section"||o.type==="item")&&a++,l=o,l.nextKey=void 0;this._size=a;var u;this.lastKey=(u=l?.key)!==null&&u!==void 0?u:null}}function C(i){let{filter:t,layoutDelegate:e}=i,l=x(i),f=y.useMemo(()=>i.disabledKeys?new Set(i.disabledKeys):new Set,[i.disabledKeys]),a=y.useCallback(K=>t?new $(t(K)):new $(K),[t]),u=y.useMemo(()=>({suppressTextValueWarning:i.suppressTextValueWarning}),[i.suppressTextValueWarning]),n=m(i,a,u),o=y.useMemo(()=>new M(n,l,{layoutDelegate:e}),[n,l,e]);return k(n,o),{collection:n,disabledKeys:f,selectionManager:o}}function D(i,t){let e=y.useMemo(()=>t?i.collection.filter(t):i.collection,[i.collection,t]),l=i.selectionManager.withCollection(e);return k(e,l),{collection:e,selectionManager:l,disabledKeys:i.disabledKeys}}function k(i,t){const e=y.useRef(null);y.useEffect(()=>{if(t.focusedKey!=null&&!i.getItem(t.focusedKey)&&e.current){const s=e.current.getItem(t.focusedKey),h=[...e.current.getKeys()].map(v=>{const d=e.current.getItem(v);return d?.type==="item"?d:null}).filter(v=>v!==null),r=[...i.getKeys()].map(v=>{const d=i.getItem(v);return d?.type==="item"?d:null}).filter(v=>v!==null);var l,f;const p=((l=h?.length)!==null&&l!==void 0?l:0)-((f=r?.length)!==null&&f!==void 0?f:0);var a,u,n;let c=Math.min(p>1?Math.max(((a=s?.index)!==null&&a!==void 0?a:0)-p+1,0):(u=s?.index)!==null&&u!==void 0?u:0,((n=r?.length)!==null&&n!==void 0?n:0)-1),b=null,g=!1;for(;c>=0;){if(!t.isDisabled(r[c].key)){b=r[c];break}if(c<r.length-1&&!g)c++;else{g=!0;var o,K;c>((o=s?.index)!==null&&o!==void 0?o:0)&&(c=(K=s?.index)!==null&&K!==void 0?K:0),c--}}t.setFocusedKey(b?b.key:null)}e.current=i},[i,t])}export{D as $,C as a,z as b};
