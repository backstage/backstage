import{r as y,a2 as I,F as K,j as h}from"./iframe-C6d4amxQ.js";import{$ as Q,a as Z}from"./Autocomplete-DyGgdXUs.js";import{$ as ee}from"./Button-Db10oUVx.js";import{j as me,$ as j,e as ye,k as te,l as D,m as ge,n as ve}from"./Dialog-CLeSea7S.js";import{g as be,h as xe}from"./Separator-C63ITacS.js";import{$ as ie}from"./Input-kR8vcD5w.js";import{$ as se,a as we}from"./ListBox-BUeOu6oj.js";import{$ as le}from"./SearchField-Q1BtC_ZW.js";import{o as X,j as Ie,t as $e}from"./SelectionManager-eLTem7lJ.js";import{a as Re,d as Y}from"./useObjectRef-B5GZXDW0.js";import{$ as ne}from"./context-C-z2U1Y6.js";import{g as Se}from"./OverlayArrow-DHK2vGPK.js";import{$ as _e}from"./useEvent-Bz8QKwmM.js";import{u as R}from"./useStyles-C22yXYNB.js";import{s as Me,A as oe,r as U}from"./index-CYxMMw0t.js";import{i as ze}from"./isExternalLink-DzQTpl4p.js";import{c as f}from"./clsx-B-dksMZM.js";import{c as re,f as ae}from"./index-Bwu9Fyg1.js";import{d as ce}from"./usePress-C8yhIAMV.js";class Ne{shouldInvalidate(e,t){return e.width!==t.width||e.height!==t.height}shouldInvalidateLayoutOptions(e,t){return e!==t}update(e){}getItemRect(e){var t,i;return(i=(t=this.getLayoutInfo(e))===null||t===void 0?void 0:t.rect)!==null&&i!==void 0?i:null}getVisibleRect(){return this.virtualizer.visibleRect}constructor(){this.virtualizer=null}}class _{copy(){let e=new _(this.type,this.key,this.rect.copy());return e.estimatedSize=this.estimatedSize,e.opacity=this.opacity,e.transform=this.transform,e.parentKey=this.parentKey,e.content=this.content,e.isSticky=this.isSticky,e.zIndex=this.zIndex,e.allowOverflow=this.allowOverflow,e}constructor(e,t,i){this.type=e,this.key=t,this.parentKey=null,this.content=null,this.rect=i,this.estimatedSize=!1,this.isSticky=!1,this.opacity=1,this.transform=null,this.zIndex=0,this.allowOverflow=!1}}class M{copy(){return new M(this.x,this.y)}equals(e){return this.x===e.x&&this.y===e.y}isOrigin(){return this.x===0&&this.y===0}constructor(e=0,t=0){this.x=e,this.y=t}}class g{get maxX(){return this.x+this.width}get maxY(){return this.y+this.height}get area(){return this.width*this.height}get topLeft(){return new M(this.x,this.y)}get topRight(){return new M(this.maxX,this.y)}get bottomLeft(){return new M(this.x,this.maxY)}get bottomRight(){return new M(this.maxX,this.maxY)}intersects(e){return this.area>0&&e.area>0&&this.x<=e.x+e.width&&e.x<=this.x+this.width&&this.y<=e.y+e.height&&e.y<=this.y+this.height}containsRect(e){return this.x<=e.x&&this.y<=e.y&&this.maxX>=e.maxX&&this.maxY>=e.maxY}containsPoint(e){return this.x<=e.x&&this.y<=e.y&&this.maxX>=e.x&&this.maxY>=e.y}getCornerInRect(e){for(let t of["topLeft","topRight","bottomLeft","bottomRight"])if(e.containsPoint(this[t]))return t;return null}equals(e){return e.x===this.x&&e.y===this.y&&e.width===this.width&&e.height===this.height}pointEquals(e){return this.x===e.x&&this.y===e.y}sizeEquals(e){return this.width===e.width&&this.height===e.height}union(e){let t=Math.min(this.x,e.x),i=Math.min(this.y,e.y),s=Math.max(this.maxX,e.maxX)-t,l=Math.max(this.maxY,e.maxY)-i;return new g(t,i,s,l)}intersection(e){if(!this.intersects(e))return new g(0,0,0,0);let t=Math.max(this.x,e.x),i=Math.max(this.y,e.y);return new g(t,i,Math.min(this.maxX,e.maxX)-t,Math.min(this.maxY,e.maxY)-i)}copy(){return new g(this.x,this.y,this.width,this.height)}constructor(e=0,t=0,i=0,s=0){this.x=e,this.y=t,this.width=i,this.height=s}}class k{copy(){return new k(this.width,this.height)}equals(e){return this.width===e.width&&this.height===e.height}get area(){return this.width*this.height}constructor(e=0,t=0){this.width=Math.max(e,0),this.height=Math.max(t,0)}}let Ce=0;class de{prepareForReuse(){this.content=null,this.rendered=null,this.layoutInfo=null}getReusableView(e){let t=this.reusableViews.get(e);return t&&t.length>0?t.shift():new ke(this.virtualizer,this,e)}reuseChild(e){e.prepareForReuse();let t=this.reusableViews.get(e.viewType);t||(t=[],this.reusableViews.set(e.viewType,t)),t.push(e)}constructor(e,t){this.virtualizer=e,this.key=++Ce,this.viewType=t,this.children=new Set,this.reusableViews=new Map,this.layoutInfo=null,this.content=null,this.rendered=null}}class He extends de{constructor(e){super(e,"root")}}class ke extends de{constructor(e,t,i){super(e,i),this.parent=t}}function Le(n,e){if(n===e)return!0;if(n.size!==e.size)return!1;for(let t of n)if(!e.has(t))return!1;return!0}class Te{setVisibleRect(e){let t=performance.now()-this.startTime;t<500&&(e.x!==this.visibleRect.x&&t>0&&(this.velocity.x=(e.x-this.visibleRect.x)/t),e.y!==this.visibleRect.y&&t>0&&(this.velocity.y=(e.y-this.visibleRect.y)/t)),this.startTime=performance.now(),this.visibleRect=e}getOverscannedRect(){let e=this.visibleRect.copy(),t=this.visibleRect.height/3;if(e.height+=t,this.velocity.y<0&&(e.y-=t),this.velocity.x!==0){let i=this.visibleRect.width/3;e.width+=i,this.velocity.x<0&&(e.x-=i)}return e}constructor(){this.startTime=0,this.velocity=new M(0,0),this.visibleRect=new g}}class Pe{isPersistedKey(e){if(this.persistedKeys.has(e))return!0;for(let t of this.persistedKeys)for(;t!=null;){let i=this.layout.getLayoutInfo(t);if(!i||i.parentKey==null)break;if(t=i.parentKey,t===e)return!0}return!1}getParentView(e){return e.parentKey!=null?this._visibleViews.get(e.parentKey):this._rootView}getReusableView(e){let i=this.getParentView(e).getReusableView(e.type);return i.layoutInfo=e,this._renderView(i),i}_renderView(e){if(e.layoutInfo){let{type:t,key:i,content:s}=e.layoutInfo;e.content=s||this.collection.getItem(i),e.rendered=this._renderContent(t,e.content)}}_renderContent(e,t){let i=t!=null?this._renderedContent.get(t):null;if(i!=null)return i;let s=this.delegate.renderView(e,t);return t&&this._renderedContent.set(t,s),s}keyAtPoint(e){let t=new g(e.x,e.y,1,1),i=t.area===0?[]:this.layout.getVisibleLayoutInfos(t);for(let s of i)if(s.rect.intersects(t))return s.key;return null}relayout(e={}){this.layout.update(e),this.contentSize=this.layout.getContentSize();let t=this.visibleRect,i=e.contentChanged?0:t.x,s=e.contentChanged?0:t.y;if(i=Math.max(0,Math.min(this.contentSize.width-t.width,i)),s=Math.max(0,Math.min(this.contentSize.height-t.height,s)),i!==t.x||s!==t.y){let l=new g(i,s,t.width,t.height);this.delegate.setVisibleRect(l)}else this.updateSubviews()}getVisibleLayoutInfos(){let e;e=this._overscanManager.getOverscannedRect();let t=this.layout.getVisibleLayoutInfos(e),i=new Map;for(let s of t)i.set(s.key,s);return i}updateSubviews(){let e=this.getVisibleLayoutInfos(),t=new Set;for(let[i,s]of this._visibleViews){let l=e.get(i);(!l||s.parent!==this.getParentView(l))&&(this._visibleViews.delete(i),s.parent.reuseChild(s),t.add(s))}for(let[i,s]of e){let l=this._visibleViews.get(i);if(!l)l=this.getReusableView(s),l.parent.children.add(l),this._visibleViews.set(i,l),t.delete(l);else{l.layoutInfo=s;let o=this.collection.getItem(s.key);l.content!==o&&(l.content!=null&&this._renderedContent.delete(l.content),this._renderView(l))}}for(let i of t)i.parent.children.delete(i),i.parent.reusableViews.clear();if(!this._isScrolling)for(let i of e.keys()){let s=this._visibleViews.get(i);s.parent.children.delete(s),s.parent.children.add(s)}}render(e){let t=this,i=!1,s=!1,l=!1,o=!1,a=!1,c=!1;return e.collection!==this.collection&&(t.collection=e.collection,i=!0),(e.layout!==this.layout||this.layout.virtualizer!==this)&&(this.layout&&(this.layout.virtualizer=null),e.layout.virtualizer=this,t.layout=e.layout,i=!0),e.persistedKeys&&!Le(e.persistedKeys,this.persistedKeys)&&(t.persistedKeys=e.persistedKeys,c=!0),this.visibleRect.equals(e.visibleRect)||(this._overscanManager.setVisibleRect(e.visibleRect),this.layout.shouldInvalidate(e.visibleRect,this.visibleRect)?(s=!e.visibleRect.pointEquals(this.visibleRect),l=!e.visibleRect.sizeEquals(this.visibleRect),i=!0):c=!0,t.visibleRect=e.visibleRect),e.invalidationContext!==this._invalidationContext&&(e.invalidationContext&&(l||(l=e.invalidationContext.sizeChanged||!1),s||(s=e.invalidationContext.offsetChanged||!1),o||(o=e.invalidationContext.itemSizeChanged||!1),a||(a=e.invalidationContext.layoutOptions!=null&&this._invalidationContext.layoutOptions!=null&&e.invalidationContext.layoutOptions!==this._invalidationContext.layoutOptions&&this.layout.shouldInvalidateLayoutOptions(e.invalidationContext.layoutOptions,this._invalidationContext.layoutOptions)),i||(i=o||l||s||a)),this._invalidationContext=e.invalidationContext),e.isScrolling!==this._isScrolling&&(this._isScrolling=e.isScrolling,e.isScrolling||(c=!0)),i?this.relayout({offsetChanged:s,sizeChanged:l,itemSizeChanged:o,layoutOptionsChanged:a,layoutOptions:this._invalidationContext.layoutOptions}):c&&this.updateSubviews(),Array.from(this._rootView.children)}getVisibleView(e){return this._visibleViews.get(e)}invalidate(e){this.delegate.invalidate(e)}updateItemSize(e,t){if(!this.layout.updateItemSize)return;this.layout.updateItemSize(e,t)&&this.invalidate({itemSizeChanged:!0})}constructor(e){this.delegate=e.delegate,this.collection=e.collection,this.layout=e.layout,this.contentSize=new k,this.visibleRect=new g,this.persistedKeys=new Set,this._visibleViews=new Map,this._renderedContent=new WeakMap,this._rootView=new He(this),this._isScrolling=!1,this._invalidationContext={},this._overscanManager=new Te}}const je=typeof document<"u"?I.useLayoutEffect:()=>{};function Ee(n){let[e,t]=y.useState(new g(0,0,0,0)),[i,s]=y.useState(!1),[l,o]=y.useState({}),a=y.useRef(!1),[c]=y.useState(()=>new Pe({collection:n.collection,layout:n.layout,delegate:{setVisibleRect(x){t(x),a.current=!0},renderView:n.renderView,invalidate:o}}));je(()=>{a.current&&(a.current=!1,n.onVisibleRectChange(e))});let r=y.useMemo(()=>n.layoutOptions!=null?{...l,layoutOptions:n.layoutOptions}:l,[l,n.layoutOptions]),d=c.render({layout:n.layout,collection:n.collection,persistedKeys:n.persistedKeys,layoutOptions:n.layoutOptions,visibleRect:e,invalidationContext:r,isScrolling:i}),u=c.contentSize,p=y.useCallback(()=>{s(!0)},[]),v=y.useCallback(()=>{s(!1)},[]);return y.useMemo(()=>({virtualizer:c,visibleViews:d,setVisibleRect:t,contentSize:u,isScrolling:i,startScrolling:p,endScrolling:v}),[c,d,t,u,i,p,v])}const C=48;class E extends Ne{get collection(){return this.virtualizer.collection}getLayoutInfo(e){var t;return this.ensureLayoutInfo(e),((t=this.layoutNodes.get(e))===null||t===void 0?void 0:t.layoutInfo)||null}getVisibleLayoutInfos(e){if(e.height>1){var t,i;let o=((i=(t=this.rowHeight)!==null&&t!==void 0?t:this.estimatedRowHeight)!==null&&i!==void 0?i:C)+this.gap;e.y=Math.floor(e.y/o)*o,e.height=Math.ceil(e.height/o)*o}this.layoutIfNeeded(e);let s=[],l=o=>{for(let a of o)this.isVisible(a,e)&&(s.push(a.layoutInfo),a.children&&l(a.children))};return l(this.rootNodes),s}layoutIfNeeded(e){if(this.lastCollection){this.requestedRect.containsRect(e)||(this.requestedRect=this.requestedRect.union(e),this.rootNodes=this.buildCollection());for(let t of this.virtualizer.persistedKeys)if(this.ensureLayoutInfo(t))return}}ensureLayoutInfo(e){return!this.layoutNodes.has(e)&&this.requestedRect.area<this.contentSize.area&&this.lastCollection?(this.requestedRect=new g(0,0,1/0,1/0),this.rootNodes=this.buildCollection(),this.requestedRect=new g(0,0,this.contentSize.width,this.contentSize.height),!0):!1}isVisible(e,t){return e.layoutInfo.rect.intersects(t)||e.layoutInfo.isSticky||e.layoutInfo.type==="header"||e.layoutInfo.type==="loader"||this.virtualizer.isPersistedKey(e.layoutInfo.key)}shouldInvalidateEverything(e){let t=e.layoutOptions;var i,s,l,o,a;return e.sizeChanged||this.rowHeight!==((i=t?.rowHeight)!==null&&i!==void 0?i:this.rowHeight)||this.headingHeight!==((s=t?.headingHeight)!==null&&s!==void 0?s:this.headingHeight)||this.loaderHeight!==((l=t?.loaderHeight)!==null&&l!==void 0?l:this.loaderHeight)||this.gap!==((o=t?.gap)!==null&&o!==void 0?o:this.gap)||this.padding!==((a=t?.padding)!==null&&a!==void 0?a:this.padding)}shouldInvalidateLayoutOptions(e,t){return e.rowHeight!==t.rowHeight||e.estimatedRowHeight!==t.estimatedRowHeight||e.headingHeight!==t.headingHeight||e.estimatedHeadingHeight!==t.estimatedHeadingHeight||e.loaderHeight!==t.loaderHeight||e.dropIndicatorThickness!==t.dropIndicatorThickness||e.gap!==t.gap||e.padding!==t.padding}update(e){let t=this.virtualizer.collection;this.invalidateEverything=this.shouldInvalidateEverything(e),this.invalidateEverything&&(this.requestedRect=this.virtualizer.visibleRect.copy(),this.layoutNodes.clear());let i=e.layoutOptions;var s;this.rowHeight=(s=i?.rowHeight)!==null&&s!==void 0?s:this.rowHeight;var l;this.estimatedRowHeight=(l=i?.estimatedRowHeight)!==null&&l!==void 0?l:this.estimatedRowHeight;var o;this.headingHeight=(o=i?.headingHeight)!==null&&o!==void 0?o:this.headingHeight;var a;this.estimatedHeadingHeight=(a=i?.estimatedHeadingHeight)!==null&&a!==void 0?a:this.estimatedHeadingHeight;var c;this.loaderHeight=(c=i?.loaderHeight)!==null&&c!==void 0?c:this.loaderHeight;var r;this.dropIndicatorThickness=(r=i?.dropIndicatorThickness)!==null&&r!==void 0?r:this.dropIndicatorThickness;var d;this.gap=(d=i?.gap)!==null&&d!==void 0?d:this.gap;var u;if(this.padding=(u=i?.padding)!==null&&u!==void 0?u:this.padding,this.rootNodes=this.buildCollection(),this.lastCollection&&t!==this.lastCollection)for(let p of this.lastCollection.getKeys())t.getItem(p)||this.layoutNodes.get(p)&&this.layoutNodes.delete(p);this.lastCollection=t,this.invalidateEverything=!1,this.validRect=this.requestedRect.copy()}buildCollection(e=this.padding){let t=this.virtualizer.collection,i=[...t],s=i.filter(r=>r.type==="loader"),l=[],o=t?.size===0;o&&(e=0);for(let r of i){var a,c;let d=((c=(a=this.rowHeight)!==null&&a!==void 0?a:this.estimatedRowHeight)!==null&&c!==void 0?c:C)+this.gap;if(r.type==="item"&&e+d<this.requestedRect.y&&!this.isValid(r,e)){e+=d;continue}let u=this.buildChild(r,this.padding,e,null);if(e=u.layoutInfo.rect.maxY+this.gap,l.push(u),r.type==="loader"){let p=s.indexOf(r);s.splice(p,1)}if((r.type==="item"||r.type==="loader")&&e>this.requestedRect.maxY){let p=i.indexOf(r);for(let v of s){let b=i.indexOf(v);e+=(b-p-1)*d;let x=this.buildChild(v,this.padding,e,null);l.push(x),e=x.layoutInfo.rect.maxY,p=b}e+=(i.length-p-1)*d;break}}return e-=this.gap,e+=o?0:this.padding,this.contentSize=new k(this.virtualizer.visibleRect.width,e),l}isValid(e,t){let i=this.layoutNodes.get(e.key);return!this.invalidateEverything&&!!i&&i.node===e&&t===i.layoutInfo.rect.y&&i.layoutInfo.rect.intersects(this.validRect)&&i.validRect.containsRect(i.layoutInfo.rect.intersection(this.requestedRect))}buildChild(e,t,i,s){if(this.isValid(e,i))return this.layoutNodes.get(e.key);let l=this.buildNode(e,t,i);return l.layoutInfo.parentKey=s??null,l.layoutInfo.allowOverflow=!0,this.layoutNodes.set(e.key,l),l}buildNode(e,t,i){switch(e.type){case"section":return this.buildSection(e,t,i);case"item":return this.buildItem(e,t,i);case"header":return this.buildSectionHeader(e,t,i);case"loader":return this.buildLoader(e,t,i);case"separator":return this.buildItem(e,t,i);default:throw new Error("Unsupported node type: "+e.type)}}buildLoader(e,t,i){let s=new g(t,i,this.padding,0),l=new _("loader",e.key,s);s.width=this.virtualizer.contentSize.width-this.padding-t;var o,a,c;return s.height=e.props.isLoading?(c=(a=(o=this.loaderHeight)!==null&&o!==void 0?o:this.rowHeight)!==null&&a!==void 0?a:this.estimatedRowHeight)!==null&&c!==void 0?c:C:0,{layoutInfo:l,validRect:s.intersection(this.requestedRect)}}buildSection(e,t,i){let s=this.virtualizer.collection,l=this.virtualizer.visibleRect.width-this.padding,o=new g(t,i,l-t,0),a=new _(e.type,e.key,o),c=i,r=0,d=[];for(let v of X(e,s)){var u,p;let b=((p=(u=this.rowHeight)!==null&&u!==void 0?u:this.estimatedRowHeight)!==null&&p!==void 0?p:C)+this.gap;if(i+b<this.requestedRect.y&&!this.isValid(e,i)){i+=b,r++;continue}let x=this.buildChild(v,t,i,a.key);if(i=x.layoutInfo.rect.maxY+this.gap,d.push(x),i>this.requestedRect.maxY){i+=([...X(e,s)].length-(d.length+r))*b;break}}return i-=this.gap,o.height=i-c,{layoutInfo:a,children:d,validRect:a.rect.intersection(this.requestedRect),node:e}}buildSectionHeader(e,t,i){let s=this.virtualizer.visibleRect.width-this.padding,l=this.headingHeight,o=!1;if(l==null){let r=this.layoutNodes.get(e.key),d=r?.layoutInfo;if(d){let u=this.virtualizer.collection.getItem(e.key),p=this.lastCollection?this.lastCollection.getItem(e.key):null;l=d.rect.height,o=s!==d.rect.width||u!==p||d.estimatedSize}else l=e.rendered?this.estimatedHeadingHeight:0,o=!0}l==null&&(l=C);let a=new g(t,i,s-t,l),c=new _("header",e.key,a);return c.estimatedSize=o,{layoutInfo:c,children:[],validRect:c.rect.intersection(this.requestedRect),node:e}}buildItem(e,t,i){let s=this.virtualizer.visibleRect.width-this.padding-t,l=this.rowHeight,o=!1;if(l==null){let r=this.layoutNodes.get(e.key);r?(l=r.layoutInfo.rect.height,o=s!==r.layoutInfo.rect.width||e!==r.node||r.layoutInfo.estimatedSize):(l=this.estimatedRowHeight,o=!0)}l==null&&(l=C);let a=new g(t,i,s,l),c=new _(e.type,e.key,a);return c.estimatedSize=o,{layoutInfo:c,children:[],validRect:c.rect,node:e}}updateItemSize(e,t){let i=this.layoutNodes.get(e);if(!i)return!1;let s=this.virtualizer.collection,l=i.layoutInfo;if(l.estimatedSize=!1,l.rect.height!==t.height){let o=l.copy();o.rect.height=t.height,i.layoutInfo=o,this.validRect.height=Math.min(this.validRect.height,l.rect.y-this.validRect.y),this.requestedRect.height+=o.rect.height-l.rect.height,this.updateLayoutNode(e,l,o);let a=l.parentKey!=null?s.getItem(l.parentKey):null;for(;a;)this.updateLayoutNode(a.key,l,o),a=a.parentKey!=null?s.getItem(a.parentKey):null;return!0}return!1}updateLayoutNode(e,t,i){let s=this.layoutNodes.get(e);s&&(s.validRect=s.validRect.intersection(this.validRect),s.layoutInfo===t&&(s.layoutInfo=i))}getContentSize(){return this.contentSize}getDropTargetFromPoint(e,t,i){e+=this.virtualizer.visibleRect.x,t+=this.virtualizer.visibleRect.y;let s=new g(e,Math.max(0,t-this.gap),1,Math.max(1,this.gap*2)),l=this.getVisibleLayoutInfos(s),o=null,a=1/0;for(let u of l){if(!u.rect.intersects(s))continue;let p=Math.abs(u.rect.y-t),v=Math.abs(u.rect.maxY-t),b=Math.min(p,v);b<a&&(a=b,o=u.key)}if(o==null||this.virtualizer.collection.size===0)return{type:"root"};let c=this.getLayoutInfo(o);if(!c)return null;let r=c.rect,d={type:"item",key:c.key,dropPosition:"on"};return i(d)?t<=r.y+10&&i({...d,dropPosition:"before"})?d.dropPosition="before":t>=r.maxY-10&&i({...d,dropPosition:"after"})&&(d.dropPosition="after"):t<=r.y+r.height/2&&i({...d,dropPosition:"before"})?d.dropPosition="before":i({...d,dropPosition:"after"})&&(d.dropPosition="after"),d}getDropTargetLayoutInfo(e){let t=this.getLayoutInfo(e.key),i;if(e.dropPosition==="before")i=new g(t.rect.x,Math.max(0,t.rect.y-this.dropIndicatorThickness/2),t.rect.width,this.dropIndicatorThickness);else if(e.dropPosition==="after"){let l=this.collection.getItem(e.key);if(l){var s;let o=(s=l.level)!==null&&s!==void 0?s:0,a=this.collection.getKeyAfter(e.key);for(;a!=null;){let c=this.collection.getItem(a);if(!c||c.level<=o)break;t=this.getLayoutInfo(a)||t,a=this.collection.getKeyAfter(a)}}i=new g(t.rect.x,t.rect.maxY-this.dropIndicatorThickness/2,t.rect.width,this.dropIndicatorThickness)}else i=t.rect;return new _("dropIndicator",e.key+":"+e.dropPosition,i)}constructor(e={}){super();var t;this.rowHeight=(t=e.rowHeight)!==null&&t!==void 0?t:null;var i;this.estimatedRowHeight=(i=e.estimatedRowHeight)!==null&&i!==void 0?i:null;var s;this.headingHeight=(s=e.headingHeight)!==null&&s!==void 0?s:null;var l;this.estimatedHeadingHeight=(l=e.estimatedHeadingHeight)!==null&&l!==void 0?l:null;var o;this.loaderHeight=(o=e.loaderHeight)!==null&&o!==void 0?o:null,this.dropIndicatorThickness=e.dropIndicatorThickness||2,this.gap=e.gap||0,this.padding=e.padding||0,this.layoutNodes=new Map,this.rootNodes=[],this.lastCollection=null,this.invalidateEverything=!1,this.validRect=new g,this.requestedRect=new g,this.contentSize=new k}}let H=null;function Ve(n=!1){if(H===null||n){const e=document.createElement("div"),t=e.style;t.width="50px",t.height="50px",t.overflow="scroll",t.direction="rtl";const i=document.createElement("div"),s=i.style;return s.width="100px",s.height="100px",e.appendChild(i),document.body.appendChild(e),e.scrollLeft>0?H="positive-descending":(e.scrollLeft=1,e.scrollLeft===0?H="negative":H="positive-ascending"),document.body.removeChild(e),H}return H}function Oe(n,e){let{scrollLeft:t}=n;if(e==="rtl"){let{scrollWidth:i,clientWidth:s}=n;switch(Ve()){case"negative":t=-t;break;case"positive-descending":t=i-s-t;break}}return t}function qe(n,e){let{contentSize:t,onVisibleRectChange:i,innerStyle:s,onScrollStart:l,onScrollEnd:o,scrollDirection:a="both",...c}=n,r=y.useRef({scrollTop:0,scrollLeft:0,scrollEndTime:0,scrollTimeout:null,width:0,height:0,isScrolling:!1}).current,{direction:d}=ne(),[u,p]=y.useState(!1),v=y.useCallback(w=>{w.target===w.currentTarget&&(n.onScroll&&n.onScroll(w),K.flushSync(()=>{let $=w.currentTarget.scrollTop,P=Oe(w.currentTarget,d);r.scrollTop=Math.max(0,Math.min($,t.height-r.height)),r.scrollLeft=Math.max(0,Math.min(P,t.width-r.width)),i(new g(r.scrollLeft,r.scrollTop,r.width,r.height)),r.isScrolling||(r.isScrolling=!0,p(!0),window.dispatchEvent(new Event("tk.disconnect-observer")),l&&l());let T=Date.now();r.scrollEndTime<=T+50&&(r.scrollEndTime=T+300,r.scrollTimeout!=null&&clearTimeout(r.scrollTimeout),r.scrollTimeout=setTimeout(()=>{r.isScrolling=!1,p(!1),r.scrollTimeout=null,window.dispatchEvent(new Event("tk.connect-observer")),o&&o()},300))}))},[n,d,r,t,i,l,o]);_e(e,"scroll",v),y.useEffect(()=>()=>{r.scrollTimeout!=null&&clearTimeout(r.scrollTimeout),r.isScrolling&&window.dispatchEvent(new Event("tk.connect-observer"))},[]);let b=y.useRef(!1),x=Re(w=>{let $=e.current;if(!$||b.current)return;b.current=!0,Object.getOwnPropertyNames(window.HTMLElement.prototype).includes("clientWidth"),Object.getOwnPropertyNames(window.HTMLElement.prototype).includes("clientHeight");let P=$.clientWidth,T=$.clientHeight,W=P,F=T;(r.width!==W||r.height!==F)&&(r.width=W,r.height=F,w(()=>{i(new g(r.scrollLeft,r.scrollTop,W,F))}),(P!==$.clientWidth||T!==$.clientHeight)&&(r.width=$.clientWidth,r.height=$.clientHeight,w(()=>{i(new g(r.scrollLeft,r.scrollTop,r.width,r.height))}))),b.current=!1}),z=y.useRef(null),[L,q]=y.useState({});Y(()=>{if(!b.current&&(z.current==null||!t.equals(z.current)))if(typeof IS_REACT_ACT_ENVIRONMENT=="boolean"?IS_REACT_ACT_ENVIRONMENT:typeof jest<"u"){q({}),z.current=t;return}else queueMicrotask(()=>x(K.flushSync));z.current=t}),Y(()=>{x(w=>w())},[L]);let A=y.useCallback(()=>{x(K.flushSync)},[x]);Se({ref:e,box:"border-box",onResize:A});let N={padding:0,...c.style};return a==="horizontal"?(N.overflowX="auto",N.overflowY="hidden"):a==="vertical"||t.width===r.width?(N.overflowY="auto",N.overflowX="hidden"):N.overflow="auto",s={width:Number.isFinite(t.width)?t.width:void 0,height:Number.isFinite(t.height)?t.height:void 0,pointerEvents:u?"none":"auto",position:"relative",...s},{isScrolling:u,scrollViewProps:{...c,style:N},contentProps:{role:"presentation",style:s}}}function Ae(n){let{layoutInfo:e,virtualizer:t,ref:i}=n,s=e?.key,l=y.useCallback(()=>{if(s!=null&&i.current){let o=We(i.current);t.updateItemSize(s,o)}},[t,s,i]);return Y(()=>{e?.estimatedSize&&l()}),{updateSize:l}}function We(n){let e=n.style.height;n.style.height="";let t=new k(n.scrollWidth,n.scrollHeight);return n.style.height=e,t}function he(n){let{style:e,className:t,layoutInfo:i,virtualizer:s,parent:l,children:o}=n,{direction:a}=ne(),c=y.useRef(null);return Ae({layoutInfo:i,virtualizer:s,ref:c}),I.createElement("div",{role:"presentation",ref:c,className:t,style:{...Fe(i,a,l),...e}},o)}let G=new WeakMap;function Fe(n,e,t){let i=e==="rtl"?"right":"left",s=G.get(n);if(s&&s[i]!=null){if(!t)return s;let c=n.rect.y-t.rect.y,r=n.rect.x-t.rect.x;if(s.top===c&&s[i]===r)return s}let l={top:n.rect.y-(t&&!(t.allowOverflow&&n.isSticky)?t.rect.y:0),[i]:n.rect.x-(t&&!(t.allowOverflow&&n.isSticky)?t.rect.x:0),width:n.rect.width,height:n.rect.height};Object.entries(l).forEach(([c,r])=>{Number.isFinite(r)||(l[c]=void 0)});var o;let a={position:n.isSticky?"sticky":"absolute",display:n.isSticky?"inline-block":void 0,overflow:n.allowOverflow?"visible":"hidden",opacity:n.opacity,zIndex:n.zIndex,transform:(o=n.transform)!==null&&o!==void 0?o:void 0,contain:"size layout style",...l};return G.set(n,a),a}const ue=y.createContext(null),pe=y.createContext(null);function V(n){let{children:e,layout:t,layoutOptions:i}=n,s=y.useMemo(()=>typeof t=="function"?new t:t,[t]),l=y.useMemo(()=>({isVirtualized:!0,layoutDelegate:s,dropTargetDelegate:s.getDropTargetFromPoint?s:void 0,CollectionRoot:Ke,CollectionBranch:Ye}),[s]);return I.createElement(Ie.Provider,{value:l},I.createElement(pe.Provider,{value:{layout:s,layoutOptions:i}},e))}function Ke({collection:n,persistedKeys:e,scrollRef:t,renderDropIndicator:i}){var s;let{layout:l,layoutOptions:o}=y.useContext(pe),a=(s=l.useLayoutOptions)===null||s===void 0?void 0:s.call(l),c=Ee({layout:l,collection:n,renderView:(d,u)=>{var p;return u==null||(p=u.render)===null||p===void 0?void 0:p.call(u,u)},onVisibleRectChange(d){let u=t?.current;u&&(u.scrollLeft=d.x,u.scrollTop=d.y)},persistedKeys:e,layoutOptions:y.useMemo(()=>o&&a?{...o,...a}:o||a,[o,a])}),{contentProps:r}=qe({onVisibleRectChange:c.setVisibleRect,contentSize:c.contentSize,onScrollStart:c.startScrolling,onScrollEnd:c.endScrolling},t);return I.createElement("div",r,I.createElement(ue.Provider,{value:c},fe(null,c.visibleViews,i)))}function Ye({parent:n,renderDropIndicator:e}){let i=y.useContext(ue).virtualizer.getVisibleView(n.key);return fe(i,Array.from(i.children),e)}function fe(n,e,t){return e.map(i=>Be(n,i,t))}function Be(n,e,t){let i=I.createElement(he,{key:e.key,layoutInfo:e.layoutInfo,virtualizer:e.virtualizer,parent:n?.layoutInfo},e.rendered),{collection:s,layout:l}=e.virtualizer,o=e.content;return o?.type==="item"&&t&&l.getDropTargetLayoutInfo&&(i=I.createElement(I.Fragment,{key:e.key},J(n,e,{type:"item",key:e.content.key,dropPosition:"before"},t),i,$e(s,o,a=>J(n,e,a,t)))),i}function J(n,e,t,i){let s=i(t);if(s){let l=e.virtualizer.layout.getDropTargetLayoutInfo(t);s=I.createElement(he,{layoutInfo:l,virtualizer:e.virtualizer,parent:n?.layoutInfo},s)}return s}const S={classNames:{root:"bui-Menu",popover:"bui-MenuPopover",content:"bui-MenuContent",section:"bui-MenuSection",sectionHeader:"bui-MenuSectionHeader",item:"bui-MenuItem",itemListBox:"bui-MenuItemListBox",itemListBoxCheck:"bui-MenuItemListBoxCheck",itemWrapper:"bui-MenuItemWrapper",itemContent:"bui-MenuItemContent",itemArrow:"bui-MenuItemArrow",separator:"bui-MenuSeparator",searchField:"bui-MenuSearchField",searchFieldInput:"bui-MenuSearchFieldInput",searchFieldClear:"bui-MenuSearchFieldClear",emptyState:"bui-MenuEmptyState"}},m={"bui-MenuPopover":"_bui-MenuPopover_hzyj7_20","bui-MenuContent":"_bui-MenuContent_hzyj7_58","bui-MenuItem":"_bui-MenuItem_hzyj7_68","bui-MenuItemWrapper":"_bui-MenuItemWrapper_hzyj7_72","bui-MenuItemArrow":"_bui-MenuItemArrow_hzyj7_92","bui-MenuItemListBox":"_bui-MenuItemListBox_hzyj7_112","bui-MenuItemListBoxCheck":"_bui-MenuItemListBoxCheck_hzyj7_121","bui-MenuItemContent":"_bui-MenuItemContent_hzyj7_143","bui-MenuSection":"_bui-MenuSection_hzyj7_165","bui-MenuSectionHeader":"_bui-MenuSectionHeader_hzyj7_166","bui-MenuSeparator":"_bui-MenuSeparator_hzyj7_184","bui-MenuSearchField":"_bui-MenuSearchField_hzyj7_191","bui-MenuSearchFieldClear":"_bui-MenuSearchFieldClear_hzyj7_202","bui-MenuSearchFieldInput":"_bui-MenuSearchFieldInput_hzyj7_208","bui-MenuEmptyState":"_bui-MenuEmptyState_hzyj7_262"},O=32,B=()=>{const{classNames:n}=R(S);return h.jsx("div",{className:f(n.emptyState,m[n.emptyState]),children:"No results found."})},De=n=>h.jsx(me,{...n}),Xe=n=>h.jsx(ge,{...n}),Ue=n=>{const{classNames:e,cleanedProps:t}=R(S,n),{className:i,placement:s="bottom start",virtualized:l=!1,maxWidth:o,maxHeight:a,style:c,...r}=t,d=re();let u=o||(l?"260px":"undefined");const p=y.useRef(null),v=y.useContext(ye);y.useEffect(()=>{if(!v?.isOpen)return;const x=z=>{const L=z.target;if(p.current&&!p.current.contains(L)){const q=L.closest("[data-trigger]"),A=L.closest('[role="menu"]');!q&&!A&&v.close()}};return document.addEventListener("mousedown",x),()=>{document.removeEventListener("mousedown",x)}},[v]);const b=h.jsx(te,{className:f(e.content,m[e.content]),renderEmptyState:()=>h.jsx(B,{}),style:{width:u,maxHeight:a,...c},...r});return h.jsx(j,{ref:p,className:f(e.popover,m[e.popover],i),placement:s,isNonModal:!0,isKeyboardDismissDisabled:!1,children:h.jsx(ce,{navigate:d,useHref:ae,children:l?h.jsx(V,{layout:E,layoutOptions:{rowHeight:O},children:b}):b})})},Ge=n=>{const{classNames:e,cleanedProps:t}=R(S,n),{className:i,selectionMode:s="single",placement:l="bottom start",virtualized:o=!1,maxWidth:a,maxHeight:c,style:r,...d}=t;let u=a||(o?"260px":"undefined");const p=h.jsx(se,{className:f(e.content,m[e.content]),selectionMode:s,style:{width:u,maxHeight:c,...r},...d});return h.jsx(j,{className:f(e.popover,m[e.popover],i),placement:l,children:o?h.jsx(V,{layout:E,layoutOptions:{rowHeight:O},children:p}):p})},Je=n=>{const{classNames:e,cleanedProps:t}=R(S,n),{className:i,placement:s="bottom start",virtualized:l=!1,maxWidth:o,maxHeight:a,style:c,...r}=t,{contains:d}=Q({sensitivity:"base"});let u=o||(l?"260px":"undefined");const p=re(),v=h.jsx(te,{className:f(e.content,m[e.content]),renderEmptyState:()=>h.jsx(B,{}),style:{width:u,maxHeight:a,...c},...r});return h.jsx(j,{className:f(e.popover,m[e.popover],i),placement:s,children:h.jsx(ce,{navigate:p,useHref:ae,children:h.jsxs(Z,{filter:d,children:[h.jsxs(le,{className:f(e.searchField,m[e.searchField]),"aria-label":n.placeholder||"Search",children:[h.jsx(ie,{className:f(e.searchFieldInput,m[e.searchFieldInput]),placeholder:n.placeholder||"Search..."}),h.jsx(ee,{className:f(e.searchFieldClear,m[e.searchFieldClear]),children:h.jsx(oe,{})})]}),l?h.jsx(V,{layout:E,layoutOptions:{rowHeight:O},children:v}):v]})})})},Qe=n=>{const{classNames:e,cleanedProps:t}=R(S,n),{className:i,selectionMode:s="single",placement:l="bottom start",virtualized:o=!1,maxWidth:a,maxHeight:c,style:r,...d}=t,{contains:u}=Q({sensitivity:"base"});let p=a||(o?"260px":"undefined");const v=h.jsx(se,{className:f(e.content,m[e.content]),renderEmptyState:()=>h.jsx(B,{}),selectionMode:s,style:{width:p,maxHeight:c,...r},...d});return h.jsx(j,{className:f(e.popover,m[e.popover],i),placement:l,children:h.jsxs(Z,{filter:u,children:[h.jsxs(le,{className:f(e.searchField,m[e.searchField]),"aria-label":n.placeholder||"Search",children:[h.jsx(ie,{className:f(e.searchFieldInput,m[e.searchFieldInput]),placeholder:n.placeholder||"Search..."}),h.jsx(ee,{className:f(e.searchFieldClear,m[e.searchFieldClear]),children:h.jsx(oe,{})})]}),o?h.jsx(V,{layout:E,layoutOptions:{rowHeight:O},children:v}):v]})})},Ze=n=>{const{classNames:e,cleanedProps:t}=R(S,n),{className:i,iconStart:s,color:l="primary",children:o,href:a,...c}=t,r=a!==void 0,d=ze(a);return r&&d?h.jsx(D,{className:f(e.item,m[e.item],i),"data-color":l,textValue:typeof o=="string"?o:void 0,onAction:()=>window.open(a,"_blank","noopener,noreferrer"),...c,children:h.jsxs("div",{className:f(e.itemWrapper,m[e.itemWrapper]),children:[h.jsxs("div",{className:f(e.itemContent,m[e.itemContent]),children:[s,o]}),h.jsx("div",{className:f(e.itemArrow,m[e.itemArrow]),children:h.jsx(U,{})})]})}):h.jsx(D,{className:f(e.item,m[e.item],i),"data-color":l,href:a,textValue:typeof o=="string"?o:void 0,...c,children:h.jsxs("div",{className:f(e.itemWrapper,m[e.itemWrapper]),children:[h.jsxs("div",{className:f(e.itemContent,m[e.itemContent]),children:[s,o]}),h.jsx("div",{className:f(e.itemArrow,m[e.itemArrow]),children:h.jsx(U,{})})]})})},et=n=>{const{classNames:e,cleanedProps:t}=R(S,n),{children:i,className:s,...l}=t;return h.jsx(we,{textValue:typeof n.children=="string"?n.children:void 0,className:f(e.itemListBox,m[e.itemListBox],s),...l,children:h.jsx("div",{className:f(e.itemWrapper,m[e.itemWrapper]),children:h.jsxs("div",{className:f(e.itemContent,m[e.itemContent]),children:[h.jsx("div",{className:f(e.itemListBoxCheck,m[e.itemListBoxCheck]),children:h.jsx(Me,{})}),i]})})})},tt=n=>{const{classNames:e,cleanedProps:t}=R(S,n),{children:i,className:s,title:l,...o}=t;return h.jsxs(ve,{className:f(e.section,m[e.section],s),...o,children:[h.jsx(xe,{className:f(e.sectionHeader,m[e.sectionHeader]),children:l}),i]})},it=n=>{const{classNames:e,cleanedProps:t}=R(S,n),{className:i,...s}=t;return h.jsx(be,{className:f(e.separator,m[e.separator],i),...s})};De.__docgenInfo={description:"@public",methods:[],displayName:"MenuTrigger",composes:["RAMenuTriggerProps"]};Xe.__docgenInfo={description:"@public",methods:[],displayName:"SubmenuTrigger",composes:["RAMenuSubmenuTriggerProps"]};Ue.__docgenInfo={description:"@public",methods:[],displayName:"Menu",props:{placement:{required:!1,tsType:{name:"RAPopoverProps['placement']",raw:"RAPopoverProps['placement']"},description:""},virtualized:{required:!1,tsType:{name:"boolean"},description:""},maxWidth:{required:!1,tsType:{name:"string"},description:""},maxHeight:{required:!1,tsType:{name:"string"},description:""}},composes:["RAMenuProps","Omit"]};Ge.__docgenInfo={description:"@public",methods:[],displayName:"MenuListBox",props:{placement:{required:!1,tsType:{name:"RAPopoverProps['placement']",raw:"RAPopoverProps['placement']"},description:""},virtualized:{required:!1,tsType:{name:"boolean"},description:""},maxWidth:{required:!1,tsType:{name:"string"},description:""},maxHeight:{required:!1,tsType:{name:"string"},description:""}},composes:["RAListBoxProps","Omit"]};Je.__docgenInfo={description:"@public",methods:[],displayName:"MenuAutocomplete",props:{placeholder:{required:!1,tsType:{name:"string"},description:""},placement:{required:!1,tsType:{name:"RAPopoverProps['placement']",raw:"RAPopoverProps['placement']"},description:""},virtualized:{required:!1,tsType:{name:"boolean"},description:""},maxWidth:{required:!1,tsType:{name:"string"},description:""},maxHeight:{required:!1,tsType:{name:"string"},description:""}},composes:["RAMenuProps","Omit"]};Qe.__docgenInfo={description:"@public",methods:[],displayName:"MenuAutocompleteListbox",props:{placeholder:{required:!1,tsType:{name:"string"},description:""},placement:{required:!1,tsType:{name:"RAPopoverProps['placement']",raw:"RAPopoverProps['placement']"},description:""},virtualized:{required:!1,tsType:{name:"boolean"},description:""},maxWidth:{required:!1,tsType:{name:"string"},description:""},maxHeight:{required:!1,tsType:{name:"string"},description:""}},composes:["RAListBoxProps","Omit"]};Ze.__docgenInfo={description:"@public",methods:[],displayName:"MenuItem",props:{iconStart:{required:!1,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""},children:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""},color:{required:!1,tsType:{name:"union",raw:"'primary' | 'danger'",elements:[{name:"literal",value:"'primary'"},{name:"literal",value:"'danger'"}]},description:""}},composes:["RAMenuItemProps","Omit"]};et.__docgenInfo={description:"@public",methods:[],displayName:"MenuListBoxItem",props:{children:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""}},composes:["RAListBoxItemProps","Omit"]};tt.__docgenInfo={description:"@public",methods:[],displayName:"MenuSection",props:{title:{required:!0,tsType:{name:"string"},description:""},children:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""}},composes:["RAMenuSectionProps","Omit"]};it.__docgenInfo={description:"@public",methods:[],displayName:"MenuSeparator",composes:["RAMenuSeparatorProps"]};export{De as M,Xe as S,Ue as a,Ze as b,it as c,tt as d,Je as e,Qe as f,et as g,Ge as h};
