import{c as Pe}from"./Separator-CPZLX6dD.js";import{r as a,R as Ae}from"./iframe-M9O-K8SB.js";import{a as Se,c as De}from"./RSPContexts-BdpIjeVF.js";import{f as we,b as Te,d as Be,e as Ve}from"./utils-BXllfVt4.js";import{a as Ke,b as ze,d as Ue,$ as w}from"./useObjectRef-BPFp5snO.js";import{y as He,D as Me,v as We,b as R,j as P,i as Oe,O as je}from"./useFocusable-BwFERnd_.js";import{$ as qe}from"./useLabels-C3g0X61E.js";import{$ as Ge}from"./useEvent-BRbGx-1q.js";import{v as A,w as Je,x as Ze,y as S,z as D,A as Qe,B as Xe}from"./SelectionManager-AOhnTTKk.js";import{$ as Ye}from"./useLocalizedStringFormatter-C4c9cZU5.js";import{$ as _e}from"./useControlledState-DzBnLbpE.js";function vt(u){let r=Pe({usage:"search",...u}),i=a.useCallback((c,l)=>l.length===0?!0:(c=c.normalize("NFC"),l=l.normalize("NFC"),r.compare(c.slice(0,l.length),l)===0),[r]),o=a.useCallback((c,l)=>l.length===0?!0:(c=c.normalize("NFC"),l=l.normalize("NFC"),r.compare(c.slice(-l.length),l)===0),[r]),f=a.useCallback((c,l)=>{if(l.length===0)return!0;c=c.normalize("NFC"),l=l.normalize("NFC");let s=0,d=l.length;for(;s+d<=c.length;s++){let b=c.slice(s,s+d);if(r.compare(l,b)===0)return!0}return!1},[r]);return a.useMemo(()=>({startsWith:i,endsWith:o,contains:f}),[i,o,f])}var T={};T={collectionLabel:"مقترحات"};var B={};B={collectionLabel:"Предложения"};var V={};V={collectionLabel:"Návrhy"};var K={};K={collectionLabel:"Forslag"};var z={};z={collectionLabel:"Empfehlungen"};var U={};U={collectionLabel:"Προτάσεις"};var H={};H={collectionLabel:"Suggestions"};var M={};M={collectionLabel:"Sugerencias"};var W={};W={collectionLabel:"Soovitused"};var O={};O={collectionLabel:"Ehdotukset"};var j={};j={collectionLabel:"Suggestions"};var q={};q={collectionLabel:"הצעות"};var G={};G={collectionLabel:"Prijedlozi"};var J={};J={collectionLabel:"Javaslatok"};var Z={};Z={collectionLabel:"Suggerimenti"};var Q={};Q={collectionLabel:"候補"};var X={};X={collectionLabel:"제안"};var Y={};Y={collectionLabel:"Pasiūlymai"};var _={};_={collectionLabel:"Ieteikumi"};var ee={};ee={collectionLabel:"Forslag"};var te={};te={collectionLabel:"Suggesties"};var ae={};ae={collectionLabel:"Sugestie"};var le={};le={collectionLabel:"Sugestões"};var re={};re={collectionLabel:"Sugestões"};var oe={};oe={collectionLabel:"Sugestii"};var ce={};ce={collectionLabel:"Предложения"};var ue={};ue={collectionLabel:"Návrhy"};var ne={};ne={collectionLabel:"Predlogi"};var ie={};ie={collectionLabel:"Predlozi"};var fe={};fe={collectionLabel:"Förslag"};var se={};se={collectionLabel:"Öneriler"};var de={};de={collectionLabel:"Пропозиції"};var $e={};$e={collectionLabel:"建议"};var be={};be={collectionLabel:"建議"};var pe={};pe={"ar-AE":T,"bg-BG":B,"cs-CZ":V,"da-DK":K,"de-DE":z,"el-GR":U,"en-US":H,"es-ES":M,"et-EE":W,"fi-FI":O,"fr-FR":j,"he-IL":q,"hr-HR":G,"hu-HU":J,"it-IT":Z,"ja-JP":Q,"ko-KR":X,"lt-LT":Y,"lv-LV":_,"nb-NO":ee,"nl-NL":te,"pl-PL":ae,"pt-BR":le,"pt-PT":re,"ro-RO":oe,"ru-RU":ce,"sk-SK":ue,"sl-SI":ne,"sr-SP":ie,"sv-SE":fe,"tr-TR":se,"uk-UA":de,"zh-CN":$e,"zh-TW":be};function et(u){return u&&u.__esModule?u.default:u}function tt(u,r){let{inputRef:i,collectionRef:o,filter:f,disableAutoFocusFirst:c=!1,disableVirtualFocus:l=!1}=u,s=Ke(),d=a.useRef(void 0),b=a.useRef(!1),n=a.useRef(null),ve=He()==="virtual"&&(Me()||We()),[E,xe]=a.useState(!ve&&!l),[me,C]=a.useState(!1);a.useEffect(()=>()=>clearTimeout(d.current),[]);let g=R(e=>{!e.isTrusted&&E&&i.current&&P(Oe(i.current))!==i.current&&je()!=="touch"&&i.current.focus();let t=e.target;e.isTrusted||!t||n.current===t.id||(clearTimeout(d.current),t!==o.current?b.current?(n.current=t.id,d.current=setTimeout(()=>{r.setFocusedNodeId(t.id)},500)):(n.current=t.id,r.setFocusedNodeId(t.id)):n.current&&!document.getElementById(n.current)&&(n.current=null,r.setFocusedNodeId(null)),b.current=!1)}),[x,Ee]=a.useState(null),y=a.useCallback(e=>{Ee(e),e!=null?(e.getAttribute("tabindex")!=null&&xe(!1),C(!0)):C(!1)},[]);ze(()=>(x?.addEventListener("focusin",g),()=>{x?.removeEventListener("focusin",g)}),[x]);let Fe=Ue(a.useMemo(()=>we(o,y),[o,y])),he=a.useCallback(()=>{var e;b.current=!0,(e=o.current)===null||e===void 0||e.dispatchEvent(new CustomEvent(A,{cancelable:!0,bubbles:!0,detail:{focusStrategy:"first"}}))},[o]),I=a.useCallback(e=>{var t;Je(P()),n.current=null,r.setFocusedNodeId(null);let $=new CustomEvent(Ze,{cancelable:!0,bubbles:!0,detail:{clearFocusKey:e}});clearTimeout(d.current),b.current=!1,(t=o.current)===null||t===void 0||t.dispatchEvent($)},[o,r]),m=a.useRef("");Ge(i,"input",e=>{let{inputType:t}=e;m.current=t});let Le=e=>{m.current==="insertText"&&!c?he():m.current&&(m.current.includes("insert")||m.current.includes("delete")||m.current.includes("history"))&&(I(!0),Xe(document)===i.current&&D(i.current,null)),r.setInputValue(e)},k=a.useRef(null),Ce=e=>{if(k.current=e.target,e.nativeEvent.isComposing)return;let t=n.current;switch(e.key){case"a":if(Qe(e))return;break;case"Escape":if(e.isDefaultPrevented())return;break;case" ":return;case"Tab":"continuePropagation"in e&&e.continuePropagation();return;case"Home":case"End":case"PageDown":case"PageUp":case"ArrowUp":case"ArrowDown":{var $;if((e.key==="Home"||e.key==="End")&&t==null&&e.shiftKey)return;e.preventDefault();let p=new CustomEvent(A,{cancelable:!0,bubbles:!0});($=o.current)===null||$===void 0||$.dispatchEvent(p);break}}e.isPropagationStopped()||e.stopPropagation();let v=!0;if(o.current!==null){var L;if(t==null)v=((L=o.current)===null||L===void 0?void 0:L.dispatchEvent(new KeyboardEvent(e.nativeEvent.type,e.nativeEvent)))||!1;else{let p=document.getElementById(t);p&&(v=p?.dispatchEvent(new KeyboardEvent(e.nativeEvent.type,e.nativeEvent))||!1)}}if(v)switch(e.key){case"ArrowLeft":case"ArrowRight":I();break;case"Enter":if(t!=null){let p=document.getElementById(t);p?.dispatchEvent(new PointerEvent("click",e.nativeEvent))}break}else e.preventDefault()},N=R(e=>{if(e.target===k.current){var t;e.stopImmediatePropagation();let $=n.current;if($==null)(t=o.current)===null||t===void 0||t.dispatchEvent(new KeyboardEvent(e.type,e));else{let v=document.getElementById($);v?.dispatchEvent(new KeyboardEvent(e.type,e))}}});a.useEffect(()=>(document.addEventListener("keyup",N,!0),()=>{document.removeEventListener("keyup",N,!0)}),[]);let ge=Ye(et(pe),"@react-aria/autocomplete"),ye=qe({id:s,"aria-label":ge.format("collectionLabel")}),Ie=a.useCallback((e,t)=>f?f(e,r.inputValue,t):!0,[r.inputValue,f]),ke=e=>{if(!e.isTrusted)return;let t=n.current?document.getElementById(n.current):null;t&&S(t,e.relatedTarget)},Ne=e=>{if(!e.isTrusted)return;if(n.current?document.getElementById(n.current):null){let $=e.target;queueMicrotask(()=>{S($,o.current),D(o.current,$)})}},F={value:r.inputValue,onChange:Le};var h;let Re={onKeyDown:Ce,"aria-activedescendant":(h=r.focusedNodeId)!==null&&h!==void 0?h:void 0,onBlur:ke,onFocus:Ne};return me&&(F={...F,...E&&Re,enterKeyHint:"go","aria-controls":s,"aria-autocomplete":"list",autoCorrect:"off",spellCheck:"false",autoComplete:"off"}),{inputProps:F,collectionProps:w(ye,{shouldUseVirtualFocus:E,disallowTypeAhead:E}),collectionRef:Fe,filter:f!=null?Ie:void 0}}function at(u){let{onInputChange:r,inputValue:i,defaultInputValue:o=""}=u,f=b=>{r&&r(b)},[c,l]=a.useState(null),[s,d]=_e(i,o,f);return{inputValue:s,setInputValue:d,focusedNodeId:c,setFocusedNodeId:l}}const lt=a.createContext(null),rt=a.createContext(null);function xt(u){let r=Te(lt,u.slot);u=w(r,u);let{filter:i,disableAutoFocusFirst:o}=u,f=at(u),c=a.useRef(null),l=a.useRef(null),{inputProps:s,collectionProps:d,collectionRef:b,filter:n}=tt({...Be(u),filter:i,disableAutoFocusFirst:o,inputRef:c,collectionRef:l},f);return Ae.createElement(Ve,{values:[[rt,f],[Se,{...s,ref:c}],[De,{...d,filter:n,ref:b}]]},u.children)}export{vt as $,xt as a};
