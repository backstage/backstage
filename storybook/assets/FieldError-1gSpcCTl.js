import{s as Q,b as k}from"./useFocusRing-CSBfGNH9.js";import{r,R as $}from"./index-D8-PC79C.js";import{i as q,b as g,c as P,m as C,a as Y,$ as B,d as z}from"./utils-SVxEJA3c.js";import{$ as G}from"./useLabels-CXdioV2U.js";import{j as H}from"./jsx-runtime-hv06LKfz.js";import{c as J}from"./clsx-B-dksMZM.js";const R={badInput:!1,customError:!1,patternMismatch:!1,rangeOverflow:!1,rangeUnderflow:!1,stepMismatch:!1,tooLong:!1,tooShort:!1,typeMismatch:!1,valueMissing:!1,valid:!0},D={...R,customError:!0,valid:!1},m={isInvalid:!1,validationDetails:R,validationErrors:[]},N=r.createContext({}),F="__formValidationState"+Date.now();function $e(t){if(t[F]){let{realtimeValidation:e,displayValidation:a,updateValidation:i,resetValidation:l,commitValidation:n}=t[F];return{realtimeValidation:e,displayValidation:a,updateValidation:i,resetValidation:l,commitValidation:n}}return K(t)}function K(t){let{isInvalid:e,validationState:a,name:i,value:l,builtinValidation:n,validate:d,validationBehavior:s="aria"}=t;a&&(e||(e=a==="invalid"));let o=e!==void 0?{isInvalid:e,validationErrors:[],validationDetails:D}:null,u=r.useMemo(()=>{if(!d||l==null)return null;let c=W(d,l);return L(c)},[d,l]);n?.validationDetails.valid&&(n=void 0);let f=r.useContext(N),v=r.useMemo(()=>i?Array.isArray(i)?i.flatMap(c=>I(f[c])):I(f[i]):[],[f,i]),[A,O]=r.useState(f),[M,p]=r.useState(!1);f!==A&&(O(f),p(!1));let E=r.useMemo(()=>L(M?[]:v),[M,v]),S=r.useRef(m),[V,x]=r.useState(m),b=r.useRef(m),U=()=>{if(!_)return;y(!1);let c=u||n||S.current;h(c,b.current)||(b.current=c,x(c))},[_,y]=r.useState(!1);return r.useEffect(U),{realtimeValidation:o||E||u||n||m,displayValidation:s==="native"?o||E||V:o||E||u||n||V,updateValidation(c){s==="aria"&&!h(V,c)?x(c):S.current=c},resetValidation(){let c=m;h(c,b.current)||(b.current=c,x(c)),s==="native"&&y(!1),p(!0)},commitValidation(){s==="native"&&y(!0),p(!0)}}}function I(t){return t?Array.isArray(t)?t:[t]:[]}function W(t,e){if(typeof t=="function"){let a=t(e);if(a&&typeof a!="boolean")return I(a)}return[]}function L(t){return t.length?{isInvalid:!0,validationErrors:t,validationDetails:D}:null}function h(t,e){return t===e?!0:!!t&&!!e&&t.isInvalid===e.isInvalid&&t.validationErrors.length===e.validationErrors.length&&t.validationErrors.every((a,i)=>a===e.validationErrors[i])&&Object.entries(t.validationDetails).every(([a,i])=>e.validationDetails[a]===i)}function me(t,e,a){let{validationBehavior:i,focus:l}=t;q(()=>{if(i==="native"&&a?.current&&!a.current.disabled){let o=e.realtimeValidation.isInvalid?e.realtimeValidation.validationErrors.join(" ")||"Invalid value.":"";a.current.setCustomValidity(o),a.current.hasAttribute("title")||(a.current.title=""),e.realtimeValidation.isInvalid||e.updateValidation(Z(a.current))}});let n=g(()=>{e.resetValidation()}),d=g(o=>{var u;e.displayValidation.isInvalid||e.commitValidation();let f=a==null||(u=a.current)===null||u===void 0?void 0:u.form;if(!o.defaultPrevented&&a&&f&&ee(f)===a.current){var v;l?l():(v=a.current)===null||v===void 0||v.focus(),Q("keyboard")}o.preventDefault()}),s=g(()=>{e.commitValidation()});r.useEffect(()=>{let o=a?.current;if(!o)return;let u=o.form;return o.addEventListener("invalid",d),o.addEventListener("change",s),u?.addEventListener("reset",n),()=>{o.removeEventListener("invalid",d),o.removeEventListener("change",s),u?.removeEventListener("reset",n)}},[a,d,s,n,i])}function X(t){let e=t.validity;return{badInput:e.badInput,customError:e.customError,patternMismatch:e.patternMismatch,rangeOverflow:e.rangeOverflow,rangeUnderflow:e.rangeUnderflow,stepMismatch:e.stepMismatch,tooLong:e.tooLong,tooShort:e.tooShort,typeMismatch:e.typeMismatch,valueMissing:e.valueMissing,valid:e.valid}}function Z(t){return{isInvalid:!t.validity.valid,validationDetails:X(t),validationErrors:t.validationMessage?[t.validationMessage]:[]}}function ee(t){for(let e=0;e<t.elements.length;e++){let a=t.elements[e];if(!a.validity.valid)return a}return null}function ae(t){let{id:e,label:a,"aria-labelledby":i,"aria-label":l,labelElementType:n="label"}=t;e=P(e);let d=P(),s={};a&&(i=i?`${d} ${i}`:d,s={id:d,htmlFor:n==="label"?e:void 0});let o=G({id:e,"aria-label":l,"aria-labelledby":i});return{labelProps:s,fieldProps:o}}function be(t){let{description:e,errorMessage:a,isInvalid:i,validationState:l}=t,{labelProps:n,fieldProps:d}=ae(t),s=C([!!e,!!a,i,l]),o=C([!!e,!!a,i,l]);return d=Y(d,{"aria-describedby":[s,o,t["aria-describedby"]].filter(Boolean).join(" ")||void 0}),{labelProps:n,fieldProps:d,descriptionProps:{id:s},errorMessageProps:{id:o}}}const te=r.createContext({}),ie=r.forwardRef(function(e,a){[e,a]=B(e,a,te);let{elementType:i="span",...l}=e;return $.createElement(i,{className:"react-aria-Text",...l,ref:a})}),T=r.createContext(null),re=r.forwardRef(function(e,a){let i=r.useContext(T);return i?.isInvalid?$.createElement(le,{...e,ref:a}):null}),le=r.forwardRef((t,e)=>{let a=r.useContext(T),i=k(t),l=z({...t,defaultClassName:"react-aria-FieldError",defaultChildren:a.validationErrors.length===0?void 0:a.validationErrors.join(" "),values:a});return l.children==null?null:$.createElement(ie,{slot:"errorMessage",...i,...l,ref:e})}),w=r.createContext(null),pe=r.forwardRef(function(e,a){[e,a]=B(e,a,w);let{validationErrors:i,validationBehavior:l="native",children:n,className:d,...s}=e;return $.createElement("form",{noValidate:l!=="native",...s,ref:a,className:d||"react-aria-Form"},$.createElement(w.Provider,{value:{...e,validationBehavior:l}},$.createElement(N.Provider,{value:i??{}},n)))}),j=r.forwardRef((t,e)=>{const{className:a,...i}=t;return H.jsx(re,{className:J("bui-FieldError",a),ref:e,...i})});j.displayName="FieldError";j.__docgenInfo={description:"@public",methods:[],displayName:"FieldError"};export{pe as $,j as F,$e as a,be as b,me as c,w as d,te as e,T as f,ae as g,ie as h,F as i,m as j};
