var g=Object.defineProperty;var E=(n,e,t)=>e in n?g(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var d=(n,e,t)=>E(n,typeof e!="symbol"?e+"":e,t);import{j as u}from"./jsx-runtime-CvpxdxdE.js";import{r as m}from"./index-DSHF18-l.js";import{a as f}from"./componentData-CNQluCuE.js";import{A as y,u as R,r as b}from"./useAnalytics-BqSe3k6a.js";import{F as w}from"./ApiRef-DDVPwL0h.js";import{b as j}from"./index-CEhUYg2U.js";import{u as v}from"./useRouteRef-clHAB9KK.js";class h extends m.Component{constructor(){super(...arguments);d(this,"state",{error:void 0});d(this,"handleErrorReset",()=>{this.setState({error:void 0})})}static getDerivedStateFromError(t){return{error:t}}render(){const{error:t}=this.state,{app:r,plugin:a}=this.props,{ErrorBoundaryFallback:s}=r.getComponents();return t?u.jsx(s,{error:t,resetError:this.handleErrorReset,plugin:a}):this.props.children}}h.__docgenInfo={description:"",methods:[{name:"handleErrorReset",docblock:null,modifiers:[],params:[],returns:null}],displayName:"PluginErrorBoundary"};function S(n){const{component:e,mountPoint:t,name:r}=n;return x({component:{lazy:()=>e().then(a=>{const s=i=>{const c=R();try{v(t)}catch(l){if(typeof l=="object"&&l!==null){const{message:p}=l;if(typeof p=="string"&&p.startsWith("No path for "))throw new Error(`Routable extension component with mount point ${t} was not discovered in the app element tree. Routable extension components may not be rendered by other components and must be directly available as an element within the App provider component.`)}throw l}return m.useEffect(()=>{c.captureEvent(b,"")},[c]),u.jsx(a,{...i})},o=r||a.displayName||a.name||"LazyComponent";return s.displayName=`RoutableExtension(${o})`,s})},data:{"core.mountPoint":t},name:r})}function B(n){const{component:e,name:t}=n;return x({component:e,name:t})}function x(n){const{data:e={},name:t}=n;t||console.warn("Declaring extensions without name is DEPRECATED. Make sure that all usages of createReactExtension, createComponentExtension and createRoutableExtension provide a name.");let r;if("lazy"in n.component){const s=n.component.lazy;r=m.lazy(()=>s().then(o=>({default:o}),o=>{const i=t?` of the ${t} extension`:"";throw new w(`Failed lazy loading${i}, try to reload the page`,o)}))}else r=n.component.sync;const a=t||r.displayName||r.name||"Component";return{expose(s){const o=i=>{const c=j(),{Progress:l}=c.getComponents(),p=e==null?void 0:e["core.mountPoint"];return u.jsx(m.Suspense,{fallback:u.jsx(l,{}),children:u.jsx(h,{app:c,plugin:s,children:u.jsx(y,{attributes:{pluginId:s.getId(),...t&&{extension:t},...p&&{routeRef:p.id}},children:u.jsx(r,{...i})})})})};f(o,"core.plugin",s),f(o,"core.extensionName",t);for(const[i,c]of Object.entries(e))f(o,i,c);return o.displayName=`Extension(${a})`,o}}}class P{constructor(e){this.config=e}getId(){return this.config.id}getApis(){return this.config.apis??[]}getFeatureFlags(){var e;return((e=this.config.featureFlags)==null?void 0:e.slice())??[]}get routes(){return this.config.routes??{}}get externalRoutes(){return this.config.externalRoutes??{}}provide(e){return e.expose(this)}toString(){return`plugin{${this.config.id}}`}}function I(n){return new P(n)}export{x as a,S as b,I as c,B as d};
