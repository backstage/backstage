import{s as J,l as K,j as m,i as E,t as H,u as j,k as R,v as B,w as G,x as V,y as Q}from"./useFocusable-BwFERnd_.js";import{b as k}from"./useObjectRef-BPFp5snO.js";import{r as $,R as _}from"./iframe-M9O-K8SB.js";class X{get currentNode(){return this._currentNode}set currentNode(e){if(!K(this.root,e))throw new Error("Cannot set currentNode to a node that is not contained by the root node.");const t=[];let o=e,n=e;for(this._currentNode=e;o&&o!==this.root;)if(o.nodeType===Node.DOCUMENT_FRAGMENT_NODE){const a=o,i=this._doc.createTreeWalker(a,this.whatToShow,{acceptNode:this._acceptNode});t.push(i),i.currentNode=n,this._currentSetFor.add(i),o=n=a.host}else o=o.parentNode;const l=this._doc.createTreeWalker(this.root,this.whatToShow,{acceptNode:this._acceptNode});t.push(l),l.currentNode=n,this._currentSetFor.add(l),this._walkerStack=t}get doc(){return this._doc}firstChild(){let e=this.currentNode,t=this.nextNode();return K(e,t)?(t&&(this.currentNode=t),t):(this.currentNode=e,null)}lastChild(){let t=this._walkerStack[0].lastChild();return t&&(this.currentNode=t),t}nextNode(){const e=this._walkerStack[0].nextNode();if(e){if(e.shadowRoot){var t;let n;if(typeof this.filter=="function"?n=this.filter(e):!((t=this.filter)===null||t===void 0)&&t.acceptNode&&(n=this.filter.acceptNode(e)),n===NodeFilter.FILTER_ACCEPT)return this.currentNode=e,e;let l=this.nextNode();return l&&(this.currentNode=l),l}return e&&(this.currentNode=e),e}else if(this._walkerStack.length>1){this._walkerStack.shift();let o=this.nextNode();return o&&(this.currentNode=o),o}else return null}previousNode(){const e=this._walkerStack[0];if(e.currentNode===e.root){if(this._currentSetFor.has(e))if(this._currentSetFor.delete(e),this._walkerStack.length>1){this._walkerStack.shift();let n=this.previousNode();return n&&(this.currentNode=n),n}else return null;return null}const t=e.previousNode();if(t){if(t.shadowRoot){var o;let l;if(typeof this.filter=="function"?l=this.filter(t):!((o=this.filter)===null||o===void 0)&&o.acceptNode&&(l=this.filter.acceptNode(t)),l===NodeFilter.FILTER_ACCEPT)return t&&(this.currentNode=t),t;let a=this.lastChild();return a&&(this.currentNode=a),a}return t&&(this.currentNode=t),t}else if(this._walkerStack.length>1){this._walkerStack.shift();let n=this.previousNode();return n&&(this.currentNode=n),n}else return null}nextSibling(){return null}previousSibling(){return null}parentNode(){return null}constructor(e,t,o,n){this._walkerStack=[],this._currentSetFor=new Set,this._acceptNode=a=>{if(a.nodeType===Node.ELEMENT_NODE){const f=a.shadowRoot;if(f){const u=this._doc.createTreeWalker(f,this.whatToShow,{acceptNode:this._acceptNode});return this._walkerStack.unshift(u),NodeFilter.FILTER_ACCEPT}else{var i;if(typeof this.filter=="function")return this.filter(a);if(!((i=this.filter)===null||i===void 0)&&i.acceptNode)return this.filter.acceptNode(a);if(this.filter===null)return NodeFilter.FILTER_ACCEPT}}return NodeFilter.FILTER_SKIP},this._doc=e,this.root=t,this.filter=n??null,this.whatToShow=o??NodeFilter.SHOW_ALL,this._currentNode=t,this._walkerStack.unshift(e.createTreeWalker(t,o,this._acceptNode));const l=t.shadowRoot;if(l){const a=this._doc.createTreeWalker(l,this.whatToShow,{acceptNode:this._acceptNode});this._walkerStack.unshift(a)}}}function Y(r,e,t,o){return J()?new X(r,e,t,o):r.createTreeWalker(e,t,o)}const D=_.createContext(null),I="react-aria-focus-scope-restore";let h=null;function ue(r){let{children:e,contain:t,restoreFocus:o,autoFocus:n}=r,l=$.useRef(null),a=$.useRef(null),i=$.useRef([]),{parentNode:f}=$.useContext(D)||{},u=$.useMemo(()=>new A({scopeRef:i}),[i]);k(()=>{let s=f||b.root;if(b.getTreeNode(s.scopeRef)&&h&&!C(h,s.scopeRef)){let v=b.getTreeNode(h);v&&(s=v)}s.addChild(u),b.addNode(u)},[u,f]),k(()=>{let s=b.getTreeNode(i);s&&(s.contain=!!t)},[t]),k(()=>{var s;let v=(s=l.current)===null||s===void 0?void 0:s.nextSibling,N=[],g=y=>y.stopPropagation();for(;v&&v!==a.current;)N.push(v),v.addEventListener(I,g),v=v.nextSibling;return i.current=N,()=>{for(let y of N)y.removeEventListener(I,g)}},[e]),re(i,o,t),ee(i,t),oe(i,o,t),te(i,n),$.useEffect(()=>{const s=m(E(i.current?i.current[0]:void 0));let v=null;if(T(s,i.current)){for(let N of b.traverse())N.scopeRef&&T(s,N.scopeRef.current)&&(v=N);v===b.getTreeNode(i)&&(h=v.scopeRef)}},[i]),k(()=>()=>{var s,v,N;let g=(N=(v=b.getTreeNode(i))===null||v===void 0||(s=v.parent)===null||s===void 0?void 0:s.scopeRef)!==null&&N!==void 0?N:null;(i===h||C(i,h))&&(!g||b.getTreeNode(g))&&(h=g),b.removeTreeNode(i)},[i]);let d=$.useMemo(()=>Z(i),[]),c=$.useMemo(()=>({focusManager:d,parentNode:u}),[u,d]);return _.createElement(D.Provider,{value:c},_.createElement("span",{"data-focus-scope-start":!0,hidden:!0,ref:l}),e,_.createElement("span",{"data-focus-scope-end":!0,hidden:!0,ref:a}))}function Z(r){return{focusNext(e={}){let t=r.current,{from:o,tabbable:n,wrap:l,accept:a}=e;var i;let f=o||m(E((i=t[0])!==null&&i!==void 0?i:void 0)),u=t[0].previousElementSibling,d=S(t),c=w(d,{tabbable:n,accept:a},t);c.currentNode=T(f,t)?f:u;let s=c.nextNode();return!s&&l&&(c.currentNode=u,s=c.nextNode()),s&&p(s,!0),s},focusPrevious(e={}){let t=r.current,{from:o,tabbable:n,wrap:l,accept:a}=e;var i;let f=o||m(E((i=t[0])!==null&&i!==void 0?i:void 0)),u=t[t.length-1].nextElementSibling,d=S(t),c=w(d,{tabbable:n,accept:a},t);c.currentNode=T(f,t)?f:u;let s=c.previousNode();return!s&&l&&(c.currentNode=u,s=c.previousNode()),s&&p(s,!0),s},focusFirst(e={}){let t=r.current,{tabbable:o,accept:n}=e,l=S(t),a=w(l,{tabbable:o,accept:n},t);a.currentNode=t[0].previousElementSibling;let i=a.nextNode();return i&&p(i,!0),i},focusLast(e={}){let t=r.current,{tabbable:o,accept:n}=e,l=S(t),a=w(l,{tabbable:o,accept:n},t);a.currentNode=t[t.length-1].nextElementSibling;let i=a.previousNode();return i&&p(i,!0),i}}}function S(r){return r[0].parentElement}function F(r){let e=b.getTreeNode(h);for(;e&&e.scopeRef!==r;){if(e.contain)return!1;e=e.parent}return!0}function O(r){if(r.checked)return!0;let e=[];if(!r.form)e=[...E(r).querySelectorAll(`input[type="radio"][name="${CSS.escape(r.name)}"]`)].filter(l=>!l.form);else{var t,o;let l=(o=r.form)===null||o===void 0||(t=o.elements)===null||t===void 0?void 0:t.namedItem(r.name);e=[...l??[]]}return e?!e.some(l=>l.checked):!1}function ee(r,e){let t=$.useRef(void 0),o=$.useRef(void 0);k(()=>{let n=r.current;if(!e){o.current&&(cancelAnimationFrame(o.current),o.current=void 0);return}const l=E(n?n[0]:void 0);let a=u=>{if(u.key!=="Tab"||u.altKey||u.ctrlKey||u.metaKey||!F(r)||u.isComposing)return;let d=m(l),c=r.current;if(!c||!T(d,c))return;let s=S(c),v=w(s,{tabbable:!0},c);if(!d)return;v.currentNode=d;let N=u.shiftKey?v.previousNode():v.nextNode();N||(v.currentNode=u.shiftKey?c[c.length-1].nextElementSibling:c[0].previousElementSibling,N=u.shiftKey?v.previousNode():v.nextNode()),u.preventDefault(),N&&p(N,!0)},i=u=>{(!h||C(h,r))&&T(R(u),r.current)?(h=r,t.current=R(u)):F(r)&&!x(R(u),r)?t.current?t.current.focus():h&&h.current&&M(h.current):F(r)&&(t.current=R(u))},f=u=>{o.current&&cancelAnimationFrame(o.current),o.current=requestAnimationFrame(()=>{let d=Q(),c=(d==="virtual"||d===null)&&B()&&G(),s=m(l);if(!c&&s&&F(r)&&!x(s,r)){h=r;let N=R(u);if(N&&N.isConnected){var v;t.current=N,(v=t.current)===null||v===void 0||v.focus()}else h.current&&M(h.current)}})};return l.addEventListener("keydown",a,!1),l.addEventListener("focusin",i,!1),n?.forEach(u=>u.addEventListener("focusin",i,!1)),n?.forEach(u=>u.addEventListener("focusout",f,!1)),()=>{l.removeEventListener("keydown",a,!1),l.removeEventListener("focusin",i,!1),n?.forEach(u=>u.removeEventListener("focusin",i,!1)),n?.forEach(u=>u.removeEventListener("focusout",f,!1))}},[r,e]),k(()=>()=>{o.current&&cancelAnimationFrame(o.current)},[o])}function U(r){return x(r)}function T(r,e){return!r||!e?!1:e.some(t=>t.contains(r))}function x(r,e=null){if(r instanceof Element&&r.closest("[data-react-aria-top-layer]"))return!0;for(let{scopeRef:t}of b.traverse(b.getTreeNode(e)))if(t&&T(r,t.current))return!0;return!1}function ce(r){return x(r,h)}function C(r,e){var t;let o=(t=b.getTreeNode(e))===null||t===void 0?void 0:t.parent;for(;o;){if(o.scopeRef===r)return!0;o=o.parent}return!1}function p(r,e=!1){if(r!=null&&!e)try{V(r)}catch{}else if(r!=null)try{r.focus()}catch{}}function q(r,e=!0){let t=r[0].previousElementSibling,o=S(r),n=w(o,{tabbable:e},r);n.currentNode=t;let l=n.nextNode();return e&&!l&&(o=S(r),n=w(o,{tabbable:!1},r),n.currentNode=t,l=n.nextNode()),l}function M(r,e=!0){p(q(r,e))}function te(r,e){const t=_.useRef(e);$.useEffect(()=>{if(t.current){h=r;const o=E(r.current?r.current[0]:void 0);!T(m(o),h.current)&&r.current&&M(r.current)}t.current=!1},[r])}function re(r,e,t){k(()=>{if(e||t)return;let o=r.current;const n=E(o?o[0]:void 0);let l=a=>{let i=R(a);T(i,r.current)?h=r:U(i)||(h=null)};return n.addEventListener("focusin",l,!1),o?.forEach(a=>a.addEventListener("focusin",l,!1)),()=>{n.removeEventListener("focusin",l,!1),o?.forEach(a=>a.removeEventListener("focusin",l,!1))}},[r,e,t])}function W(r){let e=b.getTreeNode(h);for(;e&&e.scopeRef!==r;){if(e.nodeToRestore)return!1;e=e.parent}return e?.scopeRef===r}function oe(r,e,t){const o=$.useRef(typeof document<"u"?m(E(r.current?r.current[0]:void 0)):null);k(()=>{let n=r.current;const l=E(n?n[0]:void 0);if(!e||t)return;let a=()=>{(!h||C(h,r))&&T(m(l),r.current)&&(h=r)};return l.addEventListener("focusin",a,!1),n?.forEach(i=>i.addEventListener("focusin",a,!1)),()=>{l.removeEventListener("focusin",a,!1),n?.forEach(i=>i.removeEventListener("focusin",a,!1))}},[r,t]),k(()=>{const n=E(r.current?r.current[0]:void 0);if(!e)return;let l=a=>{if(a.key!=="Tab"||a.altKey||a.ctrlKey||a.metaKey||!F(r)||a.isComposing)return;let i=n.activeElement;if(!x(i,r)||!W(r))return;let f=b.getTreeNode(r);if(!f)return;let u=f.nodeToRestore,d=w(n.body,{tabbable:!0});d.currentNode=i;let c=a.shiftKey?d.previousNode():d.nextNode();if((!u||!u.isConnected||u===n.body)&&(u=void 0,f.nodeToRestore=void 0),(!c||!x(c,r))&&u){d.currentNode=u;do c=a.shiftKey?d.previousNode():d.nextNode();while(x(c,r));a.preventDefault(),a.stopPropagation(),c?p(c,!0):U(u)?p(u,!0):i.blur()}};return t||n.addEventListener("keydown",l,!0),()=>{t||n.removeEventListener("keydown",l,!0)}},[r,e,t]),k(()=>{const n=E(r.current?r.current[0]:void 0);if(!e)return;let l=b.getTreeNode(r);if(l){var a;return l.nodeToRestore=(a=o.current)!==null&&a!==void 0?a:void 0,()=>{let i=b.getTreeNode(r);if(!i)return;let f=i.nodeToRestore,u=m(n);if(e&&f&&(u&&x(u,r)||u===n.body&&W(r))){let d=b.clone();requestAnimationFrame(()=>{if(n.activeElement===n.body){let c=d.getTreeNode(r);for(;c;){if(c.nodeToRestore&&c.nodeToRestore.isConnected){z(c.nodeToRestore);return}c=c.parent}for(c=d.getTreeNode(r);c;){if(c.scopeRef&&c.scopeRef.current&&b.getTreeNode(c.scopeRef)){let s=q(c.scopeRef.current,!0);z(s);return}c=c.parent}}})}}}},[r,e])}function z(r){r.dispatchEvent(new CustomEvent(I,{bubbles:!0,cancelable:!0}))&&p(r)}function w(r,e,t){let o=e?.tabbable?H:j,n=r?.nodeType===Node.ELEMENT_NODE?r:null,l=E(n),a=Y(l,r||l,NodeFilter.SHOW_ELEMENT,{acceptNode(i){var f;return!(e==null||(f=e.from)===null||f===void 0)&&f.contains(i)||e?.tabbable&&i.tagName==="INPUT"&&i.getAttribute("type")==="radio"&&(!O(i)||a.currentNode.tagName==="INPUT"&&a.currentNode.type==="radio"&&a.currentNode.name===i.name)?NodeFilter.FILTER_REJECT:o(i)&&(!t||T(i,t))&&(!e?.accept||e.accept(i))?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});return e?.from&&(a.currentNode=e.from),a}function de(r,e={}){return{focusNext(t={}){let o=r.current;if(!o)return null;let{from:n,tabbable:l=e.tabbable,wrap:a=e.wrap,accept:i=e.accept}=t,f=n||m(E(o)),u=w(o,{tabbable:l,accept:i});o.contains(f)&&(u.currentNode=f);let d=u.nextNode();return!d&&a&&(u.currentNode=o,d=u.nextNode()),d&&p(d,!0),d},focusPrevious(t=e){let o=r.current;if(!o)return null;let{from:n,tabbable:l=e.tabbable,wrap:a=e.wrap,accept:i=e.accept}=t,f=n||m(E(o)),u=w(o,{tabbable:l,accept:i});if(o.contains(f))u.currentNode=f;else{let c=L(u);return c&&p(c,!0),c??null}let d=u.previousNode();if(!d&&a){u.currentNode=o;let c=L(u);if(!c)return null;d=c}return d&&p(d,!0),d??null},focusFirst(t=e){let o=r.current;if(!o)return null;let{tabbable:n=e.tabbable,accept:l=e.accept}=t,i=w(o,{tabbable:n,accept:l}).nextNode();return i&&p(i,!0),i},focusLast(t=e){let o=r.current;if(!o)return null;let{tabbable:n=e.tabbable,accept:l=e.accept}=t,a=w(o,{tabbable:n,accept:l}),i=L(a);return i&&p(i,!0),i??null}}}function L(r){let e,t;do t=r.lastChild(),t&&(e=t);while(t);return e}class P{get size(){return this.fastMap.size}getTreeNode(e){return this.fastMap.get(e)}addTreeNode(e,t,o){let n=this.fastMap.get(t??null);if(!n)return;let l=new A({scopeRef:e});n.addChild(l),l.parent=n,this.fastMap.set(e,l),o&&(l.nodeToRestore=o)}addNode(e){this.fastMap.set(e.scopeRef,e)}removeTreeNode(e){if(e===null)return;let t=this.fastMap.get(e);if(!t)return;let o=t.parent;for(let l of this.traverse())l!==t&&t.nodeToRestore&&l.nodeToRestore&&t.scopeRef&&t.scopeRef.current&&T(l.nodeToRestore,t.scopeRef.current)&&(l.nodeToRestore=t.nodeToRestore);let n=t.children;o&&(o.removeChild(t),n.size>0&&n.forEach(l=>o&&o.addChild(l))),this.fastMap.delete(t.scopeRef)}*traverse(e=this.root){if(e.scopeRef!=null&&(yield e),e.children.size>0)for(let t of e.children)yield*this.traverse(t)}clone(){var e;let t=new P;var o;for(let n of this.traverse())t.addTreeNode(n.scopeRef,(o=(e=n.parent)===null||e===void 0?void 0:e.scopeRef)!==null&&o!==void 0?o:null,n.nodeToRestore);return t}constructor(){this.fastMap=new Map,this.root=new A({scopeRef:null}),this.fastMap.set(null,this.root)}}class A{addChild(e){this.children.add(e),e.parent=this}removeChild(e){this.children.delete(e),e.parent=void 0}constructor(e){this.children=new Set,this.contain=!1,this.scopeRef=e.scopeRef}}let b=new P;const ne=$.createContext(null);function se(r){let e=$.useRef({});return _.createElement(ne.Provider,{value:e},r.children)}const fe=$.createContext({isSelected:!1});export{w as $,fe as a,ue as b,se as c,de as d,ce as e};
