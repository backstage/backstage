import{r,a7 as Ce,j as C,H as Re}from"./iframe-B1bS8kNu.js";import{c as _}from"./clsx-B-dksMZM.js";import{u as K}from"./useStyles-CdqC6JSo.js";import{u as I,a as T,b as W,N as xe,c as $,m as V,d as X}from"./useEventCallback-_44Eknrx.js";import{V as ye,f as Pe}from"./index-CYRNriET.js";import{B as Ne}from"./Box-D8Q7l5DR.js";import{B as Ee}from"./Button-BrJj6XYZ.js";import{T as B}from"./Text-CY-xFuS6.js";import"./preload-helper-D9Z9MdNV.js";import"./Button-CRYlP5od.js";import"./utils-Ct9nIYhz.js";import"./Hidden-C8ZNz1al.js";import"./useFocusRing-BWaXYjK-.js";import"./usePress-PLs-ahDg.js";import"./Button.module-BHYJStbY.js";function Se({controlled:e,default:n,name:t,state:s="value"}){const{current:o}=r.useRef(e!==void 0),[l,f]=r.useState(n),p=o?e:l,u=r.useCallback(g=>{o||f(g)},[]);return[p,u]}function we(e,n=!1){const[t,s]=r.useState(),[o,l]=r.useState(e);return e&&!o&&(l(!0),t!=="starting"&&!n&&s("starting")),!e&&o&&t!=="ending"&&s("ending"),!e&&!o&&t==="ending"&&s(void 0),I(()=>{if(!e)return;n&&s("starting");const f=requestAnimationFrame(()=>{s(void 0)});return()=>{cancelAnimationFrame(f)}},[e,n]),r.useMemo(()=>({mounted:o,setMounted:l,transitionStatus:t}),[o,t])}let Z=0;function Oe(e,n="mui"){const[t,s]=r.useState(e),o=e||t;return r.useEffect(()=>{t==null&&(Z+=1,s(`${n}-${Z}`))},[t,n]),o}const Ie={...Ce},ee=Ie.useId;function Te(e,n){if(ee!==void 0){const t=ee();return e??(n?`${n}-${t}`:t)}return Oe(e,n)}function se(e){return Te(e,"base-ui")}function ve(e){const{open:n,defaultOpen:t,onOpenChange:s,disabled:o}=e,[l,f]=Se({controlled:n,default:t,name:"Collapsible",state:"open"}),{mounted:p,setMounted:u,transitionStatus:g}=we(l,!0),[m,c]=r.useState(se()),b=T(h=>{s?.(h),f(h)});return r.useMemo(()=>({panelId:m,disabled:o,mounted:p,open:l,setPanelId:c,setMounted:u,setOpen:b,transitionStatus:g}),[m,o,p,l,c,u,b,g])}const L=r.createContext(void 0);function re(){const e=r.useContext(L);if(e===void 0)throw new Error("Base UI: CollapsibleRootContext is missing. Collapsible parts must be placed within <Collapsible.Root>.");return e}const Me={"data-open":""},De={"data-closed":""},Ae={open(e){return e?{"data-panel-open":""}:null}},ke={open(e){return e?Me:De}},Be={"data-starting-style":""},Fe={"data-ending-style":""},Ue={transitionStatus(e){return e==="starting"?Be:e==="ending"?Fe:null}},ae={...ke,...Ue},ie=r.forwardRef(function(n,t){const{children:s,className:o,defaultOpen:l=!1,disabled:f=!1,onOpenChange:p,open:u,render:g,...m}=n,c=ve({open:u,defaultOpen:l,onOpenChange:p??xe,disabled:f}),b=r.useMemo(()=>({open:c.open,disabled:c.disabled,transitionStatus:c.transitionStatus}),[c.open,c.disabled,c.transitionStatus]),h=r.useMemo(()=>({...c,state:b}),[c,b]),{renderElement:x}=W({render:g??"div",className:o,state:b,ref:t,extraProps:{children:s,...m},customStyleHookMapping:ae});return g!==null?C.jsx(L.Provider,{value:h,children:x()}):C.jsx(L.Provider,{value:h,children:s})});function He(e){const{rootElementName:n=""}=e,[t,s]=r.useState(n.toUpperCase()),o=r.useCallback(l=>{s(l?.tagName??"")},[]);return{rootElementName:t,updateRootElementName:o}}const Le=r.createContext(void 0);function je(e=!1){const n=r.useContext(Le);if(n===void 0&&!e)throw new Error("Base UI: CompositeRootContext is missing. Composite parts must be placed within <Composite.Root>.");return n}function _e(e={}){const{buttonRef:n,disabled:t=!1,focusableWhenDisabled:s,tabIndex:o,type:l,elementName:f}=e,p=r.useRef(null),{rootElementName:u,updateRootElementName:g}=He({rootElementName:f}),m=je(!0)!==void 0,c=T(()=>{const d=p.current;return u==="BUTTON"||u==="INPUT"&&["button","submit","reset"].includes(d?.type)}),b=T(()=>{const d=p.current;return!!(u==="A"&&d?.href)}),h=$(g,n,p),x=r.useMemo(()=>{const d={};return o!==void 0&&!m&&(d.tabIndex=o),u==="BUTTON"||u==="INPUT"?s||m?d["aria-disabled"]=t:m||(d.disabled=t):u!==""&&(u!=="A"?(d.role="button",m||(d.tabIndex=o??0)):o&&!m&&(d.tabIndex=o),t&&(d["aria-disabled"]=t,m||(d.tabIndex=s?o??0:-1))),d},[t,u,s,m,o]);return I(()=>{const d=p.current;d instanceof HTMLButtonElement&&m&&t&&x.disabled===void 0&&d.disabled&&(d.disabled=!1)},[t,x.disabled,m]),{getButtonProps:r.useCallback((d={})=>{const{onClick:N,onMouseDown:w,onKeyUp:S,onKeyDown:O,onPointerDown:y,...v}=d;return V({type:l,onClick(a){if(t){a.preventDefault();return}N?.(a)},onMouseDown(a){t||w?.(a)},onKeyDown(a){(t&&s&&a.key!=="Tab"||a.target===a.currentTarget&&!c()&&a.key===" ")&&a.preventDefault(),t||(X(a),O?.(a)),!a.baseUIHandlerPrevented&&a.target===a.currentTarget&&!c()&&!b()&&a.key==="Enter"&&!t&&(N?.(a),a.preventDefault())},onKeyUp(a){t||(X(a),S?.(a)),!a.baseUIHandlerPrevented&&a.target===a.currentTarget&&!c()&&!t&&a.key===" "&&N?.(a)},onPointerDown(a){if(t){a.preventDefault();return}y?.(a)},ref:h},x,v)},[x,t,s,c,b,h,l]),buttonRef:h}}function Ke(e){const{panelId:n,disabled:t,open:s,rootRef:o,setOpen:l}=e,{getButtonProps:f,buttonRef:p}=_e({disabled:t,focusableWhenDisabled:!0,type:"button"}),u=$(o,p);return{getRootProps:r.useCallback((m={})=>V({type:"button","aria-controls":n,"aria-expanded":s,disabled:t,onClick(){l(!s)},ref:u},m,f),[n,t,f,u,s,l])}}const le=r.forwardRef(function(n,t){const{panelId:s,open:o,setOpen:l,state:f,disabled:p}=re(),{className:u,disabled:g=p,id:m,render:c,...b}=n,{getRootProps:h}=Ke({disabled:g,panelId:s,open:o,setOpen:l,rootRef:t}),{renderElement:x}=W({propGetter:h,render:c??"button",state:f,className:u,extraProps:b,customStyleHookMapping:Ae});return x()});let F=null,U;function We(){return F==null&&(F=document.createElement("div")),U===void 0&&(U=F.computedStyleMap!==void 0),U}function $e(e){return e&&e.ownerDocument||document}function ue(e){return $e(e).defaultView||window}function Ve(e,n=!1){const t=r.useRef(-1),s=r.useRef(-1),o=T(()=>{cancelAnimationFrame(t.current),clearTimeout(s.current)});return r.useEffect(()=>o,[o]),T(l=>{o();const f=e.current;f&&(typeof f.getAnimations!="function"||globalThis.BASE_UI_ANIMATIONS_DISABLED?l():t.current=requestAnimationFrame(()=>{function p(){f&&Promise.allSettled(f.getAnimations().map(u=>u.finished)).then(()=>{Re.flushSync(l)})}n?s.current=window.setTimeout(p):p()}))})}const qe=[];function te(e){r.useEffect(e,qe)}function Ge(e){return We()?e.computedStyleMap().get("animation-name")?.value??void 0:ue(e).getComputedStyle(e).animationName}let H;function ne(e){if(H===void 0){const n=typeof CSS<"u"&&typeof CSS.supports=="function"&&CSS.supports("content-visibility","hidden"),t="onbeforematch"in ue(e);H=n&&t}return H}function ze(e){const{hiddenUntilFound:n,panelId:t,keepMounted:s,open:o,mounted:l,ref:f,setPanelId:p,setMounted:u,setOpen:g}=e,m=se(t),c=r.useRef(null),[{height:b,width:h},x]=r.useState({height:0,width:0}),D=r.useRef("none"),d=r.useRef(null),N=r.useRef(!1);I(()=>(p(!s&&!o?void 0:m),()=>{p(void 0)}),[m,p,s,o]);const w=T(i=>{if(!i)return;c.current=i;const R=Ge(i);D.current=R??"none",d.current=i.style.transitionDuration}),S=$(f,w),O=Ve(c),y=o||l,v=r.useRef(!1),a=r.useRef(y),k=r.useCallback(()=>{const i=c.current;if(!i)return;function R(){N.current=!0}function P(){N.current=!1}function E(){N.current=!1}return i.addEventListener("transitioncancel",E),i.addEventListener("transitionend",P),i.addEventListener("transitionrun",R),()=>{i.removeEventListener("transitioncancel",E),i.removeEventListener("transitionend",P),i.removeEventListener("transitionrun",R)}},[]);I(()=>{const{current:i}=c;let R=-1,P=-1;if(i){const E=v.current,me=a.current,be=N.current,ge=i.style.animationName==="none"?"":i.style.animationName,he=d.current,Y=E||me;i.style.animationName="none";const J=!o&&!l;if(!be||J){s||k();const Q=J?{height:0,width:0}:i.getBoundingClientRect();x({height:Q.height,width:Q.width})}i.style.animationName=Y?"none":ge,i.style.transitionDuration=Y?"0s":he??"",O(()=>{u(o),E&&(v.current=!1,R=requestAnimationFrame(()=>{P=requestAnimationFrame(()=>{i.style.transitionDuration=d.current??""})}))})}return()=>{cancelAnimationFrame(R),cancelAnimationFrame(P)}},[l,s,o,k,O,u,p]),te(()=>{const i=c.current;let R=-1,P=-1;const E=requestAnimationFrame(()=>{a.current=!1,i&&(R=requestAnimationFrame(()=>{P=requestAnimationFrame(()=>{i.style.transitionDuration=d.current??""})}))});return()=>{cancelAnimationFrame(E),cancelAnimationFrame(R),cancelAnimationFrame(P)}}),te(k),r.useEffect(function(){const{current:R}=c;if(!R||!ne(R))return;function P(E){E.preventDefault(),v.current=!0,g(!0)}return R.addEventListener("beforematch",P),()=>{R.removeEventListener("beforematch",P)}},[g]),I(()=>{const{current:i}=c;i&&ne(i)&&i?.hidden&&!y&&n===!0&&(i.hidden="until-found")},[n,y]);const G=n?"until-found":"hidden",z=r.useCallback((i={})=>V({id:m,hidden:y?void 0:!!G,ref:S},i),[G,m,y,S]);return r.useMemo(()=>({getRootProps:z,height:b,width:h,isOpen:y}),[z,b,h,y])}let oe=function(e){return e.collapsiblePanelHeight="--collapsible-panel-height",e.collapsiblePanelWidth="--collapsible-panel-width",e}({});const ce=r.forwardRef(function(n,t){const{className:s,hiddenUntilFound:o,id:l,keepMounted:f,render:p,...u}=n,{mounted:g,open:m,panelId:c,setPanelId:b,setMounted:h,setOpen:x,state:D}=re();I(()=>{l&&b(l)},[l,b]);const d=o??!1,{getRootProps:N,height:w,width:S,isOpen:O}=ze({hiddenUntilFound:d,panelId:c,keepMounted:f??!1,mounted:g,open:m,ref:t,setPanelId:b,setMounted:h,setOpen:x}),{renderElement:y}=W({propGetter:N,render:p??"div",state:D,className:s,extraProps:{...u,style:{...u.style,[oe.collapsiblePanelHeight]:w?`${w}px`:void 0,[oe.collapsiblePanelWidth]:S?`${S}px`:void 0}},customStyleHookMapping:ae});return!f&&!O&&!d?null:y()}),q={"bui-CollapsiblePanel":"_bui-CollapsiblePanel_1ak39_20"},de=r.forwardRef(({className:e,...n},t)=>{const{classNames:s,cleanedProps:o}=K("Collapsible",n);return C.jsx(ie,{ref:t,className:_(s.root,q[s.root],e),...o})});de.displayName=ie.displayName;const pe=r.forwardRef(({className:e,...n},t)=>{const{classNames:s,cleanedProps:o}=K("Collapsible",n);return C.jsx(le,{ref:t,className:_(s.trigger,q[s.trigger],e),...o})});pe.displayName=le.displayName;const fe=r.forwardRef(({className:e,...n},t)=>{const{classNames:s,cleanedProps:o}=K("Collapsible",n);return C.jsx(ce,{ref:t,className:_(s.panel,q[s.panel],e),...o})});fe.displayName=ce.displayName;const j={Root:de,Trigger:pe,Panel:fe},ct={title:"Backstage UI/Collapsible",component:j.Root},M={args:{style:{display:"flex",flexDirection:"column",gap:"var(--bui-space-2)",alignItems:"center"},children:C.jsxs(C.Fragment,{children:[C.jsx(j.Trigger,{render:(e,n)=>C.jsx(Ee,{variant:"secondary",iconEnd:n.open?C.jsx(ye,{}):C.jsx(Pe,{}),...e,children:n.open?"Close Panel":"Open Panel"})}),C.jsx(j.Panel,{children:C.jsxs(Ne,{p:"4",style:{border:"1px solid var(--bui-border)",backgroundColor:"var(--bui-bg-surface-1)",color:"var(--bui-fg-primary)",borderRadius:"var(--bui-radius-2)",width:"460px"},children:[C.jsx(B,{children:"It's the edge of the world and all of Western civilization"}),C.jsx(B,{children:"The sun may rise in the East, at least it settled in a final location"}),C.jsx(B,{children:"It's understood that Hollywood sells Californication"})]})})]})}},A={args:{...M.args,defaultOpen:!0}};M.parameters={...M.parameters,docs:{...M.parameters?.docs,source:{originalSource:`{
  args: {
    style: {
      display: 'flex',
      flexDirection: 'column',
      gap: 'var(--bui-space-2)',
      alignItems: 'center'
    },
    children: <>
        <Collapsible.Trigger render={(props, state) => <Button variant="secondary" iconEnd={state.open ? <RiArrowUpSLine /> : <RiArrowDownSLine />} {...props}>
              {state.open ? 'Close Panel' : 'Open Panel'}
            </Button>} />
        <Collapsible.Panel>
          <Box p="4" style={{
          border: '1px solid var(--bui-border)',
          backgroundColor: 'var(--bui-bg-surface-1)',
          color: 'var(--bui-fg-primary)',
          borderRadius: 'var(--bui-radius-2)',
          width: '460px'
        }}>
            <Text>
              It's the edge of the world and all of Western civilization
            </Text>
            <Text>
              The sun may rise in the East, at least it settled in a final
              location
            </Text>
            <Text>It's understood that Hollywood sells Californication</Text>
          </Box>
        </Collapsible.Panel>
      </>
  }
}`,...M.parameters?.docs?.source}}};A.parameters={...A.parameters,docs:{...A.parameters?.docs,source:{originalSource:`{
  args: {
    ...Default.args,
    defaultOpen: true
  }
}`,...A.parameters?.docs?.source}}};const dt=["Default","Open"];export{M as Default,A as Open,dt as __namedExportsOrder,ct as default};
