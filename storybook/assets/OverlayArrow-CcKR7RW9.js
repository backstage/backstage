import{b as ue,z as pe,$ as me}from"./useFocusable-BwFERnd_.js";import{b as G}from"./Button-Dkbd3KcU.js";import{r as _,R as ve}from"./iframe-M9O-K8SB.js";import{b as q}from"./useObjectRef-BPFp5snO.js";import{$ as ge}from"./context-Bv6kxITJ.js";import{$ as $e}from"./useControlledState-DzBnLbpE.js";import{$ as he,a as be}from"./utils-BXllfVt4.js";function xe(){return typeof window.ResizeObserver<"u"}function D(t){const{ref:e,box:l,onResize:n}=t;let o=ue(n);_.useEffect(()=>{let r=e?.current;if(r)if(xe()){const a=new window.ResizeObserver(s=>{s.length&&o()});return a.observe(r,{box:l}),()=>{r&&a.unobserve(r)}}else return window.addEventListener("resize",o,!1),()=>{window.removeEventListener("resize",o,!1)}},[e,l])}const y={top:"top",bottom:"top",left:"left",right:"left"},j={top:"bottom",bottom:"top",left:"right",right:"left"},Ee={top:"left",left:"top"},J={top:"height",left:"width"},ne={width:"totalWidth",height:"totalHeight"},Z={};let Pe=()=>typeof document<"u"?window.visualViewport:null;function V(t,e){let l=0,n=0,o=0,r=0,a=0,s=0,u={};var f;let p=((f=e?.scale)!==null&&f!==void 0?f:1)>1;if(t.tagName==="BODY"||t.tagName==="HTML"){let $=document.documentElement;o=$.clientWidth,r=$.clientHeight;var h;l=(h=e?.width)!==null&&h!==void 0?h:o;var g;n=(g=e?.height)!==null&&g!==void 0?g:r,u.top=$.scrollTop||t.scrollTop,u.left=$.scrollLeft||t.scrollLeft,e&&(a=e.offsetTop,s=e.offsetLeft)}else({width:l,height:n,top:a,left:s}=Y(t,!1)),u.top=t.scrollTop,u.left=t.scrollLeft,o=l,r=n;if(pe()&&(t.tagName==="BODY"||t.tagName==="HTML")&&p){u.top=0,u.left=0;var m;a=(m=e?.pageTop)!==null&&m!==void 0?m:0;var c;s=(c=e?.pageLeft)!==null&&c!==void 0?c:0}return{width:l,height:n,totalWidth:o,totalHeight:r,scroll:u,top:a,left:s}}function Ce(t){return{top:t.scrollTop,left:t.scrollLeft,width:t.scrollWidth,height:t.scrollHeight}}function ee(t,e,l,n,o,r,a){var s;let u=(s=o.scroll[t])!==null&&s!==void 0?s:0,f=n[J[t]],p=a[t]+n.scroll[y[t]]+r,h=a[t]+n.scroll[y[t]]+f-r,g=e-u+n.scroll[y[t]]+a[t]-n[y[t]],m=e-u+l+n.scroll[y[t]]+a[t]-n[y[t]];return g<p?p-g:m>h?Math.max(h-m,p-g):0}function we(t){let e=window.getComputedStyle(t);return{top:parseInt(e.marginTop,10)||0,bottom:parseInt(e.marginBottom,10)||0,left:parseInt(e.marginLeft,10)||0,right:parseInt(e.marginRight,10)||0}}function te(t){if(Z[t])return Z[t];let[e,l]=t.split(" "),n=y[e]||"right",o=Ee[n];y[l]||(l="center");let r=J[n],a=J[o];return Z[t]={placement:e,crossPlacement:l,axis:n,crossAxis:o,size:r,crossSize:a},Z[t]}function B(t,e,l,n,o,r,a,s,u,f,p){let{placement:h,crossPlacement:g,axis:m,crossAxis:c,size:$,crossSize:x}=n,P={};var i;P[c]=(i=t[c])!==null&&i!==void 0?i:0;var L,d,b,v;g==="center"?P[c]+=(((L=t[x])!==null&&L!==void 0?L:0)-((d=l[x])!==null&&d!==void 0?d:0))/2:g!==c&&(P[c]+=((b=t[x])!==null&&b!==void 0?b:0)-((v=l[x])!==null&&v!==void 0?v:0)),P[c]+=r;const w=t[c]-l[x]+u+f,C=t[c]+t[x]-u-f;if(P[c]=G(P[c],w,C),h===m){let S=s?p[$]:p[ne[$]];P[j[m]]=Math.floor(S-t[m]+o)}else P[m]=Math.floor(t[m]+t[$]+o);return P}function Te(t,e,l,n,o,r,a,s,u,f,p){var h,g;let m=(t.top!=null?t.top:u[ne.height]-((h=t.bottom)!==null&&h!==void 0?h:0)-a)-((g=u.scroll.top)!==null&&g!==void 0?g:0),c=f?l.top:0;var $,x,P;let i={top:Math.max(e.top+c,(($=p?.offsetTop)!==null&&$!==void 0?$:e.top)+c),bottom:Math.min(e.top+e.height+c,((x=p?.offsetTop)!==null&&x!==void 0?x:0)+((P=p?.height)!==null&&P!==void 0?P:0))};var L,d,b,v;return s!=="top"?Math.max(0,i.bottom-m-(((L=o.top)!==null&&L!==void 0?L:0)+((d=o.bottom)!==null&&d!==void 0?d:0)+r)):Math.max(0,m+a-i.top-(((b=o.top)!==null&&b!==void 0?b:0)+((v=o.bottom)!==null&&v!==void 0?v:0)+r))}function le(t,e,l,n,o,r,a,s){let{placement:u,axis:f,size:p}=r;var h,g;if(u===f)return Math.max(0,l[f]-((h=a.scroll[f])!==null&&h!==void 0?h:0)-(t[f]+(s?e[f]:0))-((g=n[f])!==null&&g!==void 0?g:0)-n[j[f]]-o);var m,c;return Math.max(0,t[p]+t[f]+(s?e[f]:0)-l[f]-l[p]+((m=a.scroll[f])!==null&&m!==void 0?m:0)-((c=n[f])!==null&&c!==void 0?c:0)-n[j[f]]-o)}function Le(t,e,l,n,o,r,a,s,u,f,p,h,g,m,c,$,x,P){let i=te(t),{size:L,crossAxis:d,crossSize:b,placement:v,crossPlacement:w}=i,C=B(e,s,l,i,p,h,f,g,c,$,u),S=p,F=le(s,f,e,o,r+p,i,u,x);if(a&&l[L]>F){let W=te(`${j[v]} ${w}`),de=B(e,s,l,W,p,h,f,g,c,$,u);le(s,f,e,o,r+p,W,u,x)>F&&(i=W,C=de,S=p)}let I="bottom";i.axis==="top"?i.placement==="top"?I="top":i.placement==="bottom"&&(I="bottom"):i.crossAxis==="top"&&(i.crossPlacement==="top"?I="bottom":i.crossPlacement==="bottom"&&(I="top"));let T=ee(d,C[d],l[b],s,u,r,f);C[d]+=T;let H=Te(C,s,f,g,o,r,l.height,I,u,x,P);m&&m<H&&(H=m),l.height=Math.min(l.height,H),C=B(e,s,l,i,S,h,f,g,c,$,u),T=ee(d,C[d],l[b],s,u,r,f),C[d]+=T;let z={},A=e[d]-C[d]-o[y[d]],M=A+.5*e[b];const X=c/2+$;var N,O,R,k;const U=y[d]==="left"?((N=o.left)!==null&&N!==void 0?N:0)+((O=o.right)!==null&&O!==void 0?O:0):((R=o.top)!==null&&R!==void 0?R:0)+((k=o.bottom)!==null&&k!==void 0?k:0),ie=l[b]-U-c/2-$,ae=e[d]+c/2-(C[d]+o[y[d]]),ce=e[d]+e[b]-c/2-(C[d]+o[y[d]]),se=G(M,ae,ce);z[d]=G(se,X,ie),{placement:v,crossPlacement:w}=i,c?A=z[d]:w==="right"?A+=e[b]:w==="center"&&(A+=e[b]/2);let Q=v==="left"||v==="top"?l[L]:0,fe={x:v==="top"||v==="bottom"?A:Q,y:v==="left"||v==="right"?A:Q};return{position:C,maxHeight:H,arrowOffsetLeft:z.left,arrowOffsetTop:z.top,placement:v,triggerAnchorPoint:fe}}function Re(t){let{placement:e,targetNode:l,overlayNode:n,scrollNode:o,padding:r,shouldFlip:a,boundaryElement:s,offset:u,crossOffset:f,maxHeight:p,arrowSize:h=0,arrowBoundaryOffset:g=0}=t,m=Pe(),c=n instanceof HTMLElement?_e(n):document.documentElement,$=c===document.documentElement;const x=window.getComputedStyle(c).position;let P=!!x&&x!=="static",i=$?Y(l,!1):oe(l,c,!1);if(!$){let{marginTop:z,marginLeft:A}=window.getComputedStyle(l);i.top+=parseInt(z,10)||0,i.left+=parseInt(A,10)||0}let L=Y(n,!0),d=we(n);var b,v;L.width+=((b=d.left)!==null&&b!==void 0?b:0)+((v=d.right)!==null&&v!==void 0?v:0);var w,C;L.height+=((w=d.top)!==null&&w!==void 0?w:0)+((C=d.bottom)!==null&&C!==void 0?C:0);let S=Ce(o),F=V(s,m),I=V(c,m),T=oe(s,c,!1),H=s.contains(c);return Le(e,i,L,S,d,r,a,F,I,T,u,f,P,p,h,g,H,m)}function K(t,e){let{top:l,left:n,width:o,height:r}=t.getBoundingClientRect();return e&&t instanceof t.ownerDocument.defaultView.HTMLElement&&(o=t.offsetWidth,r=t.offsetHeight),{top:l,left:n,width:o,height:r}}function Y(t,e){let{top:l,left:n,width:o,height:r}=K(t,e),{scrollTop:a,scrollLeft:s,clientTop:u,clientLeft:f}=document.documentElement;return{top:l+a-u,left:n+s-f,width:o,height:r}}function oe(t,e,l){let n=window.getComputedStyle(t),o;if(n.position==="fixed")o=K(t,l);else{o=Y(t,l);let r=Y(e,l),a=window.getComputedStyle(e);r.top+=(parseInt(a.borderTopWidth,10)||0)-e.scrollTop,r.left+=(parseInt(a.borderLeftWidth,10)||0)-e.scrollLeft,o.top-=r.top,o.left-=r.left}return o.top-=parseInt(n.marginTop,10)||0,o.left-=parseInt(n.marginLeft,10)||0,o}function _e(t){let e=t.offsetParent;if(e&&e===document.body&&window.getComputedStyle(e).position==="static"&&!re(e)&&(e=document.documentElement),e==null)for(e=t.parentElement;e&&!re(e);)e=e.parentElement;return e||document.documentElement}function re(t){let e=window.getComputedStyle(t);return e.transform!=="none"||/transform|perspective/.test(e.willChange)||e.filter!=="none"||e.contain==="paint"||"backdropFilter"in e&&e.backdropFilter!=="none"||"WebkitBackdropFilter"in e&&e.WebkitBackdropFilter!=="none"}const He=new WeakMap;function ze(t){let{triggerRef:e,isOpen:l,onClose:n}=t;_.useEffect(()=>{if(!l||n===null)return;let o=r=>{let a=r.target;if(!e.current||a instanceof Node&&!a.contains(e.current)||r.target instanceof HTMLInputElement||r.target instanceof HTMLTextAreaElement)return;let s=n||He.get(e.current);s&&s()};return window.addEventListener("scroll",o,!0),()=>{window.removeEventListener("scroll",o,!0)}},[l,n,e])}let E=typeof document<"u"?window.visualViewport:null;function je(t){let{direction:e}=ge(),{arrowSize:l,targetRef:n,overlayRef:o,arrowRef:r,scrollRef:a=o,placement:s="bottom",containerPadding:u=12,shouldFlip:f=!0,boundaryElement:p=typeof document<"u"?document.body:null,offset:h=0,crossOffset:g=0,shouldUpdatePosition:m=!0,isOpen:c=!0,onClose:$,maxHeight:x,arrowBoundaryOffset:P=0}=t,[i,L]=_.useState(null),d=[m,s,o.current,n.current,r?.current,a.current,u,f,p,h,g,c,e,x,P,l],b=_.useRef(E?.scale);_.useEffect(()=>{c&&(b.current=E?.scale)},[c]);let v=_.useCallback(()=>{if(m===!1||!c||!o.current||!n.current||!p||E?.scale!==b.current)return;let T=null;if(a.current&&a.current.contains(document.activeElement)){var H;let R=(H=document.activeElement)===null||H===void 0?void 0:H.getBoundingClientRect(),k=a.current.getBoundingClientRect();var z;if(T={type:"top",offset:((z=R?.top)!==null&&z!==void 0?z:0)-k.top},T.offset>k.height/2){T.type="bottom";var A;T.offset=((A=R?.bottom)!==null&&A!==void 0?A:0)-k.bottom}}let M=o.current;if(!x&&o.current){var X;M.style.top="0px",M.style.bottom="";var N;M.style.maxHeight=((N=(X=window.visualViewport)===null||X===void 0?void 0:X.height)!==null&&N!==void 0?N:window.innerHeight)+"px"}let O=Re({placement:ye(s,e),overlayNode:o.current,targetNode:n.current,scrollNode:a.current||o.current,padding:u,shouldFlip:f,boundaryElement:p,offset:h,crossOffset:g,maxHeight:x,arrowSize:l??(r?.current?K(r.current,!0).width:0),arrowBoundaryOffset:P});if(O.position){if(M.style.top="",M.style.bottom="",M.style.left="",M.style.right="",Object.keys(O.position).forEach(R=>M.style[R]=O.position[R]+"px"),M.style.maxHeight=O.maxHeight!=null?O.maxHeight+"px":"",T&&document.activeElement&&a.current){let R=document.activeElement.getBoundingClientRect(),k=a.current.getBoundingClientRect(),U=R[T.type]-k[T.type];a.current.scrollTop+=U-T.offset}L(O)}},d);q(v,d),Ae(v),D({ref:o,onResize:v}),D({ref:n,onResize:v});let w=_.useRef(!1);q(()=>{let T,H=()=>{w.current=!0,clearTimeout(T),T=setTimeout(()=>{w.current=!1},500),v()},z=()=>{w.current&&H()};return E?.addEventListener("resize",H),E?.addEventListener("scroll",z),()=>{E?.removeEventListener("resize",H),E?.removeEventListener("scroll",z)}},[v]);let C=_.useCallback(()=>{w.current||$?.()},[$,w]);ze({triggerRef:n,isOpen:c,onClose:$&&C});var S,F,I;return{overlayProps:{style:{position:i?"absolute":"fixed",top:i?void 0:0,left:i?void 0:0,zIndex:1e5,...i?.position,maxHeight:(S=i?.maxHeight)!==null&&S!==void 0?S:"100vh"}},placement:(F=i?.placement)!==null&&F!==void 0?F:null,triggerAnchorPoint:(I=i?.triggerAnchorPoint)!==null&&I!==void 0?I:null,arrowProps:{"aria-hidden":"true",role:"presentation",style:{left:i?.arrowOffsetLeft,top:i?.arrowOffsetTop}},updatePosition:v}}function Ae(t){q(()=>(window.addEventListener("resize",t,!1),()=>{window.removeEventListener("resize",t,!1)}),[t])}function ye(t,e){return e==="rtl"?t.replace("start","right").replace("end","left"):t.replace("start","left").replace("end","right")}const Ie=_.createContext({});function Ue(){var t;return(t=_.useContext(Ie))!==null&&t!==void 0?t:{}}function We(t){let[e,l]=$e(t.isOpen,t.defaultOpen||!1,t.onOpenChange);const n=_.useCallback(()=>{l(!0)},[l]),o=_.useCallback(()=>{l(!1)},[l]),r=_.useCallback(()=>{l(!e)},[l,e]);return{isOpen:e,setOpen:l,open:n,close:o,toggle:r}}const Me=_.createContext({placement:"bottom"}),Be=_.forwardRef(function(e,l){[e,l]=he(e,l,Me);let n=e.placement,o={position:"absolute",transform:n==="top"||n==="bottom"?"translateX(-50%)":"translateY(-50%)"};n!=null&&(o[n]="100%");let r=be({...e,defaultClassName:"react-aria-OverlayArrow",values:{placement:n}});r.style&&Object.keys(r.style).forEach(s=>r.style[s]===void 0&&delete r.style[s]);let a=me(e);return ve.createElement("div",{...a,...r,style:{...o,...r.style},ref:l,"data-placement":n})});export{Be as $,We as a,Ue as b,je as c,Me as d,D as e,He as f};
