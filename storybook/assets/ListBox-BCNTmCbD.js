import{e as le,f as q,g as ie,h as re,i as ne,j as _,k as de,l as se}from"./SelectionManager-0uJxHsG8.js";import{$ as G,a as V,e as J,g as ce,c as ue}from"./utils-z8eUZOh4.js";import{r as s,a2 as u}from"./iframe-Du4yWFmh.js";import{$ as fe,a as $e,b as be,c as ve,d as ge,e as pe,f as me}from"./Separator-B52XnveC.js";import{c as xe}from"./RSPContexts-D_Pwck-t.js";import{a as he,b as Pe,c as De}from"./SelectionIndicator-BqsEK7dV.js";import{a as ye}from"./Text-ViNXGalI.js";import{a as Ee,d as Me,b as Q,$ as S,c as W,g as Ce,e as X}from"./useObjectRef-CiRgIA98.js";import{a as F,v as Se,w as we,j}from"./useFocusable-Dw78h-Dw.js";import{$ as Be,a as Fe,b as Le}from"./useListState-DOyHQgil.js";import{b as Ie}from"./usePress-qtOIFA-H.js";import{b as Ve,$ as Y,a as Oe}from"./useFocusRing-BvDmeMSb.js";import{$ as ke}from"./useLabel-CbYskFmA.js";import{$ as Te}from"./context-q9taPD0R.js";function Ue(t,e){let{collection:l,onLoadMore:o,scrollOffset:i=1}=t,r=s.useRef(null),a=Ee(n=>{for(let c of n)c.isIntersecting&&o&&o()});Me(()=>(e.current&&(r.current=new IntersectionObserver(a,{root:fe(e?.current),rootMargin:`0px ${100*i}% ${100*i}% ${100*i}%`}),r.current.observe(e.current)),()=>{r.current&&r.current.disconnect()}),[l,a,e,i])}const H=new WeakMap;function Ne(t){return typeof t=="string"?t.replace(/\s*/g,""):""+t}function Ae(t,e){let l=H.get(t);if(!l)throw new Error("Unknown list");return`${l.id}-option-${Ne(e)}`}function Ke(t,e,l){let o=F(t,{labelable:!0}),i=t.selectionBehavior||"toggle",r=t.linkBehavior||(i==="replace"?"action":"override");i==="toggle"&&r==="action"&&(r="override");let{listProps:a}=$e({...t,ref:l,selectionManager:e.selectionManager,collection:e.collection,disabledKeys:e.disabledKeys,linkBehavior:r}),{focusWithinProps:n}=Ve({onFocusWithin:t.onFocus,onBlurWithin:t.onBlur,onFocusWithinChange:t.onFocusChange}),c=Q(t.id);H.set(e,{id:c,shouldUseVirtualFocus:t.shouldUseVirtualFocus,shouldSelectOnPressUp:t.shouldSelectOnPressUp,shouldFocusOnHover:t.shouldFocusOnHover,isVirtualized:t.isVirtualized,onAction:t.onAction,linkBehavior:r,UNSTABLE_itemBehavior:t.UNSTABLE_itemBehavior});let{labelProps:$,fieldProps:b}=ke({...t,id:c,labelElementType:"span"});return{labelProps:$,listBoxProps:S(o,n,e.selectionManager.selectionMode==="multiple"?{"aria-multiselectable":"true"}:{},{role:"listbox",...S(b,a)})}}function ze(t,e,l){var o,i;let{key:r}=t,a=H.get(e);var n;let c=(n=t.isDisabled)!==null&&n!==void 0?n:e.selectionManager.isDisabled(r);var $;let b=($=t.isSelected)!==null&&$!==void 0?$:e.selectionManager.isSelected(r);var d;let f=(d=t.shouldSelectOnPressUp)!==null&&d!==void 0?d:a?.shouldSelectOnPressUp;var m;let g=(m=t.shouldFocusOnHover)!==null&&m!==void 0?m:a?.shouldFocusOnHover;var x;let p=(x=t.shouldUseVirtualFocus)!==null&&x!==void 0?x:a?.shouldUseVirtualFocus;var h;let M=(h=t.isVirtualized)!==null&&h!==void 0?h:a?.isVirtualized,w=W(),P=W(),y={role:"option","aria-disabled":c||void 0,"aria-selected":e.selectionManager.selectionMode!=="none"?b:void 0};Se()&&we()||(y["aria-label"]=t["aria-label"],y["aria-labelledby"]=w,y["aria-describedby"]=P);let v=e.collection.getItem(r);if(M){let E=Number(v?.index);y["aria-posinset"]=Number.isNaN(E)?void 0:E+1,y["aria-setsize"]=be(e.collection)}let D=a?.onAction?()=>{var E;return a==null||(E=a.onAction)===null||E===void 0?void 0:E.call(a,r)}:void 0,C=Ae(e,r),{itemProps:L,isPressed:k,isFocused:I,hasAction:K,allowsSelection:T}=le({selectionManager:e.selectionManager,key:r,ref:l,shouldSelectOnPressUp:f,allowsDifferentPressOrigin:f&&g,isVirtualized:M,shouldUseVirtualFocus:p,isDisabled:c,onAction:D||!(v==null||(o=v.props)===null||o===void 0)&&o.onAction?Ce(v==null||(i=v.props)===null||i===void 0?void 0:i.onAction,D):void 0,linkBehavior:a?.linkBehavior,UNSTABLE_itemBehavior:a?.UNSTABLE_itemBehavior,id:C}),{hoverProps:U}=Y({isDisabled:c||!g,onHoverStart(){j()||(e.selectionManager.setFocused(!0),e.selectionManager.setFocusedKey(r))}}),B=F(v?.props);delete B.id;let N=Ie(v?.props);return{optionProps:{...y,...S(B,L,U,N),id:C},labelProps:{id:w},descriptionProps:{id:P},isFocused:I,isFocusVisible:I&&e.selectionManager.isFocused&&j(),isSelected:b,isDisabled:c,isPressed:k,allowsSelection:T,hasAction:K}}function _e(t){let{heading:e,"aria-label":l}=t,o=Q();return{itemProps:{role:"presentation"},headingProps:e?{id:o,role:"presentation"}:{},groupProps:{role:"group","aria-label":l,"aria-labelledby":e?o:void 0}}}const A=s.createContext({}),Z=s.createContext(null),He=s.forwardRef(function(e,l){let{render:o}=s.useContext(Z);return u.createElement(u.Fragment,null,o(e,l))});function ee(t,e){var l;let o=t?.renderDropIndicator,i=t==null||(l=t.isVirtualDragging)===null||l===void 0?void 0:l.call(t),r=s.useCallback(a=>{if(i||e?.isDropTarget(a))return o?o(a):u.createElement(He,{target:a})},[e?.target,i,o]);return t?.useDropIndicator?r:void 0}function Re(t,e,l){var o,i;let r=t.focusedKey,a=null;if(!(e==null||(o=e.isVirtualDragging)===null||o===void 0)&&o.call(e)&&(l==null||(i=l.target)===null||i===void 0?void 0:i.type)==="item"&&(a=l.target.key,l.target.dropPosition==="after")){let d=l.collection.getKeyAfter(a),f=null;if(d!=null){var n,c;let m=(c=(n=l.collection.getItem(a))===null||n===void 0?void 0:n.level)!==null&&c!==void 0?c:0;for(;d;){let g=l.collection.getItem(d);if(!g)break;if(g.type!=="item"){d=l.collection.getKeyAfter(d);continue}var $;if((($=g.level)!==null&&$!==void 0?$:0)<=m)break;f=d,d=l.collection.getKeyAfter(d)}}var b;a=(b=d??f)!==null&&b!==void 0?b:a}return s.useMemo(()=>new Set([r,a].filter(d=>d!=null)),[r,a])}const te=s.createContext(null),O=s.createContext(null),ct=s.forwardRef(function(e,l){[e,l]=G(e,l,te);let o=s.useContext(O);return o?u.createElement(oe,{state:o,props:e,listBoxRef:l}):u.createElement(ie,{content:u.createElement(re,e)},i=>u.createElement(We,{props:e,listBoxRef:l,collection:i}))});function We({props:t,listBoxRef:e,collection:l}){t={...t,collection:l,children:null,items:null};let{layoutDelegate:o}=s.useContext(_),i=Fe({...t,layoutDelegate:o});return u.createElement(oe,{state:i,props:t,listBoxRef:e})}function oe({state:t,props:e,listBoxRef:l}){[e,l]=G(e,l,xe);let{dragAndDropHooks:o,layout:i="stack",orientation:r="vertical",filter:a}=e,n=Be(t,a),{collection:c,selectionManager:$}=n,b=!!o?.useDraggableCollectionState,d=!!o?.useDroppableCollectionState,{direction:f}=Te(),{disabledBehavior:m,disabledKeys:g}=$,x=ve({usage:"search",sensitivity:"base"}),{isVirtualized:p,layoutDelegate:h,dropTargetDelegate:M,CollectionRoot:w}=s.useContext(_),P=s.useMemo(()=>e.keyboardDelegate||new ge({collection:c,collator:x,ref:l,disabledKeys:g,disabledBehavior:m,layout:i,orientation:r,direction:f,layoutDelegate:h}),[c,x,l,m,g,r,f,e.keyboardDelegate,i,h]),{listBoxProps:y}=Ke({...e,shouldSelectOnPressUp:b||e.shouldSelectOnPressUp,keyboardDelegate:P,isVirtualized:p},n,l);s.useRef(b),s.useRef(d),s.useEffect(()=>{},[b,d]);let v,D,C,L=!1,k=null,I=s.useRef(null);if(b&&o){v=o.useDraggableCollectionState({collection:c,selectionManager:$,preview:o.renderDragPreview?I:void 0}),o.useDraggableCollection({},v,l);let z=o.DragPreview;k=o.renderDragPreview?u.createElement(z,{ref:I},o.renderDragPreview):null}if(d&&o){D=o.useDroppableCollectionState({collection:c,selectionManager:$});let z=o.dropTargetDelegate||M||new o.ListDropTargetDelegate(c,l,{orientation:r,layout:i,direction:f});C=o.useDroppableCollection({keyboardDelegate:P,dropTargetDelegate:z},D,l),L=D.isDropTarget({type:"root"})}let{focusProps:K,isFocused:T,isFocusVisible:U}=Oe(),B=n.collection.size===0,N={isDropTarget:L,isEmpty:B,isFocused:T,isFocusVisible:U,layout:e.layout||"stack",state:n},E=V({className:e.className,style:e.style,defaultClassName:"react-aria-ListBox",values:N}),R=null;B&&e.renderEmptyState&&(R=u.createElement("div",{role:"option",style:{display:"contents"}},e.renderEmptyState(N)));let ae=F(e,{global:!0});return u.createElement(Pe,null,u.createElement("div",{...S(ae,E,y,K,C?.collectionProps),ref:l,slot:e.slot||void 0,onScroll:e.onScroll,"data-drop-target":L||void 0,"data-empty":B||void 0,"data-focused":T||void 0,"data-focus-visible":U||void 0,"data-layout":e.layout||"stack","data-orientation":e.orientation||"vertical"},u.createElement(J,{values:[[te,e],[O,n],[A,{dragAndDropHooks:o,dragState:v,dropState:D}],[pe,{elementType:"div"}],[Z,{render:qe}],[de,{name:"ListBoxSection",render:je}]]},u.createElement(De,null,u.createElement(w,{collection:c,scrollRef:l,persistedKeys:Re($,o,D),renderDropIndicator:ee(o,D)}))),R,k))}function je(t,e,l,o="react-aria-ListBoxSection"){let i=s.useContext(O),{dragAndDropHooks:r,dropState:a}=s.useContext(A),{CollectionBranch:n}=s.useContext(_),[c,$]=ue();var b;let{headingProps:d,groupProps:f}=_e({heading:$,"aria-label":(b=t["aria-label"])!==null&&b!==void 0?b:void 0}),m=V({defaultClassName:o,className:t.className,style:t.style,values:{}}),g=F(t,{global:!0});return delete g.id,u.createElement("section",{...S(g,m,f),ref:e},u.createElement(me.Provider,{value:{...d,ref:c}},u.createElement(n,{collection:i.collection,parent:l,renderDropIndicator:ee(r,a)})))}const ut=q(ne,function(e,l,o){let i=X(l),r=s.useContext(O),{dragAndDropHooks:a,dragState:n,dropState:c}=s.useContext(A),{optionProps:$,labelProps:b,descriptionProps:d,...f}=ze({key:o.key,"aria-label":e?.["aria-label"]},r,i),{hoverProps:m,isHovered:g}=Y({isDisabled:!f.allowsSelection&&!f.hasAction,onHoverStart:o.props.onHoverStart,onHoverChange:o.props.onHoverChange,onHoverEnd:o.props.onHoverEnd}),x=null;n&&a&&(x=a.useDraggableItem({key:o.key},n));let p=null;c&&a&&(p=a.useDroppableItem({target:{type:"item",key:o.key,dropPosition:"on"}},c,i));let h=n&&n.isDragging(o.key),M=V({...e,id:void 0,children:e.children,defaultClassName:"react-aria-ListBoxItem",values:{...f,isHovered:g,selectionMode:r.selectionManager.selectionMode,selectionBehavior:r.selectionManager.selectionBehavior,allowsDragging:!!n,isDragging:h,isDropTarget:p?.isDropTarget}});s.useEffect(()=>{o.textValue},[o.textValue]);let w=e.href?"a":"div",P=F(e,{global:!0});return delete P.id,delete P.onClick,u.createElement(w,{...S(P,M,$,m,x?.dragProps,p?.dropProps),ref:i,"data-allows-dragging":!!n||void 0,"data-selected":f.isSelected||void 0,"data-disabled":f.isDisabled||void 0,"data-hovered":g||void 0,"data-focused":f.isFocused||void 0,"data-focus-visible":f.isFocusVisible||void 0,"data-pressed":f.isPressed||void 0,"data-dragging":h||void 0,"data-drop-target":p?.isDropTarget||void 0,"data-selection-mode":r.selectionManager.selectionMode==="none"?void 0:r.selectionManager.selectionMode},u.createElement(J,{values:[[ye,{slots:{[ce]:b,label:b,description:d}}],[he,{isSelected:f.isSelected}]]},M.children))});function qe(t,e){e=X(e);let{dragAndDropHooks:l,dropState:o}=s.useContext(A),{dropIndicatorProps:i,isHidden:r,isDropTarget:a}=l.useDropIndicator(t,o,e);return r?null:u.createElement(Je,{...t,dropIndicatorProps:i,isDropTarget:a,ref:e})}function Ge(t,e){let{dropIndicatorProps:l,isDropTarget:o,...i}=t,r=V({...i,defaultClassName:"react-aria-DropIndicator",values:{isDropTarget:o}});return u.createElement("div",{...l,...r,role:"option",ref:e,"data-drop-target":o||void 0})}const Je=s.forwardRef(Ge);q(se,function(e,l,o){let i=s.useContext(O),{isLoading:r,onLoadMore:a,scrollOffset:n,...c}=e,$=s.useRef(null),b=s.useMemo(()=>({onLoadMore:a,collection:i?.collection,sentinelRef:$,scrollOffset:n}),[a,n,i?.collection]);Ue(b,$);let d=V({...c,id:void 0,children:o.rendered,defaultClassName:"react-aria-ListBoxLoadingIndicator",values:null}),f={tabIndex:-1};return u.createElement(u.Fragment,null,u.createElement("div",{style:{position:"relative",width:0,height:0},inert:Le(!0)},u.createElement("div",{"data-testid":"loadMoreSentinel",ref:$,style:{position:"absolute",height:1,width:1}})),r&&d.children&&u.createElement("div",{...S(F(e,{global:!0}),f),...d,role:"option",ref:l},d.children))});export{ct as $,ut as a,te as b,O as c,A as d,ee as e,Z as f,Re as g,Ue as h};
