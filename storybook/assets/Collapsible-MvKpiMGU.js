import{j as T}from"./jsx-runtime-hv06LKfz.js";import{r as s}from"./index-D8-PC79C.js";import{c as U}from"./clsx-B-dksMZM.js";import{u as H}from"./useStyles-Dc-DqJ_c.js";import{c as M,u as Q,a as w,b as L,d as K,m as _,e as G}from"./useBaseUiId-D_SK3tu4.js";import{r as de}from"./index-DXvUqTe6.js";const fe=()=>{};function pe({controlled:e,default:r,name:t,state:n="value"}){const{current:o}=s.useRef(e!==void 0),[l,p]=s.useState(r),f=o?e:l,u=s.useCallback(g=>{o||p(g)},[]);return[f,u]}function me(e,r=!1){const[t,n]=s.useState(),[o,l]=s.useState(e);return e&&!o&&(l(!0),t!=="starting"&&!r&&n("starting")),!e&&o&&t!=="ending"&&n("ending"),!e&&!o&&t==="ending"&&n(void 0),M(()=>{if(!e)return;r&&n("starting");const p=requestAnimationFrame(()=>{n(void 0)});return()=>{cancelAnimationFrame(p)}},[e,r]),s.useMemo(()=>({mounted:o,setMounted:l,transitionStatus:t}),[o,t])}function be(e){const{open:r,defaultOpen:t,onOpenChange:n,disabled:o}=e,[l,p]=pe({controlled:r,default:t,name:"Collapsible",state:"open"}),{mounted:f,setMounted:u,transitionStatus:g}=me(l,!0),[m,c]=s.useState(Q()),b=w(h=>{n?.(h),p(h)});return s.useMemo(()=>({panelId:m,disabled:o,mounted:f,open:l,setPanelId:c,setMounted:u,setOpen:b,transitionStatus:g}),[m,o,f,l,c,u,b,g])}const B=s.createContext(void 0);function X(){const e=s.useContext(B);if(e===void 0)throw new Error("Base UI: CollapsibleRootContext is missing. Collapsible parts must be placed within <Collapsible.Root>.");return e}const ge={"data-open":""},he={"data-closed":""},Ce={open(e){return e?{"data-panel-open":""}:null}},Re={open(e){return e?ge:he}},Ne={"data-starting-style":""},Pe={"data-ending-style":""},ye={transitionStatus(e){return e==="starting"?Ne:e==="ending"?Pe:null}},Z={...Re,...ye},ee=s.forwardRef(function(r,t){const{children:n,className:o,defaultOpen:l=!1,disabled:p=!1,onOpenChange:f,open:u,render:g,...m}=r,c=be({open:u,defaultOpen:l,onOpenChange:f??fe,disabled:p}),b=s.useMemo(()=>({open:c.open,disabled:c.disabled,transitionStatus:c.transitionStatus}),[c.open,c.disabled,c.transitionStatus]),h=s.useMemo(()=>({...c,state:b}),[c,b]),{renderElement:R}=L({render:g??"div",className:o,state:b,ref:t,extraProps:{children:n,...m},customStyleHookMapping:Z});return g!==null?T.jsx(B.Provider,{value:h,children:R()}):T.jsx(B.Provider,{value:h,children:n})});function Se(e){const{rootElementName:r=""}=e,[t,n]=s.useState(r.toUpperCase()),o=s.useCallback(l=>{n(l?.tagName??"")},[]);return{rootElementName:t,updateRootElementName:o}}const xe=s.createContext(void 0);function Ee(e=!1){const r=s.useContext(xe);if(r===void 0&&!e)throw new Error("Base UI: CompositeRootContext is missing. Composite parts must be placed within <Composite.Root>.");return r}function Oe(e={}){const{buttonRef:r,disabled:t=!1,focusableWhenDisabled:n,tabIndex:o,type:l,elementName:p}=e,f=s.useRef(null),{rootElementName:u,updateRootElementName:g}=Se({rootElementName:p}),m=Ee(!0)!==void 0,c=w(()=>{const d=f.current;return u==="BUTTON"||u==="INPUT"&&["button","submit","reset"].includes(d?.type)}),b=w(()=>{const d=f.current;return!!(u==="A"&&d?.href)}),h=K(g,r,f),R=s.useMemo(()=>{const d={};return o!==void 0&&!m&&(d.tabIndex=o),u==="BUTTON"||u==="INPUT"?n||m?d["aria-disabled"]=t:m||(d.disabled=t):u!==""&&(u!=="A"?(d.role="button",m||(d.tabIndex=o??0)):o&&!m&&(d.tabIndex=o),t&&(d["aria-disabled"]=t,m||(d.tabIndex=n?o??0:-1))),d},[t,u,n,m,o]);return M(()=>{const d=f.current;d instanceof HTMLButtonElement&&m&&t&&R.disabled===void 0&&d.disabled&&(d.disabled=!1)},[t,R.disabled,m]),{getButtonProps:s.useCallback((d={})=>{const{onClick:y,onMouseDown:E,onKeyUp:x,onKeyDown:O,onPointerDown:N,...A}=d;return _({type:l,onClick(i){if(t){i.preventDefault();return}y?.(i)},onMouseDown(i){t||E?.(i)},onKeyDown(i){(t&&n&&i.key!=="Tab"||i.target===i.currentTarget&&!c()&&i.key===" ")&&i.preventDefault(),t||(G(i),O?.(i)),!i.baseUIHandlerPrevented&&i.target===i.currentTarget&&!c()&&!b()&&i.key==="Enter"&&!t&&(y?.(i),i.preventDefault())},onKeyUp(i){t||(G(i),x?.(i)),!i.baseUIHandlerPrevented&&i.target===i.currentTarget&&!c()&&!t&&i.key===" "&&y?.(i)},onPointerDown(i){if(t){i.preventDefault();return}N?.(i)},ref:h},R,A)},[R,t,n,c,b,h,l]),buttonRef:h}}function Me(e){const{panelId:r,disabled:t,open:n,rootRef:o,setOpen:l}=e,{getButtonProps:p,buttonRef:f}=Oe({disabled:t,focusableWhenDisabled:!0,type:"button"}),u=K(o,f);return{getRootProps:s.useCallback((m={})=>_({type:"button","aria-controls":r,"aria-expanded":n,disabled:t,onClick(){l(!n)},ref:u},m,p),[r,t,p,u,n,l])}}const te=s.forwardRef(function(r,t){const{panelId:n,open:o,setOpen:l,state:p,disabled:f}=X(),{className:u,disabled:g=f,id:m,render:c,...b}=r,{getRootProps:h}=Me({disabled:g,panelId:n,open:o,setOpen:l,rootRef:t}),{renderElement:R}=L({propGetter:h,render:c??"button",state:p,className:u,extraProps:b,customStyleHookMapping:Ce});return R()});let v=null,k;function we(){return v==null&&(v=document.createElement("div")),k===void 0&&(k=v.computedStyleMap!==void 0),k}function Ae(e){return e&&e.ownerDocument||document}function ne(e){return Ae(e).defaultView||window}function Te(e,r=!1){const t=s.useRef(-1),n=s.useRef(-1),o=w(()=>{cancelAnimationFrame(t.current),clearTimeout(n.current)});return s.useEffect(()=>o,[o]),w(l=>{o();const p=e.current;p&&(typeof p.getAnimations!="function"||globalThis.BASE_UI_ANIMATIONS_DISABLED?l():t.current=requestAnimationFrame(()=>{function f(){p&&Promise.allSettled(p.getAnimations().map(u=>u.finished)).then(()=>{de.flushSync(l)})}r?n.current=window.setTimeout(f):f()}))})}const De=[];function Y(e){s.useEffect(e,De)}function Ie(e){return we()?e.computedStyleMap().get("animation-name")?.value??void 0:ne(e).getComputedStyle(e).animationName}let F;function z(e){if(F===void 0){const r=typeof CSS<"u"&&typeof CSS.supports=="function"&&CSS.supports("content-visibility","hidden"),t="onbeforematch"in ne(e);F=r&&t}return F}function ve(e){const{hiddenUntilFound:r,panelId:t,keepMounted:n,open:o,mounted:l,ref:p,setPanelId:f,setMounted:u,setOpen:g}=e,m=Q(t),c=s.useRef(null),[{height:b,width:h},R]=s.useState({height:0,width:0}),D=s.useRef("none"),d=s.useRef(null),y=s.useRef(!1);M(()=>(f(!n&&!o?void 0:m),()=>{f(void 0)}),[m,f,n,o]);const E=w(a=>{if(!a)return;c.current=a;const C=Ie(a);D.current=C??"none",d.current=a.style.transitionDuration}),x=K(p,E),O=Te(c),N=o||l,A=s.useRef(!1),i=s.useRef(N),I=s.useCallback(()=>{const a=c.current;if(!a)return;function C(){y.current=!0}function P(){y.current=!1}function S(){y.current=!1}return a.addEventListener("transitioncancel",S),a.addEventListener("transitionend",P),a.addEventListener("transitionrun",C),()=>{a.removeEventListener("transitioncancel",S),a.removeEventListener("transitionend",P),a.removeEventListener("transitionrun",C)}},[]);M(()=>{const{current:a}=c;let C=-1,P=-1;if(a){const S=A.current,ae=i.current,le=y.current,ue=a.style.animationName==="none"?"":a.style.animationName,ce=d.current,W=S||ae;a.style.animationName="none";const V=!o&&!l;if(!le||V){n||I();const $=V?{height:0,width:0}:a.getBoundingClientRect();R({height:$.height,width:$.width})}a.style.animationName=W?"none":ue,a.style.transitionDuration=W?"0s":ce??"",O(()=>{u(o),S&&(A.current=!1,C=requestAnimationFrame(()=>{P=requestAnimationFrame(()=>{a.style.transitionDuration=d.current??""})}))})}return()=>{cancelAnimationFrame(C),cancelAnimationFrame(P)}},[l,n,o,I,O,u,f]),Y(()=>{const a=c.current;let C=-1,P=-1;const S=requestAnimationFrame(()=>{i.current=!1,a&&(C=requestAnimationFrame(()=>{P=requestAnimationFrame(()=>{a.style.transitionDuration=d.current??""})}))});return()=>{cancelAnimationFrame(S),cancelAnimationFrame(C),cancelAnimationFrame(P)}}),Y(I),s.useEffect(function(){const{current:C}=c;if(!C||!z(C))return;function P(S){S.preventDefault(),A.current=!0,g(!0)}return C.addEventListener("beforematch",P),()=>{C.removeEventListener("beforematch",P)}},[g]),M(()=>{const{current:a}=c;a&&z(a)&&a?.hidden&&!N&&r===!0&&(a.hidden="until-found")},[r,N]);const j=r?"until-found":"hidden",q=s.useCallback((a={})=>_({id:m,hidden:N?void 0:!!j,ref:x},a),[j,m,N,x]);return s.useMemo(()=>({getRootProps:q,height:b,width:h,isOpen:N}),[q,b,h,N])}let J=function(e){return e.collapsiblePanelHeight="--collapsible-panel-height",e.collapsiblePanelWidth="--collapsible-panel-width",e}({});const oe=s.forwardRef(function(r,t){const{className:n,hiddenUntilFound:o,id:l,keepMounted:p,render:f,...u}=r,{mounted:g,open:m,panelId:c,setPanelId:b,setMounted:h,setOpen:R,state:D}=X();M(()=>{l&&b(l)},[l,b]);const d=o??!1,{getRootProps:y,height:E,width:x,isOpen:O}=ve({hiddenUntilFound:d,panelId:c,keepMounted:p??!1,mounted:g,open:m,ref:t,setPanelId:b,setMounted:h,setOpen:R}),{renderElement:N}=L({propGetter:y,render:f??"div",state:D,className:n,extraProps:{...u,style:{...u.style,[J.collapsiblePanelHeight]:E?`${E}px`:void 0,[J.collapsiblePanelWidth]:x?`${x}px`:void 0}},customStyleHookMapping:Z});return!p&&!O&&!d?null:N()}),se=s.forwardRef(({className:e,...r},t)=>{const{classNames:n}=H("Collapsible");return T.jsx(ee,{ref:t,className:U(n.root,e),...r})});se.displayName=ee.displayName;const re=s.forwardRef(({className:e,...r},t)=>{const{classNames:n}=H("Collapsible");return T.jsx(te,{ref:t,className:U(n.trigger,e),...r})});re.displayName=te.displayName;const ie=s.forwardRef(({className:e,...r},t)=>{const{classNames:n}=H("Collapsible");return T.jsx(oe,{ref:t,className:U(n.panel,e),...r})});ie.displayName=oe.displayName;const Ke={Root:se,Trigger:re,Panel:ie};export{Ke as C,fe as N,Te as a,me as b,ye as t,pe as u};
