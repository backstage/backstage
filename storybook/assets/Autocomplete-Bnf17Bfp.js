import{c as Ae}from"./Separator-B52XnveC.js";import{r,a2 as Pe}from"./iframe-Du4yWFmh.js";import{a as Se,c as De}from"./RSPContexts-D_Pwck-t.js";import{f as Ne,b as Te,d as we,e as Be}from"./utils-z8eUZOh4.js";import{b as Ve,a as F,e as Ke,$ as T}from"./useObjectRef-CiRgIA98.js";import{u as ze,B as Ue,r as He,e as P,d as Me}from"./useFocusable-Dw78h-Dw.js";import{$ as We}from"./useLabels-Blszi5gD.js";import{$ as Oe}from"./useEvent-DjPRkiw2.js";import{v as S,w as je,x as qe,y as D,z as N,A as Ge,B as Je}from"./SelectionManager-0uJxHsG8.js";import{$ as Ze}from"./useLocalizedStringFormatter-DAzOeBuS.js";import{$ as Qe}from"./useControlledState-Ck_KVpu8.js";function $t(u){let l=Ae({usage:"search",...u}),f=r.useCallback((o,a)=>a.length===0?!0:(o=o.normalize("NFC"),a=a.normalize("NFC"),l.compare(o.slice(0,a.length),a)===0),[l]),c=r.useCallback((o,a)=>a.length===0?!0:(o=o.normalize("NFC"),a=a.normalize("NFC"),l.compare(o.slice(-a.length),a)===0),[l]),s=r.useCallback((o,a)=>{if(a.length===0)return!0;o=o.normalize("NFC"),a=a.normalize("NFC");let d=0,$=a.length;for(;d+$<=o.length;d++){let p=o.slice(d,d+$);if(l.compare(a,p)===0)return!0}return!1},[l]);return r.useMemo(()=>({startsWith:f,endsWith:c,contains:s}),[f,c,s])}var w={};w={collectionLabel:"مقترحات"};var B={};B={collectionLabel:"Предложения"};var V={};V={collectionLabel:"Návrhy"};var K={};K={collectionLabel:"Forslag"};var z={};z={collectionLabel:"Empfehlungen"};var U={};U={collectionLabel:"Προτάσεις"};var H={};H={collectionLabel:"Suggestions"};var M={};M={collectionLabel:"Sugerencias"};var W={};W={collectionLabel:"Soovitused"};var O={};O={collectionLabel:"Ehdotukset"};var j={};j={collectionLabel:"Suggestions"};var q={};q={collectionLabel:"הצעות"};var G={};G={collectionLabel:"Prijedlozi"};var J={};J={collectionLabel:"Javaslatok"};var Z={};Z={collectionLabel:"Suggerimenti"};var Q={};Q={collectionLabel:"候補"};var X={};X={collectionLabel:"제안"};var Y={};Y={collectionLabel:"Pasiūlymai"};var _={};_={collectionLabel:"Ieteikumi"};var ee={};ee={collectionLabel:"Forslag"};var te={};te={collectionLabel:"Suggesties"};var ae={};ae={collectionLabel:"Sugestie"};var re={};re={collectionLabel:"Sugestões"};var le={};le={collectionLabel:"Sugestões"};var oe={};oe={collectionLabel:"Sugestii"};var ue={};ue={collectionLabel:"Предложения"};var ce={};ce={collectionLabel:"Návrhy"};var ne={};ne={collectionLabel:"Predlogi"};var ie={};ie={collectionLabel:"Predlozi"};var fe={};fe={collectionLabel:"Förslag"};var se={};se={collectionLabel:"Öneriler"};var de={};de={collectionLabel:"Пропозиції"};var $e={};$e={collectionLabel:"建议"};var pe={};pe={collectionLabel:"建議"};var be={};be={"ar-AE":w,"bg-BG":B,"cs-CZ":V,"da-DK":K,"de-DE":z,"el-GR":U,"en-US":H,"es-ES":M,"et-EE":W,"fi-FI":O,"fr-FR":j,"he-IL":q,"hr-HR":G,"hu-HU":J,"it-IT":Z,"ja-JP":Q,"ko-KR":X,"lt-LT":Y,"lv-LV":_,"nb-NO":ee,"nl-NL":te,"pl-PL":ae,"pt-BR":re,"pt-PT":le,"ro-RO":oe,"ru-RU":ue,"sk-SK":ce,"sl-SI":ne,"sr-SP":ie,"sv-SE":fe,"tr-TR":se,"uk-UA":de,"zh-CN":$e,"zh-TW":pe};function Xe(u){return u&&u.__esModule?u.default:u}function Ye(u,l){let{inputRef:f,collectionRef:c,filter:s,disableAutoFocusFirst:o=!1,disableVirtualFocus:a=!1}=u,d=Ve(),$=r.useRef(void 0),p=r.useRef(!1),n=r.useRef(null),L=r.useRef(null),ve=ze()==="virtual"&&(Ue()||He()),[m,xe]=r.useState(!ve&&!a),[me,I]=r.useState(!1);r.useEffect(()=>()=>clearTimeout($.current),[]);let E=F(e=>{!e.isTrusted&&m&&f.current&&P(Me(f.current))!==f.current&&f.current.focus();let t=e.target;e.isTrusted||!t||n.current===t.id||(clearTimeout($.current),t!==c.current?p.current?(n.current=t.id,$.current=setTimeout(()=>{l.setFocusedNodeId(t.id)},500)):(n.current=t.id,l.setFocusedNodeId(t.id)):n.current&&!document.getElementById(n.current)&&(n.current=null,l.setFocusedNodeId(null)),p.current=!1)}),R=r.useCallback(e=>{if(e!=null){var t;(t=L.current)===null||t===void 0||t.removeEventListener("focusin",E),L.current=e,e.addEventListener("focusin",E),e.getAttribute("tabindex")!=null&&xe(!1),I(!0)}else{var i;(i=L.current)===null||i===void 0||i.removeEventListener("focusin",E),I(!1)}},[E]),Ee=Ke(r.useMemo(()=>Ne(c,R),[c,R])),Fe=F(()=>{var e;p.current=!0,(e=c.current)===null||e===void 0||e.dispatchEvent(new CustomEvent(S,{cancelable:!0,bubbles:!0,detail:{focusStrategy:"first"}}))}),k=F(e=>{var t;je(P()),n.current=null,l.setFocusedNodeId(null);let i=new CustomEvent(qe,{cancelable:!0,bubbles:!0,detail:{clearFocusKey:e}});clearTimeout($.current),p.current=!1,(t=c.current)===null||t===void 0||t.dispatchEvent(i)}),x=r.useRef("");Oe(f,"input",e=>{let{inputType:t}=e;x.current=t});let Le=e=>{x.current==="insertText"&&!o?Fe():x.current&&(x.current.includes("insert")||x.current.includes("delete")||x.current.includes("history"))&&(k(!0),Je(document)===f.current&&N(f.current,null)),l.setInputValue(e)},A=r.useRef(null),he=e=>{if(A.current=e.target,e.nativeEvent.isComposing)return;let t=n.current;switch(e.key){case"a":if(Ge(e))return;break;case"Escape":if(e.isDefaultPrevented())return;break;case" ":return;case"Tab":"continuePropagation"in e&&e.continuePropagation();return;case"Home":case"End":case"PageDown":case"PageUp":case"ArrowUp":case"ArrowDown":{var i;if((e.key==="Home"||e.key==="End")&&t==null&&e.shiftKey)return;e.preventDefault();let b=new CustomEvent(S,{cancelable:!0,bubbles:!0});(i=c.current)===null||i===void 0||i.dispatchEvent(b);break}}e.isPropagationStopped()||e.stopPropagation();let v=!0;if(c.current!==null){var y;if(t==null)v=((y=c.current)===null||y===void 0?void 0:y.dispatchEvent(new KeyboardEvent(e.nativeEvent.type,e.nativeEvent)))||!1;else{let b=document.getElementById(t);b&&(v=b?.dispatchEvent(new KeyboardEvent(e.nativeEvent.type,e.nativeEvent))||!1)}}if(v)switch(e.key){case"ArrowLeft":case"ArrowRight":k();break;case"Enter":if(t!=null){let b=document.getElementById(t);b?.click()}break}else e.preventDefault()},h=F(e=>{if(e.target===A.current){var t;e.stopImmediatePropagation();let i=n.current;if(i==null)(t=c.current)===null||t===void 0||t.dispatchEvent(new KeyboardEvent(e.type,e));else{let v=document.getElementById(i);v?.dispatchEvent(new KeyboardEvent(e.type,e))}}});r.useEffect(()=>(document.addEventListener("keyup",h,!0),()=>{document.removeEventListener("keyup",h,!0)}),[h]);let ge=Ze(Xe(be),"@react-aria/autocomplete"),Ce=We({id:d,"aria-label":ge.format("collectionLabel")}),ye=r.useCallback((e,t)=>s?s(e,l.inputValue,t):!0,[l.inputValue,s]),Ie=e=>{if(!e.isTrusted)return;let t=n.current?document.getElementById(n.current):null;t&&D(t,e.relatedTarget)},Re=e=>{if(!e.isTrusted)return;if(n.current?document.getElementById(n.current):null){let i=e.target;queueMicrotask(()=>{D(i,c.current),N(c.current,i)})}},g={value:l.inputValue,onChange:Le};var C;let ke={onKeyDown:he,"aria-activedescendant":(C=l.focusedNodeId)!==null&&C!==void 0?C:void 0,onBlur:Ie,onFocus:Re};return me&&(g={...g,...m&&ke,enterKeyHint:"go","aria-controls":d,"aria-autocomplete":"list",autoCorrect:"off",spellCheck:"false",autoComplete:"off"}),{inputProps:g,collectionProps:T(Ce,{shouldUseVirtualFocus:m,disallowTypeAhead:m}),collectionRef:Ee,filter:s!=null?ye:void 0}}function _e(u){let{onInputChange:l,inputValue:f,defaultInputValue:c=""}=u,s=p=>{l&&l(p)},[o,a]=r.useState(null),[d,$]=Qe(f,c,s);return{inputValue:d,setInputValue:$,focusedNodeId:o,setFocusedNodeId:a}}const et=r.createContext(null),tt=r.createContext(null);function pt(u){let l=Te(et,u.slot);u=T(l,u);let{filter:f,disableAutoFocusFirst:c}=u,s=_e(u),o=r.useRef(null),a=r.useRef(null),{inputProps:d,collectionProps:$,collectionRef:p,filter:n}=Ye({...we(u),filter:f,disableAutoFocusFirst:c,inputRef:o,collectionRef:a},s);return Pe.createElement(Be,{values:[[tt,s],[Se,{...d,ref:o}],[De,{...$,filter:n,ref:p}]]},u.children)}export{$t as $,pt as a};
