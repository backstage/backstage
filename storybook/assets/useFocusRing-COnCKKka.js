import{g as x,h as H,i as W,j as y,k as C,l as P,m as G,n as L,o as S,p as V,q as D}from"./useFocusable-BwFERnd_.js";import{r as n}from"./iframe-M9O-K8SB.js";function k(d){let{isDisabled:b,onBlurWithin:s,onFocusWithin:i,onFocusWithinChange:t}=d,a=n.useRef({isFocusWithin:!1}),{addGlobalListener:p,removeAllGlobalListeners:e}=x(),c=n.useCallback(r=>{r.currentTarget.contains(r.target)&&a.current.isFocusWithin&&!r.currentTarget.contains(r.relatedTarget)&&(a.current.isFocusWithin=!1,e(),s&&s(r),t&&t(!1))},[s,t,a,e]),l=H(c),v=n.useCallback(r=>{if(!r.currentTarget.contains(r.target))return;const $=W(r.target),u=y($);if(!a.current.isFocusWithin&&u===C(r.nativeEvent)){i&&i(r),t&&t(!0),a.current.isFocusWithin=!0,l(r);let h=r.currentTarget;p($,"focus",o=>{if(a.current.isFocusWithin&&!P(h,o.target)){let f=new $.defaultView.FocusEvent("blur",{relatedTarget:o.target});G(f,h);let g=L(f);c(g)}},{capture:!0})}},[i,t,l,p,c]);return b?{focusWithinProps:{onFocus:void 0,onBlur:void 0}}:{focusWithinProps:{onFocus:v,onBlur:c}}}let T=!1,F=0;function w(){T=!0,setTimeout(()=>{T=!1},50)}function m(d){d.pointerType==="touch"&&w()}function B(){if(!(typeof document>"u"))return F===0&&typeof PointerEvent<"u"&&document.addEventListener("pointerup",m),F++,()=>{F--,!(F>0)&&typeof PointerEvent<"u"&&document.removeEventListener("pointerup",m)}}function A(d){let{onHoverStart:b,onHoverChange:s,onHoverEnd:i,isDisabled:t}=d,[a,p]=n.useState(!1),e=n.useRef({isHovered:!1,ignoreEmulatedMouseEvents:!1,pointerType:"",target:null}).current;n.useEffect(B,[]);let{addGlobalListener:c,removeAllGlobalListeners:l}=x(),{hoverProps:v,triggerHoverEnd:r}=n.useMemo(()=>{let $=(o,f)=>{if(e.pointerType=f,t||f==="touch"||e.isHovered||!o.currentTarget.contains(o.target))return;e.isHovered=!0;let g=o.currentTarget;e.target=g,c(W(o.target),"pointerover",E=>{e.isHovered&&e.target&&!P(e.target,E.target)&&u(E,E.pointerType)},{capture:!0}),b&&b({type:"hoverstart",target:g,pointerType:f}),s&&s(!0),p(!0)},u=(o,f)=>{let g=e.target;e.pointerType="",e.target=null,!(f==="touch"||!e.isHovered||!g)&&(e.isHovered=!1,l(),i&&i({type:"hoverend",target:g,pointerType:f}),s&&s(!1),p(!1))},h={};return typeof PointerEvent<"u"&&(h.onPointerEnter=o=>{T&&o.pointerType==="mouse"||$(o,o.pointerType)},h.onPointerLeave=o=>{!t&&o.currentTarget.contains(o.target)&&u(o,o.pointerType)}),{hoverProps:h,triggerHoverEnd:u}},[b,s,i,t,e,c,l]);return n.useEffect(()=>{t&&r({currentTarget:e.target},e.pointerType)},[t]),{hoverProps:v,isHovered:a}}function R(d={}){let{autoFocus:b=!1,isTextInput:s,within:i}=d,t=n.useRef({isFocused:!1,isFocusVisible:b||S()}),[a,p]=n.useState(!1),[e,c]=n.useState(()=>t.current.isFocused&&t.current.isFocusVisible),l=n.useCallback(()=>c(t.current.isFocused&&t.current.isFocusVisible),[]),v=n.useCallback(u=>{t.current.isFocused=u,p(u),l()},[l]);V(u=>{t.current.isFocusVisible=u,l()},[],{isTextInput:s});let{focusProps:r}=D({isDisabled:i,onFocusChange:v}),{focusWithinProps:$}=k({isDisabled:!i,onFocusWithinChange:v});return{isFocused:a,isFocusVisible:e,focusProps:i?$:r}}export{A as $,R as a,k as b};
